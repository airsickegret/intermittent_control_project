Processed spikes from trial 100.
Processed spikes from trial 200.
Processed spikes from trial 300.
  0%|          | 0/1 [00:00<?, ?it/s]ARHMM Initialization restarts:   0%|          | 0/1 [00:00<?, ?it/s]Initializing with an ARHMM using 25 steps of EM.

  0%|          | 0/25 [00:00<?, ?it/s][A
LP: -3570973.4:   0%|          | 0/25 [00:00<?, ?it/s][A
LP: -3570973.4:   0%|          | 0/25 [00:01<?, ?it/s][A
LP: -3570973.4:   4%|▍         | 1/25 [00:01<00:28,  1.20s/it][A
LP: -3570973.4:   4%|▍         | 1/25 [00:02<00:28,  1.20s/it][A
LP: -3570973.4:   8%|▊         | 2/25 [00:02<00:27,  1.20s/it][A
LP: -3570973.4:   8%|▊         | 2/25 [00:03<00:27,  1.20s/it][A
LP: -3570973.4:  12%|█▏        | 3/25 [00:03<00:26,  1.20s/it][A
LP: -3570973.4:  12%|█▏        | 3/25 [00:04<00:26,  1.20s/it][A
LP: -3570973.4:  16%|█▌        | 4/25 [00:04<00:25,  1.21s/it][A
LP: -3570973.4:  16%|█▌        | 4/25 [00:06<00:25,  1.21s/it][A
LP: -3570973.4:  20%|██        | 5/25 [00:06<00:24,  1.21s/it][A
LP: -3570973.4:  20%|██        | 5/25 [00:07<00:24,  1.21s/it][A
LP: -3570973.4:  24%|██▍       | 6/25 [00:07<00:22,  1.21s/it][A
LP: -3570973.4:  24%|██▍       | 6/25 [00:08<00:22,  1.21s/it][A
LP: -3570973.4:  28%|██▊       | 7/25 [00:08<00:21,  1.21s/it][A
LP: -3570973.4:  28%|██▊       | 7/25 [00:09<00:21,  1.21s/it][A
LP: -3570973.4:  32%|███▏      | 8/25 [00:09<00:20,  1.20s/it][A
LP: -3570973.4:  32%|███▏      | 8/25 [00:10<00:20,  1.20s/it][A
LP: -3570973.4:  36%|███▌      | 9/25 [00:10<00:19,  1.20s/it][A
LP: -3570973.4:  36%|███▌      | 9/25 [00:12<00:19,  1.20s/it][A
LP: -3570973.4:  40%|████      | 10/25 [00:12<00:18,  1.20s/it][A
LP: -3570973.4:  40%|████      | 10/25 [00:13<00:18,  1.20s/it][A
LP: -3570973.4:  44%|████▍     | 11/25 [00:13<00:16,  1.21s/it][A
LP: -3570973.4:  44%|████▍     | 11/25 [00:14<00:16,  1.21s/it][A
LP: -3570973.4:  48%|████▊     | 12/25 [00:14<00:15,  1.22s/it][A
LP: -3570973.4:  48%|████▊     | 12/25 [00:15<00:15,  1.22s/it][A
LP: -3570973.4:  52%|█████▏    | 13/25 [00:15<00:14,  1.22s/it][A
LP: -3570973.4:  52%|█████▏    | 13/25 [00:17<00:14,  1.22s/it][A
LP: -3570973.4:  56%|█████▌    | 14/25 [00:17<00:13,  1.23s/it][A
LP: -3570973.4:  56%|█████▌    | 14/25 [00:18<00:13,  1.23s/it][A
LP: -3570973.4:  60%|██████    | 15/25 [00:18<00:12,  1.24s/it][A
LP: -3570973.4:  60%|██████    | 15/25 [00:19<00:12,  1.24s/it][A
LP: -3570973.4:  64%|██████▍   | 16/25 [00:19<00:11,  1.24s/it][A
LP: -3570973.4:  64%|██████▍   | 16/25 [00:20<00:11,  1.24s/it][A
LP: -3570973.4:  68%|██████▊   | 17/25 [00:20<00:09,  1.24s/it][A
LP: -3570973.4:  68%|██████▊   | 17/25 [00:21<00:09,  1.24s/it][A
LP: -3570973.4:  72%|███████▏  | 18/25 [00:21<00:08,  1.24s/it][A
LP: -3570973.4:  72%|███████▏  | 18/25 [00:23<00:08,  1.24s/it][A
LP: -3570973.4:  76%|███████▌  | 19/25 [00:23<00:07,  1.24s/it][A
LP: -3570973.4:  76%|███████▌  | 19/25 [00:24<00:07,  1.24s/it][A
LP: -3570973.4:  80%|████████  | 20/25 [00:24<00:06,  1.24s/it][A
LP: -3570973.4:  80%|████████  | 20/25 [00:25<00:06,  1.24s/it][A
LP: -3570973.4:  84%|████████▍ | 21/25 [00:25<00:04,  1.24s/it][A
LP: -3570973.4:  84%|████████▍ | 21/25 [00:26<00:04,  1.24s/it][A
LP: -3570973.4:  88%|████████▊ | 22/25 [00:26<00:03,  1.24s/it][A
LP: -3570973.4:  88%|████████▊ | 22/25 [00:28<00:03,  1.24s/it][A
LP: -3570973.4:  92%|█████████▏| 23/25 [00:28<00:02,  1.24s/it][A
LP: -3570973.4:  92%|█████████▏| 23/25 [00:29<00:02,  1.24s/it][A
LP: -3570973.4:  96%|█████████▌| 24/25 [00:29<00:01,  1.24s/it][A
LP: -3570973.4:  96%|█████████▌| 24/25 [00:30<00:01,  1.24s/it][A
LP: -3570973.4: 100%|██████████| 25/25 [00:30<00:00,  1.23s/it][ALP: -3570973.4: 100%|██████████| 25/25 [00:30<00:00,  1.22s/it]
ARHMM Initialization restarts: 100%|██████████| 1/1 [00:32<00:00, 32.06s/it]ARHMM Initialization restarts: 100%|██████████| 1/1 [00:32<00:00, 32.06s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -8834717.6:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -4590752.9:   0%|          | 0/15 [05:04<?, ?it/s]ELBO: -4590752.9:   7%|▋         | 1/15 [05:04<1:11:07, 304.81s/it]ELBO: -4538615.8:   7%|▋         | 1/15 [08:56<1:11:07, 304.81s/it]ELBO: -4538615.8:  13%|█▎        | 2/15 [08:56<56:45, 261.93s/it]  ELBO: -4512690.4:  13%|█▎        | 2/15 [12:19<56:45, 261.93s/it]ELBO: -4512690.4:  20%|██        | 3/15 [12:19<46:56, 234.73s/it]ELBO: -4497505.5:  20%|██        | 3/15 [15:41<46:56, 234.73s/it]ELBO: -4497505.5:  27%|██▋       | 4/15 [15:41<40:42, 222.06s/it]ELBO: -4487725.2:  27%|██▋       | 4/15 [19:04<40:42, 222.06s/it]ELBO: -4487725.2:  33%|███▎      | 5/15 [19:04<35:49, 214.97s/it]ELBO: -4479912.0:  33%|███▎      | 5/15 [22:28<35:49, 214.97s/it]ELBO: -4479912.0:  40%|████      | 6/15 [22:28<31:41, 211.31s/it]ELBO: -4473333.8:  40%|████      | 6/15 [25:48<31:41, 211.31s/it]ELBO: -4473333.8:  47%|████▋     | 7/15 [25:48<27:40, 207.61s/it]ELBO: -4466067.2:  47%|████▋     | 7/15 [29:08<27:40, 207.61s/it]ELBO: -4466067.2:  53%|█████▎    | 8/15 [29:08<23:56, 205.23s/it]ELBO: -4464141.6:  53%|█████▎    | 8/15 [32:25<23:56, 205.23s/it]ELBO: -4464141.6:  60%|██████    | 9/15 [32:25<20:15, 202.63s/it]ELBO: -4460091.3:  60%|██████    | 9/15 [35:41<20:15, 202.63s/it]ELBO: -4460091.3:  67%|██████▋   | 10/15 [35:41<16:43, 200.65s/it]ELBO: -4458426.5:  67%|██████▋   | 10/15 [38:57<16:43, 200.65s/it]ELBO: -4458426.5:  73%|███████▎  | 11/15 [38:57<13:17, 199.27s/it]ELBO: -4457755.2:  73%|███████▎  | 11/15 [42:13<13:17, 199.27s/it]ELBO: -4457755.2:  80%|████████  | 12/15 [42:13<09:54, 198.17s/it]ELBO: -4454522.0:  80%|████████  | 12/15 [45:29<09:54, 198.17s/it]ELBO: -4454522.0:  87%|████████▋ | 13/15 [45:29<06:35, 197.63s/it]ELBO: -4454757.6:  87%|████████▋ | 13/15 [48:46<06:35, 197.63s/it]ELBO: -4454757.6:  93%|█████████▎| 14/15 [48:46<03:17, 197.22s/it]ELBO: -4453008.8:  93%|█████████▎| 14/15 [52:03<03:17, 197.22s/it]ELBO: -4453008.8: 100%|██████████| 15/15 [52:03<00:00, 197.30s/it]ELBO: -4453008.8: 100%|██████████| 15/15 [52:03<00:00, 208.23s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -6810725.7:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -861368.3:   0%|          | 0/15 [01:12<?, ?it/s] ELBO: -861368.3:   7%|▋         | 1/15 [01:12<16:59, 72.80s/it]ELBO: -861935.1:   7%|▋         | 1/15 [01:40<16:59, 72.80s/it]ELBO: -861935.1:  13%|█▎        | 2/15 [01:40<10:04, 46.51s/it]ELBO: -861725.3:  13%|█▎        | 2/15 [02:08<10:04, 46.51s/it]ELBO: -861725.3:  20%|██        | 3/15 [02:08<07:36, 38.08s/it]ELBO: -861807.9:  20%|██        | 3/15 [02:36<07:36, 38.08s/it]ELBO: -861807.9:  27%|██▋       | 4/15 [02:36<06:15, 34.10s/it]ELBO: -861059.7:  27%|██▋       | 4/15 [03:05<06:15, 34.10s/it]ELBO: -861059.7:  33%|███▎      | 5/15 [03:05<05:19, 31.99s/it]ELBO: -861525.9:  33%|███▎      | 5/15 [03:33<05:19, 31.99s/it]ELBO: -861525.9:  40%|████      | 6/15 [03:33<04:35, 30.62s/it]ELBO: -861323.2:  40%|████      | 6/15 [04:01<04:35, 30.62s/it]ELBO: -861323.2:  47%|████▋     | 7/15 [04:01<03:58, 29.80s/it]ELBO: -861448.7:  47%|████▋     | 7/15 [04:29<03:58, 29.80s/it]ELBO: -861448.7:  53%|█████▎    | 8/15 [04:29<03:24, 29.27s/it]ELBO: -862661.6:  53%|█████▎    | 8/15 [04:57<03:24, 29.27s/it]ELBO: -862661.6:  60%|██████    | 9/15 [04:57<02:53, 28.93s/it]ELBO: -861703.3:  60%|██████    | 9/15 [05:25<02:53, 28.93s/it]ELBO: -861703.3:  67%|██████▋   | 10/15 [05:25<02:23, 28.66s/it]ELBO: -861931.2:  67%|██████▋   | 10/15 [05:53<02:23, 28.66s/it]ELBO: -861931.2:  73%|███████▎  | 11/15 [05:53<01:53, 28.50s/it]ELBO: -861734.1:  73%|███████▎  | 11/15 [06:21<01:53, 28.50s/it]ELBO: -861734.1:  80%|████████  | 12/15 [06:21<01:25, 28.37s/it]ELBO: -861987.5:  80%|████████  | 12/15 [06:48<01:25, 28.37s/it]ELBO: -861987.5:  87%|████████▋ | 13/15 [06:48<00:55, 27.90s/it]ELBO: -860614.2:  87%|████████▋ | 13/15 [07:15<00:55, 27.90s/it]ELBO: -860614.2:  93%|█████████▎| 14/15 [07:15<00:27, 27.51s/it]ELBO: -862093.3:  93%|█████████▎| 14/15 [07:43<00:27, 27.51s/it]ELBO: -862093.3: 100%|██████████| 15/15 [07:43<00:00, 27.66s/it]ELBO: -862093.3: 100%|██████████| 15/15 [07:43<00:00, 30.89s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -7265721.0:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -766216.1:   0%|          | 0/15 [01:14<?, ?it/s] ELBO: -766216.1:   7%|▋         | 1/15 [01:14<17:25, 74.66s/it]ELBO: -767639.0:   7%|▋         | 1/15 [01:42<17:25, 74.66s/it]ELBO: -767639.0:  13%|█▎        | 2/15 [01:42<10:14, 47.28s/it]ELBO: -768002.1:  13%|█▎        | 2/15 [02:10<10:14, 47.28s/it]ELBO: -768002.1:  20%|██        | 3/15 [02:10<07:40, 38.39s/it]ELBO: -767490.9:  20%|██        | 3/15 [02:38<07:40, 38.39s/it]ELBO: -767490.9:  27%|██▋       | 4/15 [02:38<06:16, 34.27s/it]ELBO: -766679.3:  27%|██▋       | 4/15 [03:06<06:16, 34.27s/it]ELBO: -766679.3:  33%|███▎      | 5/15 [03:06<05:20, 32.03s/it]ELBO: -767690.1:  33%|███▎      | 5/15 [03:34<05:20, 32.03s/it]ELBO: -767690.1:  40%|████      | 6/15 [03:34<04:35, 30.66s/it]ELBO: -767518.9:  40%|████      | 6/15 [04:02<04:35, 30.66s/it]ELBO: -767518.9:  47%|████▋     | 7/15 [04:02<03:56, 29.60s/it]ELBO: -766695.6:  47%|████▋     | 7/15 [04:30<03:56, 29.60s/it]ELBO: -766695.6:  53%|█████▎    | 8/15 [04:30<03:24, 29.18s/it]ELBO: -767409.1:  53%|█████▎    | 8/15 [04:58<03:24, 29.18s/it]ELBO: -767409.1:  60%|██████    | 9/15 [04:58<02:53, 28.95s/it]ELBO: -766429.8:  60%|██████    | 9/15 [05:27<02:53, 28.95s/it]ELBO: -766429.8:  67%|██████▋   | 10/15 [05:27<02:24, 28.85s/it]ELBO: -767584.9:  67%|██████▋   | 10/15 [05:55<02:24, 28.85s/it]ELBO: -767584.9:  73%|███████▎  | 11/15 [05:55<01:54, 28.71s/it]ELBO: -767019.1:  73%|███████▎  | 11/15 [06:24<01:54, 28.71s/it]ELBO: -767019.1:  80%|████████  | 12/15 [06:24<01:25, 28.65s/it]ELBO: -767588.2:  80%|████████  | 12/15 [06:52<01:25, 28.65s/it]ELBO: -767588.2:  87%|████████▋ | 13/15 [06:52<00:57, 28.53s/it]ELBO: -766553.6:  87%|████████▋ | 13/15 [07:20<00:57, 28.53s/it]ELBO: -766553.6:  93%|█████████▎| 14/15 [07:20<00:28, 28.51s/it]ELBO: -767325.1:  93%|█████████▎| 14/15 [07:49<00:28, 28.51s/it]ELBO: -767325.1: 100%|██████████| 15/15 [07:49<00:00, 28.49s/it]ELBO: -767325.1: 100%|██████████| 15/15 [07:49<00:00, 31.30s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -7933534.0:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -839102.3:   0%|          | 0/15 [01:27<?, ?it/s] ELBO: -839102.3:   7%|▋         | 1/15 [01:27<20:31, 87.99s/it]ELBO: -839970.5:   7%|▋         | 1/15 [01:56<20:31, 87.99s/it]ELBO: -839970.5:  13%|█▎        | 2/15 [01:56<11:28, 52.93s/it]ELBO: -840012.5:  13%|█▎        | 2/15 [02:24<11:28, 52.93s/it]ELBO: -840012.5:  20%|██        | 3/15 [02:24<08:21, 41.77s/it]ELBO: -840278.2:  20%|██        | 3/15 [02:53<08:21, 41.77s/it]ELBO: -840278.2:  27%|██▋       | 4/15 [02:53<06:42, 36.60s/it]ELBO: -838851.2:  27%|██▋       | 4/15 [03:22<06:42, 36.60s/it]ELBO: -838851.2:  33%|███▎      | 5/15 [03:22<05:37, 33.76s/it]ELBO: -839347.7:  33%|███▎      | 5/15 [03:50<05:37, 33.76s/it]ELBO: -839347.7:  40%|████      | 6/15 [03:50<04:47, 31.95s/it]ELBO: -839519.6:  40%|████      | 6/15 [04:19<04:47, 31.95s/it]ELBO: -839519.6:  47%|████▋     | 7/15 [04:19<04:06, 30.82s/it]ELBO: -840295.6:  47%|████▋     | 7/15 [04:47<04:06, 30.82s/it]ELBO: -840295.6:  53%|█████▎    | 8/15 [04:47<03:30, 30.09s/it]ELBO: -839878.9:  53%|█████▎    | 8/15 [05:16<03:30, 30.09s/it]ELBO: -839878.9:  60%|██████    | 9/15 [05:16<02:57, 29.55s/it]ELBO: -839685.8:  60%|██████    | 9/15 [05:44<02:57, 29.55s/it]ELBO: -839685.8:  67%|██████▋   | 10/15 [05:44<02:26, 29.30s/it]ELBO: -839563.1:  67%|██████▋   | 10/15 [06:13<02:26, 29.30s/it]ELBO: -839563.1:  73%|███████▎  | 11/15 [06:13<01:56, 29.05s/it]ELBO: -839553.7:  73%|███████▎  | 11/15 [06:41<01:56, 29.05s/it]ELBO: -839553.7:  80%|████████  | 12/15 [06:41<01:26, 28.86s/it]ELBO: -839869.8:  80%|████████  | 12/15 [07:10<01:26, 28.86s/it]ELBO: -839869.8:  87%|████████▋ | 13/15 [07:10<00:57, 28.73s/it]ELBO: -839364.5:  87%|████████▋ | 13/15 [07:38<00:57, 28.73s/it]ELBO: -839364.5:  93%|█████████▎| 14/15 [07:38<00:28, 28.62s/it]ELBO: -839483.6:  93%|█████████▎| 14/15 [08:07<00:28, 28.62s/it]ELBO: -839483.6: 100%|██████████| 15/15 [08:07<00:00, 28.60s/it]ELBO: -839483.6: 100%|██████████| 15/15 [08:07<00:00, 32.47s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -6468369.5:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -844431.0:   0%|          | 0/15 [01:09<?, ?it/s] ELBO: -844431.0:   7%|▋         | 1/15 [01:09<16:12, 69.43s/it]ELBO: -843785.2:   7%|▋         | 1/15 [01:37<16:12, 69.43s/it]ELBO: -843785.2:  13%|█▎        | 2/15 [01:37<09:49, 45.34s/it]ELBO: -843650.7:  13%|█▎        | 2/15 [02:06<09:49, 45.34s/it]ELBO: -843650.7:  20%|██        | 3/15 [02:06<07:32, 37.69s/it]ELBO: -844146.8:  20%|██        | 3/15 [02:35<07:32, 37.69s/it]ELBO: -844146.8:  27%|██▋       | 4/15 [02:35<06:15, 34.09s/it]ELBO: -843993.9:  27%|██▋       | 4/15 [03:03<06:15, 34.09s/it]ELBO: -843993.9:  33%|███▎      | 5/15 [03:03<05:21, 32.16s/it]ELBO: -844747.7:  33%|███▎      | 5/15 [03:32<05:21, 32.16s/it]ELBO: -844747.7:  40%|████      | 6/15 [03:32<04:37, 30.88s/it]ELBO: -843917.6:  40%|████      | 6/15 [04:00<04:37, 30.88s/it]ELBO: -843917.6:  47%|████▋     | 7/15 [04:00<04:00, 30.10s/it]ELBO: -843979.3:  47%|████▋     | 7/15 [04:29<04:00, 30.10s/it]ELBO: -843979.3:  53%|█████▎    | 8/15 [04:29<03:27, 29.62s/it]ELBO: -843956.7:  53%|█████▎    | 8/15 [04:57<03:27, 29.62s/it]ELBO: -843956.7:  60%|██████    | 9/15 [04:57<02:55, 29.24s/it]ELBO: -844532.6:  60%|██████    | 9/15 [05:26<02:55, 29.24s/it]ELBO: -844532.6:  67%|██████▋   | 10/15 [05:26<02:25, 29.11s/it]ELBO: -843931.9:  67%|██████▋   | 10/15 [05:55<02:25, 29.11s/it]ELBO: -843931.9:  73%|███████▎  | 11/15 [05:55<01:55, 28.99s/it]ELBO: -843516.3:  73%|███████▎  | 11/15 [06:23<01:55, 28.99s/it]ELBO: -843516.3:  80%|████████  | 12/15 [06:23<01:26, 28.89s/it]ELBO: -844029.8:  80%|████████  | 12/15 [06:52<01:26, 28.89s/it]ELBO: -844029.8:  87%|████████▋ | 13/15 [06:52<00:57, 28.82s/it]ELBO: -844505.9:  87%|████████▋ | 13/15 [07:21<00:57, 28.82s/it]ELBO: -844505.9:  93%|█████████▎| 14/15 [07:21<00:28, 28.76s/it]ELBO: -843803.9:  93%|█████████▎| 14/15 [07:49<00:28, 28.76s/it]ELBO: -843803.9: 100%|██████████| 15/15 [07:49<00:00, 28.75s/it]ELBO: -843803.9: 100%|██████████| 15/15 [07:49<00:00, 31.33s/it]
