Processed spikes from trial 100.
Processed spikes from trial 200.
Processed spikes from trial 300.
  0%|          | 0/1 [00:00<?, ?it/s]ARHMM Initialization restarts:   0%|          | 0/1 [00:00<?, ?it/s]Initializing with an ARHMM using 25 steps of EM.

  0%|          | 0/25 [00:00<?, ?it/s][A
LP: -2473173.9:   0%|          | 0/25 [00:00<?, ?it/s][A
LP: -2473173.9:   0%|          | 0/25 [00:00<?, ?it/s][A
LP: -2473173.9:   4%|▍         | 1/25 [00:00<00:13,  1.72it/s][A
LP: -2473173.9:   4%|▍         | 1/25 [00:01<00:13,  1.72it/s][A
LP: -2473173.9:   8%|▊         | 2/25 [00:01<00:14,  1.63it/s][A
LP: -2473173.9:   8%|▊         | 2/25 [00:01<00:14,  1.63it/s][A
LP: -2473173.9:  12%|█▏        | 3/25 [00:01<00:13,  1.60it/s][A
LP: -2473173.9:  12%|█▏        | 3/25 [00:02<00:13,  1.60it/s][A
LP: -2473173.9:  16%|█▌        | 4/25 [00:02<00:12,  1.65it/s][A
LP: -2473173.9:  16%|█▌        | 4/25 [00:02<00:12,  1.65it/s][A
LP: -2473173.9:  20%|██        | 5/25 [00:02<00:11,  1.69it/s][A
LP: -2473173.9:  20%|██        | 5/25 [00:03<00:11,  1.69it/s][A
LP: -2473173.9:  24%|██▍       | 6/25 [00:03<00:11,  1.66it/s][A
LP: -2473173.9:  24%|██▍       | 6/25 [00:04<00:11,  1.66it/s][A
LP: -2473173.9:  28%|██▊       | 7/25 [00:04<00:10,  1.68it/s][A
LP: -2473173.9:  28%|██▊       | 7/25 [00:04<00:10,  1.68it/s][A
LP: -2473173.9:  32%|███▏      | 8/25 [00:04<00:10,  1.69it/s][A
LP: -2473173.9:  32%|███▏      | 8/25 [00:05<00:10,  1.69it/s][A
LP: -2473173.9:  36%|███▌      | 9/25 [00:05<00:09,  1.71it/s][A
LP: -2473173.9:  36%|███▌      | 9/25 [00:05<00:09,  1.71it/s][A
LP: -2473173.9:  40%|████      | 10/25 [00:05<00:08,  1.72it/s][A
LP: -2473173.9:  40%|████      | 10/25 [00:06<00:08,  1.72it/s][A
LP: -2473173.9:  44%|████▍     | 11/25 [00:06<00:08,  1.73it/s][A
LP: -2473173.9:  44%|████▍     | 11/25 [00:07<00:08,  1.73it/s][A
LP: -2473173.9:  48%|████▊     | 12/25 [00:07<00:07,  1.75it/s][A
LP: -2473173.9:  48%|████▊     | 12/25 [00:07<00:07,  1.75it/s][A
LP: -2473173.9:  52%|█████▏    | 13/25 [00:07<00:06,  1.75it/s][A
LP: -2473173.9:  52%|█████▏    | 13/25 [00:08<00:06,  1.75it/s][A
LP: -2473173.9:  56%|█████▌    | 14/25 [00:08<00:06,  1.75it/s][A
LP: -2473173.9:  56%|█████▌    | 14/25 [00:08<00:06,  1.75it/s][A
LP: -2473173.9:  60%|██████    | 15/25 [00:08<00:05,  1.74it/s][A
LP: -2473173.9:  60%|██████    | 15/25 [00:09<00:05,  1.74it/s][A
LP: -2473173.9:  64%|██████▍   | 16/25 [00:09<00:05,  1.76it/s][A
LP: -2473173.9:  64%|██████▍   | 16/25 [00:09<00:05,  1.76it/s][A
LP: -2473173.9:  68%|██████▊   | 17/25 [00:09<00:04,  1.75it/s][A
LP: -2473173.9:  68%|██████▊   | 17/25 [00:10<00:04,  1.75it/s][A
LP: -2473173.9:  72%|███████▏  | 18/25 [00:10<00:04,  1.73it/s][A
LP: -2473173.9:  72%|███████▏  | 18/25 [00:11<00:04,  1.73it/s][A
LP: -2473173.9:  76%|███████▌  | 19/25 [00:11<00:03,  1.72it/s][A
LP: -2473173.9:  76%|███████▌  | 19/25 [00:11<00:03,  1.72it/s][A
LP: -2473173.9:  80%|████████  | 20/25 [00:11<00:02,  1.73it/s][A
LP: -2473173.9:  80%|████████  | 20/25 [00:12<00:02,  1.73it/s][A
LP: -2473173.9:  84%|████████▍ | 21/25 [00:12<00:02,  1.75it/s][A
LP: -2473173.9:  84%|████████▍ | 21/25 [00:12<00:02,  1.75it/s][A
LP: -2473173.9:  88%|████████▊ | 22/25 [00:12<00:01,  1.77it/s][A
LP: -2473173.9:  88%|████████▊ | 22/25 [00:13<00:01,  1.77it/s][A
LP: -2473173.9:  92%|█████████▏| 23/25 [00:13<00:01,  1.77it/s][A
LP: -2473173.9:  92%|█████████▏| 23/25 [00:13<00:01,  1.77it/s][A
LP: -2473173.9:  96%|█████████▌| 24/25 [00:13<00:00,  1.75it/s][A
LP: -2473173.9:  96%|█████████▌| 24/25 [00:14<00:00,  1.75it/s][A
LP: -2473173.9: 100%|██████████| 25/25 [00:14<00:00,  1.75it/s][ALP: -2473173.9: 100%|██████████| 25/25 [00:14<00:00,  1.72it/s]
ARHMM Initialization restarts: 100%|██████████| 1/1 [00:15<00:00, 15.21s/it]ARHMM Initialization restarts: 100%|██████████| 1/1 [00:15<00:00, 15.21s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -7443846.0:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -4535594.2:   0%|          | 0/15 [02:13<?, ?it/s]ELBO: -4535594.2:   7%|▋         | 1/15 [02:13<31:02, 133.00s/it]ELBO: -4490206.1:   7%|▋         | 1/15 [03:52<31:02, 133.00s/it]ELBO: -4490206.1:  13%|█▎        | 2/15 [03:52<24:35, 113.52s/it]ELBO: -4471670.7:  13%|█▎        | 2/15 [05:14<24:35, 113.52s/it]ELBO: -4471670.7:  20%|██        | 3/15 [05:14<19:49, 99.15s/it] ELBO: -4459180.2:  20%|██        | 3/15 [06:36<19:49, 99.15s/it]ELBO: -4459180.2:  27%|██▋       | 4/15 [06:36<16:55, 92.31s/it]ELBO: -4451479.9:  27%|██▋       | 4/15 [07:56<16:55, 92.31s/it]ELBO: -4451479.9:  33%|███▎      | 5/15 [07:56<14:36, 87.60s/it]ELBO: -4445001.7:  33%|███▎      | 5/15 [09:13<14:36, 87.60s/it]ELBO: -4445001.7:  40%|████      | 6/15 [09:13<12:37, 84.19s/it]ELBO: -4438380.0:  40%|████      | 6/15 [10:30<12:37, 84.19s/it]ELBO: -4438380.0:  47%|████▋     | 7/15 [10:30<10:54, 81.85s/it]ELBO: -4435019.8:  47%|████▋     | 7/15 [11:47<10:54, 81.85s/it]ELBO: -4435019.8:  53%|█████▎    | 8/15 [11:47<09:22, 80.42s/it]ELBO: -4431224.6:  53%|█████▎    | 8/15 [13:05<09:22, 80.42s/it]ELBO: -4431224.6:  60%|██████    | 9/15 [13:05<07:56, 79.49s/it]ELBO: -4429980.1:  60%|██████    | 9/15 [14:23<07:56, 79.49s/it]ELBO: -4429980.1:  67%|██████▋   | 10/15 [14:23<06:34, 78.91s/it]ELBO: -4424060.7:  67%|██████▋   | 10/15 [15:40<06:34, 78.91s/it]ELBO: -4424060.7:  73%|███████▎  | 11/15 [15:40<05:13, 78.41s/it]ELBO: -4424059.4:  73%|███████▎  | 11/15 [16:57<05:13, 78.41s/it]ELBO: -4424059.4:  80%|████████  | 12/15 [16:57<03:54, 78.03s/it]ELBO: -4422488.5:  80%|████████  | 12/15 [18:15<03:54, 78.03s/it]ELBO: -4422488.5:  87%|████████▋ | 13/15 [18:15<02:35, 77.88s/it]ELBO: -4420311.8:  87%|████████▋ | 13/15 [19:32<02:35, 77.88s/it]ELBO: -4420311.8:  93%|█████████▎| 14/15 [19:32<01:17, 77.75s/it]ELBO: -4418977.4:  93%|█████████▎| 14/15 [20:45<01:17, 77.75s/it]ELBO: -4418977.4: 100%|██████████| 15/15 [20:45<00:00, 76.34s/it]ELBO: -4418977.4: 100%|██████████| 15/15 [20:45<00:00, 83.04s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -3506620.5:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -917066.2:   0%|          | 0/15 [00:27<?, ?it/s] ELBO: -917066.2:   7%|▋         | 1/15 [00:27<06:30, 27.89s/it]ELBO: -916866.0:   7%|▋         | 1/15 [00:38<06:30, 27.89s/it]ELBO: -916866.0:  13%|█▎        | 2/15 [00:38<03:48, 17.60s/it]ELBO: -917034.4:  13%|█▎        | 2/15 [00:48<03:48, 17.60s/it]ELBO: -917034.4:  20%|██        | 3/15 [00:48<02:51, 14.31s/it]ELBO: -917068.1:  20%|██        | 3/15 [00:59<02:51, 14.31s/it]ELBO: -917068.1:  27%|██▋       | 4/15 [00:59<02:21, 12.83s/it]ELBO: -917519.0:  27%|██▋       | 4/15 [01:09<02:21, 12.83s/it]ELBO: -917519.0:  33%|███▎      | 5/15 [01:09<01:59, 11.96s/it]ELBO: -918008.5:  33%|███▎      | 5/15 [01:20<01:59, 11.96s/it]ELBO: -918008.5:  40%|████      | 6/15 [01:20<01:42, 11.42s/it]ELBO: -917480.8:  40%|████      | 6/15 [01:30<01:42, 11.42s/it]ELBO: -917480.8:  47%|████▋     | 7/15 [01:30<01:28, 11.09s/it]ELBO: -917049.4:  47%|████▋     | 7/15 [01:40<01:28, 11.09s/it]ELBO: -917049.4:  53%|█████▎    | 8/15 [01:40<01:16, 10.88s/it]ELBO: -917323.2:  53%|█████▎    | 8/15 [01:51<01:16, 10.88s/it]ELBO: -917323.2:  60%|██████    | 9/15 [01:51<01:04, 10.72s/it]ELBO: -917383.9:  60%|██████    | 9/15 [02:01<01:04, 10.72s/it]ELBO: -917383.9:  67%|██████▋   | 10/15 [02:01<00:53, 10.64s/it]ELBO: -917117.2:  67%|██████▋   | 10/15 [02:12<00:53, 10.64s/it]ELBO: -917117.2:  73%|███████▎  | 11/15 [02:12<00:42, 10.56s/it]ELBO: -917227.7:  73%|███████▎  | 11/15 [02:22<00:42, 10.56s/it]ELBO: -917227.7:  80%|████████  | 12/15 [02:22<00:31, 10.52s/it]ELBO: -917456.5:  80%|████████  | 12/15 [02:32<00:31, 10.52s/it]ELBO: -917456.5:  87%|████████▋ | 13/15 [02:32<00:20, 10.50s/it]ELBO: -917241.8:  87%|████████▋ | 13/15 [02:43<00:20, 10.50s/it]ELBO: -917241.8:  93%|█████████▎| 14/15 [02:43<00:10, 10.47s/it]ELBO: -916882.1:  93%|█████████▎| 14/15 [02:53<00:10, 10.47s/it]ELBO: -916882.1: 100%|██████████| 15/15 [02:53<00:00, 10.45s/it]ELBO: -916882.1: 100%|██████████| 15/15 [02:53<00:00, 11.59s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -3243107.3:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -802128.4:   0%|          | 0/15 [00:28<?, ?it/s] ELBO: -802128.4:   7%|▋         | 1/15 [00:28<06:42, 28.76s/it]ELBO: -801855.0:   7%|▋         | 1/15 [00:39<06:42, 28.76s/it]ELBO: -801855.0:  13%|█▎        | 2/15 [00:39<03:53, 17.98s/it]ELBO: -802504.5:  13%|█▎        | 2/15 [00:49<03:53, 17.98s/it]ELBO: -802504.5:  20%|██        | 3/15 [00:49<02:54, 14.57s/it]ELBO: -802384.4:  20%|██        | 3/15 [01:00<02:54, 14.57s/it]ELBO: -802384.4:  27%|██▋       | 4/15 [01:00<02:22, 12.93s/it]ELBO: -801921.0:  27%|██▋       | 4/15 [01:10<02:22, 12.93s/it]ELBO: -801921.0:  33%|███▎      | 5/15 [01:10<02:00, 12.06s/it]ELBO: -801697.2:  33%|███▎      | 5/15 [01:20<02:00, 12.06s/it]ELBO: -801697.2:  40%|████      | 6/15 [01:20<01:43, 11.48s/it]ELBO: -802080.5:  40%|████      | 6/15 [01:31<01:43, 11.48s/it]ELBO: -802080.5:  47%|████▋     | 7/15 [01:31<01:29, 11.15s/it]ELBO: -801938.3:  47%|████▋     | 7/15 [01:41<01:29, 11.15s/it]ELBO: -801938.3:  53%|█████▎    | 8/15 [01:41<01:16, 10.89s/it]ELBO: -801569.8:  53%|█████▎    | 8/15 [01:52<01:16, 10.89s/it]ELBO: -801569.8:  60%|██████    | 9/15 [01:52<01:04, 10.77s/it]ELBO: -801702.1:  60%|██████    | 9/15 [02:02<01:04, 10.77s/it]ELBO: -801702.1:  67%|██████▋   | 10/15 [02:02<00:53, 10.65s/it]ELBO: -801708.5:  67%|██████▋   | 10/15 [02:13<00:53, 10.65s/it]ELBO: -801708.5:  73%|███████▎  | 11/15 [02:13<00:42, 10.59s/it]ELBO: -801241.7:  73%|███████▎  | 11/15 [02:23<00:42, 10.59s/it]ELBO: -801241.7:  80%|████████  | 12/15 [02:23<00:31, 10.56s/it]ELBO: -801154.0:  80%|████████  | 12/15 [02:34<00:31, 10.56s/it]ELBO: -801154.0:  87%|████████▋ | 13/15 [02:34<00:21, 10.52s/it]ELBO: -801806.3:  87%|████████▋ | 13/15 [02:44<00:21, 10.52s/it]ELBO: -801806.3:  93%|█████████▎| 14/15 [02:44<00:10, 10.50s/it]ELBO: -801805.5:  93%|█████████▎| 14/15 [02:54<00:10, 10.50s/it]ELBO: -801805.5: 100%|██████████| 15/15 [02:54<00:00, 10.47s/it]ELBO: -801805.5: 100%|██████████| 15/15 [02:54<00:00, 11.66s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -3469890.7:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -826751.1:   0%|          | 0/15 [00:32<?, ?it/s] ELBO: -826751.1:   7%|▋         | 1/15 [00:32<07:40, 32.86s/it]ELBO: -826786.6:   7%|▋         | 1/15 [00:43<07:40, 32.86s/it]ELBO: -826786.6:  13%|█▎        | 2/15 [00:43<04:16, 19.71s/it]ELBO: -827203.9:  13%|█▎        | 2/15 [00:53<04:16, 19.71s/it]ELBO: -827203.9:  20%|██        | 3/15 [00:53<03:05, 15.47s/it]ELBO: -826807.5:  20%|██        | 3/15 [01:04<03:05, 15.47s/it]ELBO: -826807.5:  27%|██▋       | 4/15 [01:04<02:28, 13.46s/it]ELBO: -827193.4:  27%|██▋       | 4/15 [01:14<02:28, 13.46s/it]ELBO: -827193.4:  33%|███▎      | 5/15 [01:14<02:03, 12.36s/it]ELBO: -827526.3:  33%|███▎      | 5/15 [01:24<02:03, 12.36s/it]ELBO: -827526.3:  40%|████      | 6/15 [01:24<01:45, 11.69s/it]ELBO: -826568.9:  40%|████      | 6/15 [01:35<01:45, 11.69s/it]ELBO: -826568.9:  47%|████▋     | 7/15 [01:35<01:30, 11.34s/it]ELBO: -827494.0:  47%|████▋     | 7/15 [01:45<01:30, 11.34s/it]ELBO: -827494.0:  53%|█████▎    | 8/15 [01:45<01:17, 11.05s/it]ELBO: -827302.6:  53%|█████▎    | 8/15 [01:56<01:17, 11.05s/it]ELBO: -827302.6:  60%|██████    | 9/15 [01:56<01:04, 10.83s/it]ELBO: -827536.9:  60%|██████    | 9/15 [02:06<01:04, 10.83s/it]ELBO: -827536.9:  67%|██████▋   | 10/15 [02:06<00:53, 10.73s/it]ELBO: -827042.1:  67%|██████▋   | 10/15 [02:17<00:53, 10.73s/it]ELBO: -827042.1:  73%|███████▎  | 11/15 [02:17<00:42, 10.64s/it]ELBO: -827292.0:  73%|███████▎  | 11/15 [02:27<00:42, 10.64s/it]ELBO: -827292.0:  80%|████████  | 12/15 [02:27<00:31, 10.64s/it]ELBO: -826955.4:  80%|████████  | 12/15 [02:38<00:31, 10.64s/it]ELBO: -826955.4:  87%|████████▋ | 13/15 [02:38<00:21, 10.57s/it]ELBO: -827673.2:  87%|████████▋ | 13/15 [02:48<00:21, 10.57s/it]ELBO: -827673.2:  93%|█████████▎| 14/15 [02:48<00:10, 10.54s/it]ELBO: -827195.4:  93%|█████████▎| 14/15 [02:59<00:10, 10.54s/it]ELBO: -827195.4: 100%|██████████| 15/15 [02:59<00:00, 10.51s/it]ELBO: -827195.4: 100%|██████████| 15/15 [02:59<00:00, 11.95s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -3137640.5:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -875118.1:   0%|          | 0/15 [00:24<?, ?it/s] ELBO: -875118.1:   7%|▋         | 1/15 [00:24<05:36, 24.03s/it]ELBO: -875916.9:   7%|▋         | 1/15 [00:34<05:36, 24.03s/it]ELBO: -875916.9:  13%|█▎        | 2/15 [00:34<03:27, 15.99s/it]ELBO: -874923.4:  13%|█▎        | 2/15 [00:44<03:27, 15.99s/it]ELBO: -874923.4:  20%|██        | 3/15 [00:44<02:41, 13.46s/it]ELBO: -875366.0:  20%|██        | 3/15 [00:55<02:41, 13.46s/it]ELBO: -875366.0:  27%|██▋       | 4/15 [00:55<02:14, 12.25s/it]ELBO: -875482.2:  27%|██▋       | 4/15 [01:05<02:14, 12.25s/it]ELBO: -875482.2:  33%|███▎      | 5/15 [01:05<01:55, 11.59s/it]ELBO: -875330.2:  33%|███▎      | 5/15 [01:16<01:55, 11.59s/it]ELBO: -875330.2:  40%|████      | 6/15 [01:16<01:40, 11.20s/it]ELBO: -875268.3:  40%|████      | 6/15 [01:26<01:40, 11.20s/it]ELBO: -875268.3:  47%|████▋     | 7/15 [01:26<01:27, 10.94s/it]ELBO: -875748.1:  47%|████▋     | 7/15 [01:36<01:27, 10.94s/it]ELBO: -875748.1:  53%|█████▎    | 8/15 [01:36<01:15, 10.78s/it]ELBO: -875503.2:  53%|█████▎    | 8/15 [01:47<01:15, 10.78s/it]ELBO: -875503.2:  60%|██████    | 9/15 [01:47<01:03, 10.64s/it]ELBO: -875517.5:  60%|██████    | 9/15 [01:57<01:03, 10.64s/it]ELBO: -875517.5:  67%|██████▋   | 10/15 [01:57<00:53, 10.62s/it]ELBO: -875613.5:  67%|██████▋   | 10/15 [02:08<00:53, 10.62s/it]ELBO: -875613.5:  73%|███████▎  | 11/15 [02:08<00:42, 10.54s/it]ELBO: -875047.3:  73%|███████▎  | 11/15 [02:18<00:42, 10.54s/it]ELBO: -875047.3:  80%|████████  | 12/15 [02:18<00:31, 10.51s/it]ELBO: -875131.4:  80%|████████  | 12/15 [02:28<00:31, 10.51s/it]ELBO: -875131.4:  87%|████████▋ | 13/15 [02:28<00:20, 10.45s/it]ELBO: -875047.1:  87%|████████▋ | 13/15 [02:39<00:20, 10.45s/it]ELBO: -875047.1:  93%|█████████▎| 14/15 [02:39<00:10, 10.43s/it]ELBO: -875073.4:  93%|█████████▎| 14/15 [02:49<00:10, 10.43s/it]ELBO: -875073.4: 100%|██████████| 15/15 [02:49<00:00, 10.42s/it]ELBO: -875073.4: 100%|██████████| 15/15 [02:49<00:00, 11.32s/it]
