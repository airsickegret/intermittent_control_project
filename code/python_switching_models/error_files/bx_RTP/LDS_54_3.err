Processed spikes from trial 100.
Processed spikes from trial 200.
Processed spikes from trial 300.
  0%|          | 0/1 [00:00<?, ?it/s]ARHMM Initialization restarts:   0%|          | 0/1 [00:00<?, ?it/s]Initializing with an ARHMM using 25 steps of EM.

  0%|          | 0/25 [00:00<?, ?it/s][A
LP: -4089888.9:   0%|          | 0/25 [00:00<?, ?it/s][A
LP: -4089888.9:   0%|          | 0/25 [00:01<?, ?it/s][A
LP: -4089888.9:   4%|▍         | 1/25 [00:01<00:27,  1.13s/it][A
LP: -4089888.9:   4%|▍         | 1/25 [00:02<00:27,  1.13s/it][A
LP: -4089888.9:   8%|▊         | 2/25 [00:02<00:26,  1.17s/it][A
LP: -4089888.9:   8%|▊         | 2/25 [00:03<00:26,  1.17s/it][A
LP: -4089888.9:  12%|█▏        | 3/25 [00:03<00:26,  1.18s/it][A
LP: -4089888.9:  12%|█▏        | 3/25 [00:04<00:26,  1.18s/it][A
LP: -4089888.9:  16%|█▌        | 4/25 [00:04<00:24,  1.16s/it][A
LP: -4089888.9:  16%|█▌        | 4/25 [00:05<00:24,  1.16s/it][A
LP: -4089888.9:  20%|██        | 5/25 [00:05<00:22,  1.15s/it][A
LP: -4089888.9:  20%|██        | 5/25 [00:06<00:22,  1.15s/it][A
LP: -4089888.9:  24%|██▍       | 6/25 [00:06<00:21,  1.13s/it][A
LP: -4089888.9:  24%|██▍       | 6/25 [00:07<00:21,  1.13s/it][A
LP: -4089888.9:  28%|██▊       | 7/25 [00:07<00:20,  1.13s/it][A
LP: -4089888.9:  28%|██▊       | 7/25 [00:09<00:20,  1.13s/it][A
LP: -4089888.9:  32%|███▏      | 8/25 [00:09<00:19,  1.13s/it][A
LP: -4089888.9:  32%|███▏      | 8/25 [00:10<00:19,  1.13s/it][A
LP: -4089888.9:  36%|███▌      | 9/25 [00:10<00:17,  1.12s/it][A
LP: -4089888.9:  36%|███▌      | 9/25 [00:11<00:17,  1.12s/it][A
LP: -4089888.9:  40%|████      | 10/25 [00:11<00:16,  1.12s/it][A
LP: -4089888.9:  40%|████      | 10/25 [00:12<00:16,  1.12s/it][A
LP: -4089888.9:  44%|████▍     | 11/25 [00:12<00:15,  1.13s/it][A
LP: -4089888.9:  44%|████▍     | 11/25 [00:13<00:15,  1.13s/it][A
LP: -4089888.9:  48%|████▊     | 12/25 [00:13<00:14,  1.13s/it][A
LP: -4089888.9:  48%|████▊     | 12/25 [00:14<00:14,  1.13s/it][A
LP: -4089888.9:  52%|█████▏    | 13/25 [00:14<00:13,  1.15s/it][A
LP: -4089888.9:  52%|█████▏    | 13/25 [00:15<00:13,  1.15s/it][A
LP: -4089888.9:  56%|█████▌    | 14/25 [00:15<00:12,  1.14s/it][A
LP: -4089888.9:  56%|█████▌    | 14/25 [00:17<00:12,  1.14s/it][A
LP: -4089888.9:  60%|██████    | 15/25 [00:17<00:11,  1.14s/it][A
LP: -4089888.9:  60%|██████    | 15/25 [00:18<00:11,  1.14s/it][A
LP: -4089888.9:  64%|██████▍   | 16/25 [00:18<00:10,  1.12s/it][A
LP: -4089888.9:  64%|██████▍   | 16/25 [00:19<00:10,  1.12s/it][A
LP: -4089888.9:  68%|██████▊   | 17/25 [00:19<00:09,  1.13s/it][A
LP: -4089888.9:  68%|██████▊   | 17/25 [00:20<00:09,  1.13s/it][A
LP: -4089888.9:  72%|███████▏  | 18/25 [00:20<00:07,  1.13s/it][A
LP: -4089888.9:  72%|███████▏  | 18/25 [00:21<00:07,  1.13s/it][A
LP: -4089888.9:  76%|███████▌  | 19/25 [00:21<00:06,  1.13s/it][A
LP: -4089888.9:  76%|███████▌  | 19/25 [00:22<00:06,  1.13s/it][A
LP: -4089888.9:  80%|████████  | 20/25 [00:22<00:05,  1.13s/it][A
LP: -4089888.9:  80%|████████  | 20/25 [00:23<00:05,  1.13s/it][A
LP: -4089888.9:  84%|████████▍ | 21/25 [00:23<00:04,  1.13s/it][A
LP: -4089888.9:  84%|████████▍ | 21/25 [00:24<00:04,  1.13s/it][A
LP: -4089888.9:  88%|████████▊ | 22/25 [00:24<00:03,  1.13s/it][A
LP: -4089888.9:  88%|████████▊ | 22/25 [00:26<00:03,  1.13s/it][A
LP: -4089888.9:  92%|█████████▏| 23/25 [00:26<00:02,  1.13s/it][A
LP: -4089888.9:  92%|█████████▏| 23/25 [00:27<00:02,  1.13s/it][A
LP: -4089888.9:  96%|█████████▌| 24/25 [00:27<00:01,  1.13s/it][A
LP: -4089888.9:  96%|█████████▌| 24/25 [00:28<00:01,  1.13s/it][A
LP: -4089888.9: 100%|██████████| 25/25 [00:28<00:00,  1.13s/it][ALP: -4089888.9: 100%|██████████| 25/25 [00:28<00:00,  1.13s/it]
ARHMM Initialization restarts: 100%|██████████| 1/1 [00:29<00:00, 29.74s/it]ARHMM Initialization restarts: 100%|██████████| 1/1 [00:29<00:00, 29.74s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -9525083.8:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -4639066.4:   0%|          | 0/15 [04:35<?, ?it/s]ELBO: -4639066.4:   7%|▋         | 1/15 [04:35<1:04:19, 275.70s/it]ELBO: -4578571.0:   7%|▋         | 1/15 [08:09<1:04:19, 275.70s/it]ELBO: -4578571.0:  13%|█▎        | 2/15 [08:09<51:50, 239.30s/it]  ELBO: -4551953.6:  13%|█▎        | 2/15 [11:21<51:50, 239.30s/it]ELBO: -4551953.6:  20%|██        | 3/15 [11:21<43:30, 217.54s/it]ELBO: -4533524.6:  20%|██        | 3/15 [14:33<43:30, 217.54s/it]ELBO: -4533524.6:  27%|██▋       | 4/15 [14:33<38:03, 207.64s/it]ELBO: -4524004.5:  27%|██▋       | 4/15 [17:45<38:03, 207.64s/it]ELBO: -4524004.5:  33%|███▎      | 5/15 [17:45<33:40, 202.02s/it]ELBO: -4513815.2:  33%|███▎      | 5/15 [20:58<33:40, 202.02s/it]ELBO: -4513815.2:  40%|████      | 6/15 [20:58<29:49, 198.79s/it]ELBO: -4510164.0:  40%|████      | 6/15 [24:04<29:49, 198.79s/it]ELBO: -4510164.0:  47%|████▋     | 7/15 [24:04<25:58, 194.81s/it]ELBO: -4503440.9:  47%|████▋     | 7/15 [27:14<25:58, 194.81s/it]ELBO: -4503440.9:  53%|█████▎    | 8/15 [27:14<22:31, 193.02s/it]ELBO: -4501186.5:  53%|█████▎    | 8/15 [30:23<22:31, 193.02s/it]ELBO: -4501186.5:  60%|██████    | 9/15 [30:23<19:11, 191.94s/it]ELBO: -4497878.7:  60%|██████    | 9/15 [33:29<19:11, 191.94s/it]ELBO: -4497878.7:  67%|██████▋   | 10/15 [33:29<15:50, 190.14s/it]ELBO: -4495034.5:  67%|██████▋   | 10/15 [36:35<15:50, 190.14s/it]ELBO: -4495034.5:  73%|███████▎  | 11/15 [36:35<12:35, 188.85s/it]ELBO: -4491622.6:  73%|███████▎  | 11/15 [39:45<12:35, 188.85s/it]ELBO: -4491622.6:  80%|████████  | 12/15 [39:45<09:27, 189.03s/it]ELBO: -4490002.1:  80%|████████  | 12/15 [42:51<09:27, 189.03s/it]ELBO: -4490002.1:  87%|████████▋ | 13/15 [42:51<06:16, 188.27s/it]ELBO: -4485567.9:  87%|████████▋ | 13/15 [45:58<06:16, 188.27s/it]ELBO: -4485567.9:  93%|█████████▎| 14/15 [45:58<03:07, 187.80s/it]ELBO: -4488179.9:  93%|█████████▎| 14/15 [49:04<03:07, 187.80s/it]ELBO: -4488179.9: 100%|██████████| 15/15 [49:04<00:00, 187.25s/it]ELBO: -4488179.9: 100%|██████████| 15/15 [49:04<00:00, 196.28s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -9768392.7:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -848919.8:   0%|          | 0/15 [01:07<?, ?it/s] ELBO: -848919.8:   7%|▋         | 1/15 [01:07<15:39, 67.08s/it]ELBO: -850221.9:   7%|▋         | 1/15 [01:33<15:39, 67.08s/it]ELBO: -850221.9:  13%|█▎        | 2/15 [01:33<09:21, 43.17s/it]ELBO: -848820.2:  13%|█▎        | 2/15 [01:59<09:21, 43.17s/it]ELBO: -848820.2:  20%|██        | 3/15 [01:59<07:06, 35.53s/it]ELBO: -850000.4:  20%|██        | 3/15 [02:26<07:06, 35.53s/it]ELBO: -850000.4:  27%|██▋       | 4/15 [02:26<05:51, 31.94s/it]ELBO: -850012.8:  27%|██▋       | 4/15 [02:53<05:51, 31.94s/it]ELBO: -850012.8:  33%|███▎      | 5/15 [02:53<05:00, 30.02s/it]ELBO: -849488.7:  33%|███▎      | 5/15 [03:19<05:00, 30.02s/it]ELBO: -849488.7:  40%|████      | 6/15 [03:19<04:19, 28.81s/it]ELBO: -849383.6:  40%|████      | 6/15 [03:46<04:19, 28.81s/it]ELBO: -849383.6:  47%|████▋     | 7/15 [03:46<03:45, 28.17s/it]ELBO: -849332.9:  47%|████▋     | 7/15 [04:12<03:45, 28.17s/it]ELBO: -849332.9:  53%|█████▎    | 8/15 [04:12<03:13, 27.67s/it]ELBO: -849331.4:  53%|█████▎    | 8/15 [04:39<03:13, 27.67s/it]ELBO: -849331.4:  60%|██████    | 9/15 [04:39<02:43, 27.28s/it]ELBO: -849666.0:  60%|██████    | 9/15 [05:05<02:43, 27.28s/it]ELBO: -849666.0:  67%|██████▋   | 10/15 [05:05<02:15, 27.06s/it]ELBO: -849603.9:  67%|██████▋   | 10/15 [05:32<02:15, 27.06s/it]ELBO: -849603.9:  73%|███████▎  | 11/15 [05:32<01:47, 26.89s/it]ELBO: -848956.9:  73%|███████▎  | 11/15 [05:58<01:47, 26.89s/it]ELBO: -848956.9:  80%|████████  | 12/15 [05:58<01:20, 26.78s/it]ELBO: -849964.3:  80%|████████  | 12/15 [06:25<01:20, 26.78s/it]ELBO: -849964.3:  87%|████████▋ | 13/15 [06:25<00:53, 26.81s/it]ELBO: -850461.7:  87%|████████▋ | 13/15 [06:52<00:53, 26.81s/it]ELBO: -850461.7:  93%|█████████▎| 14/15 [06:52<00:26, 26.71s/it]ELBO: -849985.0:  93%|█████████▎| 14/15 [07:18<00:26, 26.71s/it]ELBO: -849985.0: 100%|██████████| 15/15 [07:18<00:00, 26.66s/it]ELBO: -849985.0: 100%|██████████| 15/15 [07:18<00:00, 29.26s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -9572376.6:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -753533.7:   0%|          | 0/15 [01:06<?, ?it/s] ELBO: -753533.7:   7%|▋         | 1/15 [01:06<15:26, 66.18s/it]ELBO: -755237.9:   7%|▋         | 1/15 [01:32<15:26, 66.18s/it]ELBO: -755237.9:  13%|█▎        | 2/15 [01:32<09:17, 42.86s/it]ELBO: -754528.9:  13%|█▎        | 2/15 [01:59<09:17, 42.86s/it]ELBO: -754528.9:  20%|██        | 3/15 [01:59<07:03, 35.31s/it]ELBO: -754217.3:  20%|██        | 3/15 [02:25<07:03, 35.31s/it]ELBO: -754217.3:  27%|██▋       | 4/15 [02:25<05:50, 31.86s/it]ELBO: -754947.0:  27%|██▋       | 4/15 [02:52<05:50, 31.86s/it]ELBO: -754947.0:  33%|███▎      | 5/15 [02:52<04:58, 29.89s/it]ELBO: -754893.6:  33%|███▎      | 5/15 [03:18<04:58, 29.89s/it]ELBO: -754893.6:  40%|████      | 6/15 [03:18<04:18, 28.73s/it]ELBO: -755153.5:  40%|████      | 6/15 [03:44<04:18, 28.73s/it]ELBO: -755153.5:  47%|████▋     | 7/15 [03:44<03:44, 28.00s/it]ELBO: -755322.9:  47%|████▋     | 7/15 [04:11<03:44, 28.00s/it]ELBO: -755322.9:  53%|█████▎    | 8/15 [04:11<03:12, 27.53s/it]ELBO: -755117.3:  53%|█████▎    | 8/15 [04:37<03:12, 27.53s/it]ELBO: -755117.3:  60%|██████    | 9/15 [04:37<02:42, 27.16s/it]ELBO: -754712.2:  60%|██████    | 9/15 [05:04<02:42, 27.16s/it]ELBO: -754712.2:  67%|██████▋   | 10/15 [05:04<02:14, 26.98s/it]ELBO: -754121.2:  67%|██████▋   | 10/15 [05:30<02:14, 26.98s/it]ELBO: -754121.2:  73%|███████▎  | 11/15 [05:30<01:47, 26.83s/it]ELBO: -754941.5:  73%|███████▎  | 11/15 [05:57<01:47, 26.83s/it]ELBO: -754941.5:  80%|████████  | 12/15 [05:57<01:20, 26.74s/it]ELBO: -754407.2:  80%|████████  | 12/15 [06:23<01:20, 26.74s/it]ELBO: -754407.2:  87%|████████▋ | 13/15 [06:23<00:53, 26.68s/it]ELBO: -755157.0:  87%|████████▋ | 13/15 [06:50<00:53, 26.68s/it]ELBO: -755157.0:  93%|█████████▎| 14/15 [06:50<00:26, 26.64s/it]ELBO: -754941.2:  93%|█████████▎| 14/15 [07:17<00:26, 26.64s/it]ELBO: -754941.2: 100%|██████████| 15/15 [07:17<00:00, 26.62s/it]ELBO: -754941.2: 100%|██████████| 15/15 [07:17<00:00, 29.14s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -10487611.8:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -774845.3:   0%|          | 0/15 [01:11<?, ?it/s]  ELBO: -774845.3:   7%|▋         | 1/15 [01:11<16:36, 71.20s/it]ELBO: -774835.0:   7%|▋         | 1/15 [01:37<16:36, 71.20s/it]ELBO: -774835.0:  13%|█▎        | 2/15 [01:37<09:42, 44.82s/it]ELBO: -775015.9:  13%|█▎        | 2/15 [02:03<09:42, 44.82s/it]ELBO: -775015.9:  20%|██        | 3/15 [02:03<07:16, 36.41s/it]ELBO: -775213.7:  20%|██        | 3/15 [02:30<07:16, 36.41s/it]ELBO: -775213.7:  27%|██▋       | 4/15 [02:30<05:57, 32.50s/it]ELBO: -773441.1:  27%|██▋       | 4/15 [02:56<05:57, 32.50s/it]ELBO: -773441.1:  33%|███▎      | 5/15 [02:56<05:03, 30.32s/it]ELBO: -773742.1:  33%|███▎      | 5/15 [03:23<05:03, 30.32s/it]ELBO: -773742.1:  40%|████      | 6/15 [03:23<04:20, 28.98s/it]ELBO: -773657.2:  40%|████      | 6/15 [03:49<04:20, 28.98s/it]ELBO: -773657.2:  47%|████▋     | 7/15 [03:49<03:45, 28.18s/it]ELBO: -774141.7:  47%|████▋     | 7/15 [04:16<03:45, 28.18s/it]ELBO: -774141.7:  53%|█████▎    | 8/15 [04:16<03:13, 27.59s/it]ELBO: -775267.4:  53%|█████▎    | 8/15 [04:42<03:13, 27.59s/it]ELBO: -775267.4:  60%|██████    | 9/15 [04:42<02:43, 27.27s/it]ELBO: -774022.1:  60%|██████    | 9/15 [05:09<02:43, 27.27s/it]ELBO: -774022.1:  67%|██████▋   | 10/15 [05:09<02:15, 27.03s/it]ELBO: -774001.9:  67%|██████▋   | 10/15 [05:35<02:15, 27.03s/it]ELBO: -774001.9:  73%|███████▎  | 11/15 [05:35<01:47, 26.85s/it]ELBO: -774995.2:  73%|███████▎  | 11/15 [06:02<01:47, 26.85s/it]ELBO: -774995.2:  80%|████████  | 12/15 [06:02<01:20, 26.70s/it]ELBO: -774351.0:  80%|████████  | 12/15 [06:28<01:20, 26.70s/it]ELBO: -774351.0:  87%|████████▋ | 13/15 [06:28<00:53, 26.66s/it]ELBO: -774495.5:  87%|████████▋ | 13/15 [06:55<00:53, 26.66s/it]ELBO: -774495.5:  93%|█████████▎| 14/15 [06:55<00:26, 26.61s/it]ELBO: -775099.2:  93%|█████████▎| 14/15 [07:21<00:26, 26.61s/it]ELBO: -775099.2: 100%|██████████| 15/15 [07:21<00:00, 26.54s/it]ELBO: -775099.2: 100%|██████████| 15/15 [07:21<00:00, 29.43s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -10194772.3:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -824245.1:   0%|          | 0/15 [01:09<?, ?it/s]  ELBO: -824245.1:   7%|▋         | 1/15 [01:09<16:19, 69.96s/it]ELBO: -824115.9:   7%|▋         | 1/15 [01:36<16:19, 69.96s/it]ELBO: -824115.9:  13%|█▎        | 2/15 [01:36<09:36, 44.34s/it]ELBO: -824193.1:  13%|█▎        | 2/15 [02:02<09:36, 44.34s/it]ELBO: -824193.1:  20%|██        | 3/15 [02:02<07:13, 36.16s/it]ELBO: -824124.4:  20%|██        | 3/15 [02:29<07:13, 36.16s/it]ELBO: -824124.4:  27%|██▋       | 4/15 [02:29<05:55, 32.35s/it]ELBO: -824020.5:  27%|██▋       | 4/15 [02:55<05:55, 32.35s/it]ELBO: -824020.5:  33%|███▎      | 5/15 [02:55<05:02, 30.27s/it]ELBO: -823867.5:  33%|███▎      | 5/15 [03:22<05:02, 30.27s/it]ELBO: -823867.5:  40%|████      | 6/15 [03:22<04:20, 28.94s/it]ELBO: -824054.9:  40%|████      | 6/15 [03:48<04:20, 28.94s/it]ELBO: -824054.9:  47%|████▋     | 7/15 [03:48<03:45, 28.14s/it]ELBO: -824117.1:  47%|████▋     | 7/15 [04:15<03:45, 28.14s/it]ELBO: -824117.1:  53%|█████▎    | 8/15 [04:15<03:13, 27.58s/it]ELBO: -823675.2:  53%|█████▎    | 8/15 [04:41<03:13, 27.58s/it]ELBO: -823675.2:  60%|██████    | 9/15 [04:41<02:43, 27.24s/it]ELBO: -824119.7:  60%|██████    | 9/15 [05:08<02:43, 27.24s/it]ELBO: -824119.7:  67%|██████▋   | 10/15 [05:08<02:15, 27.00s/it]ELBO: -824533.4:  67%|██████▋   | 10/15 [05:34<02:15, 27.00s/it]ELBO: -824533.4:  73%|███████▎  | 11/15 [05:34<01:47, 26.80s/it]ELBO: -823772.8:  73%|███████▎  | 11/15 [06:00<01:47, 26.80s/it]ELBO: -823772.8:  80%|████████  | 12/15 [06:00<01:20, 26.70s/it]ELBO: -824301.9:  80%|████████  | 12/15 [06:27<01:20, 26.70s/it]ELBO: -824301.9:  87%|████████▋ | 13/15 [06:27<00:53, 26.64s/it]ELBO: -823654.7:  87%|████████▋ | 13/15 [06:53<00:53, 26.64s/it]ELBO: -823654.7:  93%|█████████▎| 14/15 [06:53<00:26, 26.62s/it]ELBO: -824290.8:  93%|█████████▎| 14/15 [07:20<00:26, 26.62s/it]ELBO: -824290.8: 100%|██████████| 15/15 [07:20<00:00, 26.57s/it]ELBO: -824290.8: 100%|██████████| 15/15 [07:20<00:00, 29.36s/it]
