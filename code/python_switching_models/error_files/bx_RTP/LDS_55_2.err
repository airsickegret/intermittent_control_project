Processed spikes from trial 100.
Processed spikes from trial 200.
Processed spikes from trial 300.
  0%|          | 0/1 [00:00<?, ?it/s]ARHMM Initialization restarts:   0%|          | 0/1 [00:00<?, ?it/s]Initializing with an ARHMM using 25 steps of EM.

  0%|          | 0/25 [00:00<?, ?it/s][A
LP: -4157909.2:   0%|          | 0/25 [00:00<?, ?it/s][A
LP: -4157909.2:   0%|          | 0/25 [00:01<?, ?it/s][A
LP: -4157909.2:   4%|▍         | 1/25 [00:01<00:27,  1.15s/it][A
LP: -4157909.2:   4%|▍         | 1/25 [00:02<00:27,  1.15s/it][A
LP: -4157909.2:   8%|▊         | 2/25 [00:02<00:27,  1.19s/it][A
LP: -4157909.2:   8%|▊         | 2/25 [00:03<00:27,  1.19s/it][A
LP: -4157909.2:  12%|█▏        | 3/25 [00:03<00:26,  1.19s/it][A
LP: -4157909.2:  12%|█▏        | 3/25 [00:04<00:26,  1.19s/it][A
LP: -4157909.2:  16%|█▌        | 4/25 [00:04<00:25,  1.21s/it][A
LP: -4157909.2:  16%|█▌        | 4/25 [00:05<00:25,  1.21s/it][A
LP: -4157909.2:  20%|██        | 5/25 [00:05<00:23,  1.19s/it][A
LP: -4157909.2:  20%|██        | 5/25 [00:07<00:23,  1.19s/it][A
LP: -4157909.2:  24%|██▍       | 6/25 [00:07<00:22,  1.17s/it][A
LP: -4157909.2:  24%|██▍       | 6/25 [00:08<00:22,  1.17s/it][A
LP: -4157909.2:  28%|██▊       | 7/25 [00:08<00:20,  1.16s/it][A
LP: -4157909.2:  28%|██▊       | 7/25 [00:09<00:20,  1.16s/it][A
LP: -4157909.2:  32%|███▏      | 8/25 [00:09<00:19,  1.15s/it][A
LP: -4157909.2:  32%|███▏      | 8/25 [00:10<00:19,  1.15s/it][A
LP: -4157909.2:  36%|███▌      | 9/25 [00:10<00:18,  1.16s/it][A
LP: -4157909.2:  36%|███▌      | 9/25 [00:11<00:18,  1.16s/it][A
LP: -4157909.2:  40%|████      | 10/25 [00:11<00:17,  1.20s/it][A
LP: -4157909.2:  40%|████      | 10/25 [00:12<00:17,  1.20s/it][A
LP: -4157909.2:  44%|████▍     | 11/25 [00:12<00:16,  1.19s/it][A
LP: -4157909.2:  44%|████▍     | 11/25 [00:14<00:16,  1.19s/it][A
LP: -4157909.2:  48%|████▊     | 12/25 [00:14<00:15,  1.17s/it][A
LP: -4157909.2:  48%|████▊     | 12/25 [00:15<00:15,  1.17s/it][A
LP: -4157909.2:  52%|█████▏    | 13/25 [00:15<00:13,  1.15s/it][A
LP: -4157909.2:  52%|█████▏    | 13/25 [00:16<00:13,  1.15s/it][A
LP: -4157909.2:  56%|█████▌    | 14/25 [00:16<00:12,  1.14s/it][A
LP: -4157909.2:  56%|█████▌    | 14/25 [00:17<00:12,  1.14s/it][A
LP: -4157909.2:  60%|██████    | 15/25 [00:17<00:12,  1.24s/it][A
LP: -4157909.2:  60%|██████    | 15/25 [00:18<00:12,  1.24s/it][A
LP: -4157909.2:  64%|██████▍   | 16/25 [00:18<00:10,  1.20s/it][A
LP: -4157909.2:  64%|██████▍   | 16/25 [00:20<00:10,  1.20s/it][A
LP: -4157909.2:  68%|██████▊   | 17/25 [00:20<00:09,  1.18s/it][A
LP: -4157909.2:  68%|██████▊   | 17/25 [00:21<00:09,  1.18s/it][A
LP: -4157909.2:  72%|███████▏  | 18/25 [00:21<00:08,  1.18s/it][A
LP: -4157909.2:  72%|███████▏  | 18/25 [00:22<00:08,  1.18s/it][A
LP: -4157909.2:  76%|███████▌  | 19/25 [00:22<00:07,  1.17s/it][A
LP: -4157909.2:  76%|███████▌  | 19/25 [00:23<00:07,  1.17s/it][A
LP: -4157909.2:  80%|████████  | 20/25 [00:23<00:05,  1.18s/it][A
LP: -4157909.2:  80%|████████  | 20/25 [00:24<00:05,  1.18s/it][A
LP: -4157909.2:  84%|████████▍ | 21/25 [00:24<00:04,  1.17s/it][A
LP: -4157909.2:  84%|████████▍ | 21/25 [00:25<00:04,  1.17s/it][A
LP: -4157909.2:  88%|████████▊ | 22/25 [00:25<00:03,  1.17s/it][A
LP: -4157909.2:  88%|████████▊ | 22/25 [00:27<00:03,  1.17s/it][A
LP: -4157909.2:  92%|█████████▏| 23/25 [00:27<00:02,  1.17s/it][A
LP: -4157909.2:  92%|█████████▏| 23/25 [00:28<00:02,  1.17s/it][A
LP: -4157909.2:  96%|█████████▌| 24/25 [00:28<00:01,  1.16s/it][A
LP: -4157909.2:  96%|█████████▌| 24/25 [00:29<00:01,  1.16s/it][A
LP: -4157909.2: 100%|██████████| 25/25 [00:29<00:00,  1.18s/it][ALP: -4157909.2: 100%|██████████| 25/25 [00:29<00:00,  1.18s/it]
ARHMM Initialization restarts: 100%|██████████| 1/1 [00:30<00:00, 30.88s/it]ARHMM Initialization restarts: 100%|██████████| 1/1 [00:30<00:00, 30.88s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -9616117.9:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -4639424.4:   0%|          | 0/15 [04:41<?, ?it/s]ELBO: -4639424.4:   7%|▋         | 1/15 [04:41<1:05:39, 281.36s/it]ELBO: -4583958.4:   7%|▋         | 1/15 [07:57<1:05:39, 281.36s/it]ELBO: -4583958.4:  13%|█▎        | 2/15 [07:57<50:02, 230.96s/it]  ELBO: -4555748.3:  13%|█▎        | 2/15 [11:13<50:02, 230.96s/it]ELBO: -4555748.3:  20%|██        | 3/15 [11:13<43:04, 215.37s/it]ELBO: -4540171.9:  20%|██        | 3/15 [14:30<43:04, 215.37s/it]ELBO: -4540171.9:  27%|██▋       | 4/15 [14:30<38:08, 208.02s/it]ELBO: -4528435.9:  27%|██▋       | 4/15 [17:47<38:08, 208.02s/it]ELBO: -4528435.9:  33%|███▎      | 5/15 [17:47<33:58, 203.83s/it]ELBO: -4519642.1:  33%|███▎      | 5/15 [21:03<33:58, 203.83s/it]ELBO: -4519642.1:  40%|████      | 6/15 [21:03<30:12, 201.43s/it]ELBO: -4510825.8:  40%|████      | 6/15 [24:19<30:12, 201.43s/it]ELBO: -4510825.8:  47%|████▋     | 7/15 [24:19<26:36, 199.58s/it]ELBO: -4506493.4:  47%|████▋     | 7/15 [27:33<26:36, 199.58s/it]ELBO: -4506493.4:  53%|█████▎    | 8/15 [27:33<23:03, 197.68s/it]ELBO: -4504180.1:  53%|█████▎    | 8/15 [30:46<23:03, 197.68s/it]ELBO: -4504180.1:  60%|██████    | 9/15 [30:46<19:37, 196.31s/it]ELBO: -4499579.2:  60%|██████    | 9/15 [33:59<19:37, 196.31s/it]ELBO: -4499579.2:  67%|██████▋   | 10/15 [33:59<16:16, 195.28s/it]ELBO: -4499070.9:  67%|██████▋   | 10/15 [37:12<16:16, 195.28s/it]ELBO: -4499070.9:  73%|███████▎  | 11/15 [37:12<12:58, 194.55s/it]ELBO: -4495026.6:  73%|███████▎  | 11/15 [40:22<12:58, 194.55s/it]ELBO: -4495026.6:  80%|████████  | 12/15 [40:22<09:40, 193.36s/it]ELBO: -4493526.9:  80%|████████  | 12/15 [43:33<09:40, 193.36s/it]ELBO: -4493526.9:  87%|████████▋ | 13/15 [43:33<06:25, 192.56s/it]ELBO: -4491589.7:  87%|████████▋ | 13/15 [46:44<06:25, 192.56s/it]ELBO: -4491589.7:  93%|█████████▎| 14/15 [46:44<03:11, 191.97s/it]ELBO: -4489461.4:  93%|█████████▎| 14/15 [49:55<03:11, 191.97s/it]ELBO: -4489461.4: 100%|██████████| 15/15 [49:55<00:00, 191.60s/it]ELBO: -4489461.4: 100%|██████████| 15/15 [49:55<00:00, 199.67s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -9028779.4:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -760657.5:   0%|          | 0/15 [01:11<?, ?it/s] ELBO: -760657.5:   7%|▋         | 1/15 [01:11<16:42, 71.57s/it]ELBO: -761296.3:   7%|▋         | 1/15 [01:38<16:42, 71.57s/it]ELBO: -761296.3:  13%|█▎        | 2/15 [01:38<09:51, 45.46s/it]ELBO: -761366.4:  13%|█▎        | 2/15 [02:05<09:51, 45.46s/it]ELBO: -761366.4:  20%|██        | 3/15 [02:05<07:25, 37.12s/it]ELBO: -760851.4:  20%|██        | 3/15 [02:33<07:25, 37.12s/it]ELBO: -760851.4:  27%|██▋       | 4/15 [02:33<06:05, 33.22s/it]ELBO: -761055.9:  27%|██▋       | 4/15 [03:00<06:05, 33.22s/it]ELBO: -761055.9:  33%|███▎      | 5/15 [03:00<05:10, 31.03s/it]ELBO: -761711.6:  33%|███▎      | 5/15 [03:27<05:10, 31.03s/it]ELBO: -761711.6:  40%|████      | 6/15 [03:27<04:27, 29.74s/it]ELBO: -760757.6:  40%|████      | 6/15 [03:54<04:27, 29.74s/it]ELBO: -760757.6:  47%|████▋     | 7/15 [03:54<03:51, 28.93s/it]ELBO: -760938.0:  47%|████▋     | 7/15 [04:22<03:51, 28.93s/it]ELBO: -760938.0:  53%|█████▎    | 8/15 [04:22<03:19, 28.43s/it]ELBO: -760530.5:  53%|█████▎    | 8/15 [04:49<03:19, 28.43s/it]ELBO: -760530.5:  60%|██████    | 9/15 [04:49<02:48, 28.08s/it]ELBO: -760707.8:  60%|██████    | 9/15 [05:16<02:48, 28.08s/it]ELBO: -760707.8:  67%|██████▋   | 10/15 [05:16<02:19, 27.86s/it]ELBO: -760684.7:  67%|██████▋   | 10/15 [05:44<02:19, 27.86s/it]ELBO: -760684.7:  73%|███████▎  | 11/15 [05:44<01:50, 27.66s/it]ELBO: -760897.1:  73%|███████▎  | 11/15 [06:11<01:50, 27.66s/it]ELBO: -760897.1:  80%|████████  | 12/15 [06:11<01:22, 27.53s/it]ELBO: -760398.6:  80%|████████  | 12/15 [06:38<01:22, 27.53s/it]ELBO: -760398.6:  87%|████████▋ | 13/15 [06:38<00:54, 27.45s/it]ELBO: -761260.9:  87%|████████▋ | 13/15 [07:05<00:54, 27.45s/it]ELBO: -761260.9:  93%|█████████▎| 14/15 [07:05<00:27, 27.37s/it]ELBO: -760202.3:  93%|█████████▎| 14/15 [07:32<00:27, 27.37s/it]ELBO: -760202.3: 100%|██████████| 15/15 [07:32<00:00, 27.31s/it]ELBO: -760202.3: 100%|██████████| 15/15 [07:32<00:00, 30.19s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -9591692.7:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -784325.8:   0%|          | 0/15 [01:03<?, ?it/s] ELBO: -784325.8:   7%|▋         | 1/15 [01:03<14:44, 63.19s/it]ELBO: -785379.9:   7%|▋         | 1/15 [01:30<14:44, 63.19s/it]ELBO: -785379.9:  13%|█▎        | 2/15 [01:30<09:07, 42.09s/it]ELBO: -786057.0:  13%|█▎        | 2/15 [01:57<09:07, 42.09s/it]ELBO: -786057.0:  20%|██        | 3/15 [01:57<07:03, 35.28s/it]ELBO: -785183.1:  20%|██        | 3/15 [02:25<07:03, 35.28s/it]ELBO: -785183.1:  27%|██▋       | 4/15 [02:25<05:54, 32.19s/it]ELBO: -784649.1:  27%|██▋       | 4/15 [02:52<05:54, 32.19s/it]ELBO: -784649.1:  33%|███▎      | 5/15 [02:52<05:04, 30.42s/it]ELBO: -785841.1:  33%|███▎      | 5/15 [03:19<05:04, 30.42s/it]ELBO: -785841.1:  40%|████      | 6/15 [03:19<04:23, 29.31s/it]ELBO: -785670.7:  40%|████      | 6/15 [03:46<04:23, 29.31s/it]ELBO: -785670.7:  47%|████▋     | 7/15 [03:46<03:49, 28.69s/it]ELBO: -784675.7:  47%|████▋     | 7/15 [04:14<03:49, 28.69s/it]ELBO: -784675.7:  53%|█████▎    | 8/15 [04:14<03:17, 28.26s/it]ELBO: -785987.6:  53%|█████▎    | 8/15 [04:41<03:17, 28.26s/it]ELBO: -785987.6:  60%|██████    | 9/15 [04:41<02:47, 27.93s/it]ELBO: -785760.5:  60%|██████    | 9/15 [05:08<02:47, 27.93s/it]ELBO: -785760.5:  67%|██████▋   | 10/15 [05:08<02:18, 27.78s/it]ELBO: -785304.3:  67%|██████▋   | 10/15 [05:36<02:18, 27.78s/it]ELBO: -785304.3:  73%|███████▎  | 11/15 [05:36<01:50, 27.61s/it]ELBO: -786266.8:  73%|███████▎  | 11/15 [06:03<01:50, 27.61s/it]ELBO: -786266.8:  80%|████████  | 12/15 [06:03<01:22, 27.49s/it]ELBO: -785297.7:  80%|████████  | 12/15 [06:30<01:22, 27.49s/it]ELBO: -785297.7:  87%|████████▋ | 13/15 [06:30<00:54, 27.46s/it]ELBO: -785759.7:  87%|████████▋ | 13/15 [06:58<00:54, 27.46s/it]ELBO: -785759.7:  93%|█████████▎| 14/15 [06:58<00:27, 27.44s/it]ELBO: -785250.5:  93%|█████████▎| 14/15 [07:25<00:27, 27.44s/it]ELBO: -785250.5: 100%|██████████| 15/15 [07:25<00:00, 27.41s/it]ELBO: -785250.5: 100%|██████████| 15/15 [07:25<00:00, 29.70s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -10951144.5:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -803752.7:   0%|          | 0/15 [01:11<?, ?it/s]  ELBO: -803752.7:   7%|▋         | 1/15 [01:11<16:46, 71.89s/it]ELBO: -803348.9:   7%|▋         | 1/15 [01:39<16:46, 71.89s/it]ELBO: -803348.9:  13%|█▎        | 2/15 [01:39<09:52, 45.57s/it]ELBO: -802582.3:  13%|█▎        | 2/15 [02:06<09:52, 45.57s/it]ELBO: -802582.3:  20%|██        | 3/15 [02:06<07:26, 37.20s/it]ELBO: -801905.8:  20%|██        | 3/15 [02:33<07:26, 37.20s/it]ELBO: -801905.8:  27%|██▋       | 4/15 [02:33<06:06, 33.28s/it]ELBO: -803647.0:  27%|██▋       | 4/15 [03:00<06:06, 33.28s/it]ELBO: -803647.0:  33%|███▎      | 5/15 [03:00<05:10, 31.08s/it]ELBO: -803683.3:  33%|███▎      | 5/15 [03:27<05:10, 31.08s/it]ELBO: -803683.3:  40%|████      | 6/15 [03:27<04:27, 29.74s/it]ELBO: -803809.7:  40%|████      | 6/15 [03:55<04:27, 29.74s/it]ELBO: -803809.7:  47%|████▋     | 7/15 [03:55<03:51, 28.95s/it]ELBO: -803528.6:  47%|████▋     | 7/15 [04:22<03:51, 28.95s/it]ELBO: -803528.6:  53%|█████▎    | 8/15 [04:22<03:18, 28.33s/it]ELBO: -803354.9:  53%|█████▎    | 8/15 [04:49<03:18, 28.33s/it]ELBO: -803354.9:  60%|██████    | 9/15 [04:49<02:47, 27.97s/it]ELBO: -803297.6:  60%|██████    | 9/15 [05:16<02:47, 27.97s/it]ELBO: -803297.6:  67%|██████▋   | 10/15 [05:16<02:18, 27.68s/it]ELBO: -803076.6:  67%|██████▋   | 10/15 [05:43<02:18, 27.68s/it]ELBO: -803076.6:  73%|███████▎  | 11/15 [05:43<01:50, 27.59s/it]ELBO: -802113.3:  73%|███████▎  | 11/15 [06:10<01:50, 27.59s/it]ELBO: -802113.3:  80%|████████  | 12/15 [06:10<01:22, 27.45s/it]ELBO: -802931.7:  80%|████████  | 12/15 [06:38<01:22, 27.45s/it]ELBO: -802931.7:  87%|████████▋ | 13/15 [06:38<00:54, 27.41s/it]ELBO: -803332.1:  87%|████████▋ | 13/15 [07:05<00:54, 27.41s/it]ELBO: -803332.1:  93%|█████████▎| 14/15 [07:05<00:27, 27.34s/it]ELBO: -801798.2:  93%|█████████▎| 14/15 [07:32<00:27, 27.34s/it]ELBO: -801798.2: 100%|██████████| 15/15 [07:32<00:00, 27.34s/it]ELBO: -801798.2: 100%|██████████| 15/15 [07:32<00:00, 30.19s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -11210644.3:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -846091.7:   0%|          | 0/15 [01:12<?, ?it/s]  ELBO: -846091.7:   7%|▋         | 1/15 [01:12<16:55, 72.55s/it]ELBO: -845733.4:   7%|▋         | 1/15 [01:39<16:55, 72.55s/it]ELBO: -845733.4:  13%|█▎        | 2/15 [01:39<09:55, 45.78s/it]ELBO: -846892.5:  13%|█▎        | 2/15 [02:06<09:55, 45.78s/it]ELBO: -846892.5:  20%|██        | 3/15 [02:06<07:28, 37.34s/it]ELBO: -846903.4:  20%|██        | 3/15 [02:34<07:28, 37.34s/it]ELBO: -846903.4:  27%|██▋       | 4/15 [02:34<06:06, 33.35s/it]ELBO: -846173.7:  27%|██▋       | 4/15 [03:01<06:06, 33.35s/it]ELBO: -846173.7:  33%|███▎      | 5/15 [03:01<05:12, 31.20s/it]ELBO: -845947.9:  33%|███▎      | 5/15 [03:28<05:12, 31.20s/it]ELBO: -845947.9:  40%|████      | 6/15 [03:28<04:28, 29.84s/it]ELBO: -847529.1:  40%|████      | 6/15 [03:56<04:28, 29.84s/it]ELBO: -847529.1:  47%|████▋     | 7/15 [03:56<03:52, 29.01s/it]ELBO: -847027.7:  47%|████▋     | 7/15 [04:23<03:52, 29.01s/it]ELBO: -847027.7:  53%|█████▎    | 8/15 [04:23<03:18, 28.41s/it]ELBO: -846503.9:  53%|█████▎    | 8/15 [04:50<03:18, 28.41s/it]ELBO: -846503.9:  60%|██████    | 9/15 [04:50<02:48, 28.06s/it]ELBO: -846210.4:  60%|██████    | 9/15 [05:17<02:48, 28.06s/it]ELBO: -846210.4:  67%|██████▋   | 10/15 [05:17<02:18, 27.80s/it]ELBO: -846015.9:  67%|██████▋   | 10/15 [05:44<02:18, 27.80s/it]ELBO: -846015.9:  73%|███████▎  | 11/15 [05:44<01:50, 27.58s/it]ELBO: -846104.1:  73%|███████▎  | 11/15 [06:11<01:50, 27.58s/it]ELBO: -846104.1:  80%|████████  | 12/15 [06:11<01:22, 27.48s/it]ELBO: -846429.4:  80%|████████  | 12/15 [06:39<01:22, 27.48s/it]ELBO: -846429.4:  87%|████████▋ | 13/15 [06:39<00:54, 27.39s/it]ELBO: -846460.0:  87%|████████▋ | 13/15 [07:06<00:54, 27.39s/it]ELBO: -846460.0:  93%|█████████▎| 14/15 [07:06<00:27, 27.30s/it]ELBO: -847249.0:  93%|█████████▎| 14/15 [07:33<00:27, 27.30s/it]ELBO: -847249.0: 100%|██████████| 15/15 [07:33<00:00, 27.26s/it]ELBO: -847249.0: 100%|██████████| 15/15 [07:33<00:00, 30.23s/it]
