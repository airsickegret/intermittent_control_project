Processed spikes from trial 100.
Processed spikes from trial 200.
Processed spikes from trial 300.
  0%|          | 0/1 [00:00<?, ?it/s]ARHMM Initialization restarts:   0%|          | 0/1 [00:00<?, ?it/s]Initializing with an ARHMM using 25 steps of EM.

  0%|          | 0/25 [00:00<?, ?it/s][A
LP: -3666898.0:   0%|          | 0/25 [00:00<?, ?it/s][A
LP: -3666898.0:   0%|          | 0/25 [00:00<?, ?it/s][A
LP: -3666898.0:   4%|▍         | 1/25 [00:00<00:23,  1.02it/s][A
LP: -3666898.0:   4%|▍         | 1/25 [00:01<00:23,  1.02it/s][A
LP: -3666898.0:   8%|▊         | 2/25 [00:01<00:22,  1.04it/s][A
LP: -3666898.0:   8%|▊         | 2/25 [00:02<00:22,  1.04it/s][A
LP: -3666898.0:  12%|█▏        | 3/25 [00:02<00:21,  1.04it/s][A
LP: -3666898.0:  12%|█▏        | 3/25 [00:03<00:21,  1.04it/s][A
LP: -3666898.0:  16%|█▌        | 4/25 [00:03<00:20,  1.05it/s][A
LP: -3666898.0:  16%|█▌        | 4/25 [00:04<00:20,  1.05it/s][A
LP: -3666898.0:  20%|██        | 5/25 [00:04<00:18,  1.06it/s][A
LP: -3666898.0:  20%|██        | 5/25 [00:05<00:18,  1.06it/s][A
LP: -3666898.0:  24%|██▍       | 6/25 [00:05<00:17,  1.07it/s][A
LP: -3666898.0:  24%|██▍       | 6/25 [00:06<00:17,  1.07it/s][A
LP: -3666898.0:  28%|██▊       | 7/25 [00:06<00:16,  1.07it/s][A
LP: -3666898.0:  28%|██▊       | 7/25 [00:07<00:16,  1.07it/s][A
LP: -3666898.0:  32%|███▏      | 8/25 [00:07<00:15,  1.07it/s][A
LP: -3666898.0:  32%|███▏      | 8/25 [00:08<00:15,  1.07it/s][A
LP: -3666898.0:  36%|███▌      | 9/25 [00:08<00:15,  1.07it/s][A
LP: -3666898.0:  36%|███▌      | 9/25 [00:09<00:15,  1.07it/s][A
LP: -3666898.0:  40%|████      | 10/25 [00:09<00:14,  1.05it/s][A
LP: -3666898.0:  40%|████      | 10/25 [00:10<00:14,  1.05it/s][A
LP: -3666898.0:  44%|████▍     | 11/25 [00:10<00:13,  1.05it/s][A
LP: -3666898.0:  44%|████▍     | 11/25 [00:11<00:13,  1.05it/s][A
LP: -3666898.0:  48%|████▊     | 12/25 [00:11<00:12,  1.04it/s][A
LP: -3666898.0:  48%|████▊     | 12/25 [00:12<00:12,  1.04it/s][A
LP: -3666898.0:  52%|█████▏    | 13/25 [00:12<00:11,  1.05it/s][A
LP: -3666898.0:  52%|█████▏    | 13/25 [00:13<00:11,  1.05it/s][A
LP: -3666898.0:  56%|█████▌    | 14/25 [00:13<00:10,  1.06it/s][A
LP: -3666898.0:  56%|█████▌    | 14/25 [00:14<00:10,  1.06it/s][A
LP: -3666898.0:  60%|██████    | 15/25 [00:14<00:09,  1.06it/s][A
LP: -3666898.0:  60%|██████    | 15/25 [00:15<00:09,  1.06it/s][A
LP: -3666898.0:  64%|██████▍   | 16/25 [00:15<00:08,  1.07it/s][A
LP: -3666898.0:  64%|██████▍   | 16/25 [00:16<00:08,  1.07it/s][A
LP: -3666898.0:  68%|██████▊   | 17/25 [00:16<00:07,  1.07it/s][A
LP: -3666898.0:  68%|██████▊   | 17/25 [00:16<00:07,  1.07it/s][A
LP: -3666898.0:  72%|███████▏  | 18/25 [00:16<00:06,  1.07it/s][A
LP: -3666898.0:  72%|███████▏  | 18/25 [00:17<00:06,  1.07it/s][A
LP: -3666898.0:  76%|███████▌  | 19/25 [00:17<00:05,  1.07it/s][A
LP: -3666898.0:  76%|███████▌  | 19/25 [00:18<00:05,  1.07it/s][A
LP: -3666898.0:  80%|████████  | 20/25 [00:18<00:04,  1.06it/s][A
LP: -3666898.0:  80%|████████  | 20/25 [00:19<00:04,  1.06it/s][A
LP: -3666898.0:  84%|████████▍ | 21/25 [00:19<00:03,  1.06it/s][A
LP: -3666898.0:  84%|████████▍ | 21/25 [00:20<00:03,  1.06it/s][A
LP: -3666898.0:  88%|████████▊ | 22/25 [00:20<00:02,  1.06it/s][A
LP: -3666898.0:  88%|████████▊ | 22/25 [00:21<00:02,  1.06it/s][A
LP: -3666898.0:  92%|█████████▏| 23/25 [00:21<00:01,  1.07it/s][A
LP: -3666898.0:  92%|█████████▏| 23/25 [00:22<00:01,  1.07it/s][A
LP: -3666898.0:  96%|█████████▌| 24/25 [00:22<00:00,  1.07it/s][A
LP: -3666898.0:  96%|█████████▌| 24/25 [00:23<00:00,  1.07it/s][A
LP: -3666898.0: 100%|██████████| 25/25 [00:23<00:00,  1.07it/s][ALP: -3666898.0: 100%|██████████| 25/25 [00:23<00:00,  1.06it/s]
ARHMM Initialization restarts: 100%|██████████| 1/1 [00:24<00:00, 24.74s/it]ARHMM Initialization restarts: 100%|██████████| 1/1 [00:24<00:00, 24.74s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -8905326.5:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -4543197.4:   0%|          | 0/15 [03:45<?, ?it/s]ELBO: -4543197.4:   7%|▋         | 1/15 [03:45<52:32, 225.20s/it]ELBO: -4485299.2:   7%|▋         | 1/15 [06:43<52:32, 225.20s/it]ELBO: -4485299.2:  13%|█▎        | 2/15 [06:43<42:46, 197.40s/it]ELBO: -4460748.8:  13%|█▎        | 2/15 [09:19<42:46, 197.40s/it]ELBO: -4460748.8:  20%|██        | 3/15 [09:19<35:46, 178.85s/it]ELBO: -4443375.8:  20%|██        | 3/15 [11:57<35:46, 178.85s/it]ELBO: -4443375.8:  27%|██▋       | 4/15 [11:57<31:15, 170.46s/it]ELBO: -4433822.7:  27%|██▋       | 4/15 [14:35<31:15, 170.46s/it]ELBO: -4433822.7:  33%|███▎      | 5/15 [14:35<27:37, 165.78s/it]ELBO: -4424260.8:  33%|███▎      | 5/15 [17:12<27:37, 165.78s/it]ELBO: -4424260.8:  40%|████      | 6/15 [17:12<24:27, 163.01s/it]ELBO: -4420713.1:  40%|████      | 6/15 [19:47<24:27, 163.01s/it]ELBO: -4420713.1:  47%|████▋     | 7/15 [19:47<21:23, 160.46s/it]ELBO: -4415223.0:  47%|████▋     | 7/15 [22:19<21:23, 160.46s/it]ELBO: -4415223.0:  53%|█████▎    | 8/15 [22:19<18:24, 157.79s/it]ELBO: -4412347.2:  53%|█████▎    | 8/15 [24:52<18:24, 157.79s/it]ELBO: -4412347.2:  60%|██████    | 9/15 [24:52<15:36, 156.09s/it]ELBO: -4409126.4:  60%|██████    | 9/15 [27:24<15:36, 156.09s/it]ELBO: -4409126.4:  67%|██████▋   | 10/15 [27:24<12:54, 154.95s/it]ELBO: -4406164.7:  67%|██████▋   | 10/15 [29:56<12:54, 154.95s/it]ELBO: -4406164.7:  73%|███████▎  | 11/15 [29:56<10:16, 154.11s/it]ELBO: -4401222.5:  73%|███████▎  | 11/15 [32:29<10:16, 154.11s/it]ELBO: -4401222.5:  80%|████████  | 12/15 [32:29<07:40, 153.59s/it]ELBO: -4401943.0:  80%|████████  | 12/15 [35:01<07:40, 153.59s/it]ELBO: -4401943.0:  87%|████████▋ | 13/15 [35:01<05:06, 153.30s/it]ELBO: -4398460.1:  87%|████████▋ | 13/15 [37:34<05:06, 153.30s/it]ELBO: -4398460.1:  93%|█████████▎| 14/15 [37:34<02:33, 153.07s/it]ELBO: -4397436.8:  93%|█████████▎| 14/15 [40:06<02:33, 153.07s/it]ELBO: -4397436.8: 100%|██████████| 15/15 [40:06<00:00, 152.89s/it]ELBO: -4397436.8: 100%|██████████| 15/15 [40:06<00:00, 160.46s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -7540650.1:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -910715.1:   0%|          | 0/15 [00:51<?, ?it/s] ELBO: -910715.1:   7%|▋         | 1/15 [00:51<12:02, 51.62s/it]ELBO: -910493.2:   7%|▋         | 1/15 [01:14<12:02, 51.62s/it]ELBO: -910493.2:  13%|█▎        | 2/15 [01:14<07:34, 34.98s/it]ELBO: -910855.7:  13%|█▎        | 2/15 [01:38<07:34, 34.98s/it]ELBO: -910855.7:  20%|██        | 3/15 [01:38<05:55, 29.66s/it]ELBO: -910226.2:  20%|██        | 3/15 [02:01<05:55, 29.66s/it]ELBO: -910226.2:  27%|██▋       | 4/15 [02:01<04:58, 27.17s/it]ELBO: -911112.9:  27%|██▋       | 4/15 [02:25<04:58, 27.17s/it]ELBO: -911112.9:  33%|███▎      | 5/15 [02:25<04:18, 25.81s/it]ELBO: -910656.0:  33%|███▎      | 5/15 [02:48<04:18, 25.81s/it]ELBO: -910656.0:  40%|████      | 6/15 [02:48<03:44, 24.96s/it]ELBO: -911309.2:  40%|████      | 6/15 [03:11<03:44, 24.96s/it]ELBO: -911309.2:  47%|████▋     | 7/15 [03:11<03:15, 24.48s/it]ELBO: -910110.9:  47%|████▋     | 7/15 [03:35<03:15, 24.48s/it]ELBO: -910110.9:  53%|█████▎    | 8/15 [03:35<02:48, 24.11s/it]ELBO: -911295.6:  53%|█████▎    | 8/15 [03:58<02:48, 24.11s/it]ELBO: -911295.6:  60%|██████    | 9/15 [03:58<02:23, 23.86s/it]ELBO: -910282.6:  60%|██████    | 9/15 [04:21<02:23, 23.86s/it]ELBO: -910282.6:  67%|██████▋   | 10/15 [04:21<01:58, 23.70s/it]ELBO: -909702.4:  67%|██████▋   | 10/15 [04:45<01:58, 23.70s/it]ELBO: -909702.4:  73%|███████▎  | 11/15 [04:45<01:34, 23.62s/it]ELBO: -910250.3:  73%|███████▎  | 11/15 [05:08<01:34, 23.62s/it]ELBO: -910250.3:  80%|████████  | 12/15 [05:08<01:10, 23.54s/it]ELBO: -909382.9:  80%|████████  | 12/15 [05:31<01:10, 23.54s/it]ELBO: -909382.9:  87%|████████▋ | 13/15 [05:31<00:46, 23.48s/it]ELBO: -911906.1:  87%|████████▋ | 13/15 [05:55<00:46, 23.48s/it]ELBO: -911906.1:  93%|█████████▎| 14/15 [05:55<00:23, 23.45s/it]ELBO: -909833.3:  93%|█████████▎| 14/15 [06:18<00:23, 23.45s/it]ELBO: -909833.3: 100%|██████████| 15/15 [06:18<00:00, 23.47s/it]ELBO: -909833.3: 100%|██████████| 15/15 [06:18<00:00, 25.26s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -6756316.2:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -804295.8:   0%|          | 0/15 [00:55<?, ?it/s] ELBO: -804295.8:   7%|▋         | 1/15 [00:55<13:01, 55.83s/it]ELBO: -804438.6:   7%|▋         | 1/15 [01:19<13:01, 55.83s/it]ELBO: -804438.6:  13%|█▎        | 2/15 [01:19<07:58, 36.79s/it]ELBO: -803791.2:  13%|█▎        | 2/15 [01:42<07:58, 36.79s/it]ELBO: -803791.2:  20%|██        | 3/15 [01:42<06:07, 30.66s/it]ELBO: -803501.0:  20%|██        | 3/15 [02:06<06:07, 30.66s/it]ELBO: -803501.0:  27%|██▋       | 4/15 [02:06<05:05, 27.81s/it]ELBO: -804109.9:  27%|██▋       | 4/15 [02:29<05:05, 27.81s/it]ELBO: -804109.9:  33%|███▎      | 5/15 [02:29<04:22, 26.22s/it]ELBO: -804913.4:  33%|███▎      | 5/15 [02:52<04:22, 26.22s/it]ELBO: -804913.4:  40%|████      | 6/15 [02:52<03:47, 25.27s/it]ELBO: -805257.3:  40%|████      | 6/15 [03:16<03:47, 25.27s/it]ELBO: -805257.3:  47%|████▋     | 7/15 [03:16<03:17, 24.68s/it]ELBO: -804288.7:  47%|████▋     | 7/15 [03:39<03:17, 24.68s/it]ELBO: -804288.7:  53%|█████▎    | 8/15 [03:39<02:49, 24.28s/it]ELBO: -804172.8:  53%|█████▎    | 8/15 [04:03<02:49, 24.28s/it]ELBO: -804172.8:  60%|██████    | 9/15 [04:03<02:24, 24.03s/it]ELBO: -805159.0:  60%|██████    | 9/15 [04:26<02:24, 24.03s/it]ELBO: -805159.0:  67%|██████▋   | 10/15 [04:26<01:59, 23.84s/it]ELBO: -803827.5:  67%|██████▋   | 10/15 [04:50<01:59, 23.84s/it]ELBO: -803827.5:  73%|███████▎  | 11/15 [04:50<01:34, 23.70s/it]ELBO: -803924.6:  73%|███████▎  | 11/15 [05:13<01:34, 23.70s/it]ELBO: -803924.6:  80%|████████  | 12/15 [05:13<01:10, 23.57s/it]ELBO: -803559.7:  80%|████████  | 12/15 [05:36<01:10, 23.57s/it]ELBO: -803559.7:  87%|████████▋ | 13/15 [05:36<00:46, 23.48s/it]ELBO: -804224.2:  87%|████████▋ | 13/15 [05:59<00:46, 23.48s/it]ELBO: -804224.2:  93%|█████████▎| 14/15 [05:59<00:23, 23.41s/it]ELBO: -804497.4:  93%|█████████▎| 14/15 [06:22<00:23, 23.41s/it]ELBO: -804497.4: 100%|██████████| 15/15 [06:22<00:00, 23.32s/it]ELBO: -804497.4: 100%|██████████| 15/15 [06:22<00:00, 25.53s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -8573023.3:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -861552.6:   0%|          | 0/15 [01:03<?, ?it/s] ELBO: -861552.6:   7%|▋         | 1/15 [01:03<14:52, 63.78s/it]ELBO: -861474.4:   7%|▋         | 1/15 [01:27<14:52, 63.78s/it]ELBO: -861474.4:  13%|█▎        | 2/15 [01:27<08:40, 40.08s/it]ELBO: -860450.5:  13%|█▎        | 2/15 [01:50<08:40, 40.08s/it]ELBO: -860450.5:  20%|██        | 3/15 [01:50<06:28, 32.37s/it]ELBO: -860709.9:  20%|██        | 3/15 [02:13<06:28, 32.37s/it]ELBO: -860709.9:  27%|██▋       | 4/15 [02:13<05:16, 28.77s/it]ELBO: -861742.4:  27%|██▋       | 4/15 [02:36<05:16, 28.77s/it]ELBO: -861742.4:  33%|███▎      | 5/15 [02:36<04:27, 26.78s/it]ELBO: -861135.8:  33%|███▎      | 5/15 [03:00<04:27, 26.78s/it]ELBO: -861135.8:  40%|████      | 6/15 [03:00<03:50, 25.57s/it]ELBO: -860571.1:  40%|████      | 6/15 [03:23<03:50, 25.57s/it]ELBO: -860571.1:  47%|████▋     | 7/15 [03:23<03:18, 24.79s/it]ELBO: -861656.6:  47%|████▋     | 7/15 [03:46<03:18, 24.79s/it]ELBO: -861656.6:  53%|█████▎    | 8/15 [03:46<02:50, 24.29s/it]ELBO: -861187.8:  53%|█████▎    | 8/15 [04:09<02:50, 24.29s/it]ELBO: -861187.8:  60%|██████    | 9/15 [04:09<02:23, 23.99s/it]ELBO: -861975.7:  60%|██████    | 9/15 [04:33<02:23, 23.99s/it]ELBO: -861975.7:  67%|██████▋   | 10/15 [04:33<01:58, 23.74s/it]ELBO: -861371.8:  67%|██████▋   | 10/15 [04:56<01:58, 23.74s/it]ELBO: -861371.8:  73%|███████▎  | 11/15 [04:56<01:34, 23.56s/it]ELBO: -861650.2:  73%|███████▎  | 11/15 [05:19<01:34, 23.56s/it]ELBO: -861650.2:  80%|████████  | 12/15 [05:19<01:10, 23.46s/it]ELBO: -860766.4:  80%|████████  | 12/15 [05:42<01:10, 23.46s/it]ELBO: -860766.4:  87%|████████▋ | 13/15 [05:42<00:46, 23.40s/it]ELBO: -861051.4:  87%|████████▋ | 13/15 [06:06<00:46, 23.40s/it]ELBO: -861051.4:  93%|█████████▎| 14/15 [06:06<00:23, 23.39s/it]ELBO: -861709.5:  93%|█████████▎| 14/15 [06:29<00:23, 23.39s/it]ELBO: -861709.5: 100%|██████████| 15/15 [06:29<00:00, 23.35s/it]ELBO: -861709.5: 100%|██████████| 15/15 [06:29<00:00, 25.96s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -7712661.4:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -896559.2:   0%|          | 0/15 [01:06<?, ?it/s] ELBO: -896559.2:   7%|▋         | 1/15 [01:06<15:28, 66.34s/it]ELBO: -895779.6:   7%|▋         | 1/15 [01:29<15:28, 66.34s/it]ELBO: -895779.6:  13%|█▎        | 2/15 [01:29<08:54, 41.15s/it]ELBO: -896496.9:  13%|█▎        | 2/15 [01:52<08:54, 41.15s/it]ELBO: -896496.9:  20%|██        | 3/15 [01:52<06:34, 32.91s/it]ELBO: -895659.1:  20%|██        | 3/15 [02:16<06:34, 32.91s/it]ELBO: -895659.1:  27%|██▋       | 4/15 [02:16<05:20, 29.15s/it]ELBO: -895576.3:  27%|██▋       | 4/15 [02:39<05:20, 29.15s/it]ELBO: -895576.3:  33%|███▎      | 5/15 [02:39<04:30, 27.06s/it]ELBO: -896060.0:  33%|███▎      | 5/15 [03:02<04:30, 27.06s/it]ELBO: -896060.0:  40%|████      | 6/15 [03:02<03:51, 25.73s/it]ELBO: -895485.6:  40%|████      | 6/15 [03:26<03:51, 25.73s/it]ELBO: -895485.6:  47%|████▋     | 7/15 [03:26<03:19, 24.92s/it]ELBO: -896173.0:  47%|████▋     | 7/15 [03:49<03:19, 24.92s/it]ELBO: -896173.0:  53%|█████▎    | 8/15 [03:49<02:50, 24.38s/it]ELBO: -895488.6:  53%|█████▎    | 8/15 [04:12<02:50, 24.38s/it]ELBO: -895488.6:  60%|██████    | 9/15 [04:12<02:23, 23.98s/it]ELBO: -896666.2:  60%|██████    | 9/15 [04:35<02:23, 23.98s/it]ELBO: -896666.2:  67%|██████▋   | 10/15 [04:35<01:58, 23.74s/it]ELBO: -895883.9:  67%|██████▋   | 10/15 [04:58<01:58, 23.74s/it]ELBO: -895883.9:  73%|███████▎  | 11/15 [04:58<01:34, 23.56s/it]ELBO: -896271.9:  73%|███████▎  | 11/15 [05:21<01:34, 23.56s/it]ELBO: -896271.9:  80%|████████  | 12/15 [05:21<01:10, 23.45s/it]ELBO: -896095.6:  80%|████████  | 12/15 [05:45<01:10, 23.45s/it]ELBO: -896095.6:  87%|████████▋ | 13/15 [05:45<00:46, 23.38s/it]ELBO: -895519.5:  87%|████████▋ | 13/15 [06:08<00:46, 23.38s/it]ELBO: -895519.5:  93%|█████████▎| 14/15 [06:08<00:23, 23.31s/it]ELBO: -896369.7:  93%|█████████▎| 14/15 [06:31<00:23, 23.31s/it]ELBO: -896369.7: 100%|██████████| 15/15 [06:31<00:00, 23.30s/it]ELBO: -896369.7: 100%|██████████| 15/15 [06:31<00:00, 26.11s/it]
