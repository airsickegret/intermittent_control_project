Processed spikes from trial 100.
Processed spikes from trial 200.
Processed spikes from trial 300.
  0%|          | 0/1 [00:00<?, ?it/s]ARHMM Initialization restarts:   0%|          | 0/1 [00:00<?, ?it/s]Initializing with an ARHMM using 25 steps of EM.

  0%|          | 0/25 [00:00<?, ?it/s][A
LP: -1698706.0:   0%|          | 0/25 [00:00<?, ?it/s][A
LP: -1698706.0:   0%|          | 0/25 [00:00<?, ?it/s][A
LP: -1698706.0:   4%|▍         | 1/25 [00:00<00:09,  2.50it/s][A
LP: -1698706.0:   4%|▍         | 1/25 [00:00<00:09,  2.50it/s][A
LP: -1698706.0:   8%|▊         | 2/25 [00:00<00:09,  2.50it/s][A
LP: -1698706.0:   8%|▊         | 2/25 [00:01<00:09,  2.50it/s][A
LP: -1698706.0:  12%|█▏        | 3/25 [00:01<00:08,  2.50it/s][A
LP: -1698706.0:  12%|█▏        | 3/25 [00:01<00:08,  2.50it/s][A
LP: -1698706.0:  16%|█▌        | 4/25 [00:01<00:08,  2.50it/s][A
LP: -1698706.0:  16%|█▌        | 4/25 [00:02<00:08,  2.50it/s][A
LP: -1698706.0:  20%|██        | 5/25 [00:02<00:08,  2.50it/s][A
LP: -1698706.0:  20%|██        | 5/25 [00:02<00:08,  2.50it/s][A
LP: -1698706.0:  24%|██▍       | 6/25 [00:02<00:07,  2.50it/s][A
LP: -1698706.0:  24%|██▍       | 6/25 [00:02<00:07,  2.50it/s][A
LP: -1698706.0:  28%|██▊       | 7/25 [00:02<00:07,  2.50it/s][A
LP: -1698706.0:  28%|██▊       | 7/25 [00:03<00:07,  2.50it/s][A
LP: -1698706.0:  32%|███▏      | 8/25 [00:03<00:06,  2.50it/s][A
LP: -1698706.0:  32%|███▏      | 8/25 [00:03<00:06,  2.50it/s][A
LP: -1698706.0:  36%|███▌      | 9/25 [00:03<00:06,  2.51it/s][A
LP: -1698706.0:  36%|███▌      | 9/25 [00:03<00:06,  2.51it/s][A
LP: -1698706.0:  40%|████      | 10/25 [00:03<00:05,  2.50it/s][A
LP: -1698706.0:  40%|████      | 10/25 [00:04<00:05,  2.50it/s][A
LP: -1698706.0:  44%|████▍     | 11/25 [00:04<00:05,  2.50it/s][A
LP: -1698706.0:  44%|████▍     | 11/25 [00:04<00:05,  2.50it/s][A
LP: -1698706.0:  48%|████▊     | 12/25 [00:04<00:05,  2.50it/s][A
LP: -1698706.0:  48%|████▊     | 12/25 [00:05<00:05,  2.50it/s][A
LP: -1698706.0:  52%|█████▏    | 13/25 [00:05<00:04,  2.50it/s][A
LP: -1698706.0:  52%|█████▏    | 13/25 [00:05<00:04,  2.50it/s][A
LP: -1698706.0:  56%|█████▌    | 14/25 [00:05<00:04,  2.50it/s][A
LP: -1698706.0:  56%|█████▌    | 14/25 [00:05<00:04,  2.50it/s][A
LP: -1698706.0:  60%|██████    | 15/25 [00:05<00:04,  2.50it/s][A
LP: -1698706.0:  60%|██████    | 15/25 [00:06<00:04,  2.50it/s][A
LP: -1698706.0:  64%|██████▍   | 16/25 [00:06<00:03,  2.50it/s][A
LP: -1698706.0:  64%|██████▍   | 16/25 [00:06<00:03,  2.50it/s][A
LP: -1698706.0:  68%|██████▊   | 17/25 [00:06<00:03,  2.49it/s][A
LP: -1698706.0:  68%|██████▊   | 17/25 [00:07<00:03,  2.49it/s][A
LP: -1698706.0:  72%|███████▏  | 18/25 [00:07<00:02,  2.50it/s][A
LP: -1698706.0:  72%|███████▏  | 18/25 [00:07<00:02,  2.50it/s][A
LP: -1698706.0:  76%|███████▌  | 19/25 [00:07<00:02,  2.50it/s][A
LP: -1698706.0:  76%|███████▌  | 19/25 [00:08<00:02,  2.50it/s][A
LP: -1698706.0:  80%|████████  | 20/25 [00:08<00:01,  2.50it/s][A
LP: -1698706.0:  80%|████████  | 20/25 [00:08<00:01,  2.50it/s][A
LP: -1698706.0:  84%|████████▍ | 21/25 [00:08<00:01,  2.51it/s][A
LP: -1698706.0:  84%|████████▍ | 21/25 [00:08<00:01,  2.51it/s][A
LP: -1698706.0:  88%|████████▊ | 22/25 [00:08<00:01,  2.51it/s][A
LP: -1698706.0:  88%|████████▊ | 22/25 [00:09<00:01,  2.51it/s][A
LP: -1698706.0:  92%|█████████▏| 23/25 [00:09<00:00,  2.51it/s][A
LP: -1698706.0:  92%|█████████▏| 23/25 [00:09<00:00,  2.51it/s][A
LP: -1698706.0:  96%|█████████▌| 24/25 [00:09<00:00,  2.50it/s][A
LP: -1698706.0:  96%|█████████▌| 24/25 [00:09<00:00,  2.50it/s][A
LP: -1698706.0: 100%|██████████| 25/25 [00:09<00:00,  2.50it/s][ALP: -1698706.0: 100%|██████████| 25/25 [00:09<00:00,  2.50it/s]
ARHMM Initialization restarts: 100%|██████████| 1/1 [00:10<00:00, 10.55s/it]ARHMM Initialization restarts: 100%|██████████| 1/1 [00:10<00:00, 10.55s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -6588090.6:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -4592061.8:   0%|          | 0/15 [01:31<?, ?it/s]ELBO: -4592061.8:   7%|▋         | 1/15 [01:31<21:23, 91.68s/it]ELBO: -4555506.0:   7%|▋         | 1/15 [02:36<21:23, 91.68s/it]ELBO: -4555506.0:  13%|█▎        | 2/15 [02:36<16:23, 75.67s/it]ELBO: -4539736.9:  13%|█▎        | 2/15 [03:28<16:23, 75.67s/it]ELBO: -4539736.9:  20%|██        | 3/15 [03:28<12:57, 64.83s/it]ELBO: -4528770.5:  20%|██        | 3/15 [04:20<12:57, 64.83s/it]ELBO: -4528770.5:  27%|██▋       | 4/15 [04:20<10:57, 59.80s/it]ELBO: -4523000.4:  27%|██▋       | 4/15 [05:10<10:57, 59.80s/it]ELBO: -4523000.4:  33%|███▎      | 5/15 [05:10<09:22, 56.24s/it]ELBO: -4518292.2:  33%|███▎      | 5/15 [05:57<09:22, 56.24s/it]ELBO: -4518292.2:  40%|████      | 6/15 [05:57<07:59, 53.33s/it]ELBO: -4512911.5:  40%|████      | 6/15 [06:45<07:59, 53.33s/it]ELBO: -4512911.5:  47%|████▋     | 7/15 [06:45<06:52, 51.54s/it]ELBO: -4508316.9:  47%|████▋     | 7/15 [07:33<06:52, 51.54s/it]ELBO: -4508316.9:  53%|█████▎    | 8/15 [07:33<05:52, 50.37s/it]ELBO: -4506654.6:  53%|█████▎    | 8/15 [08:17<05:52, 50.37s/it]ELBO: -4506654.6:  60%|██████    | 9/15 [08:17<04:49, 48.28s/it]ELBO: -4503939.6:  60%|██████    | 9/15 [09:02<04:49, 48.28s/it]ELBO: -4503939.6:  67%|██████▋   | 10/15 [09:02<03:57, 47.49s/it]ELBO: -4501783.2:  67%|██████▋   | 10/15 [09:46<03:57, 47.49s/it]ELBO: -4501783.2:  73%|███████▎  | 11/15 [09:46<03:05, 46.27s/it]ELBO: -4499053.3:  73%|███████▎  | 11/15 [10:32<03:05, 46.27s/it]ELBO: -4499053.3:  80%|████████  | 12/15 [10:32<02:18, 46.10s/it]ELBO: -4499587.9:  80%|████████  | 12/15 [11:15<02:18, 46.10s/it]ELBO: -4499587.9:  87%|████████▋ | 13/15 [11:15<01:30, 45.33s/it]ELBO: -4497615.2:  87%|████████▋ | 13/15 [11:59<01:30, 45.33s/it]ELBO: -4497615.2:  93%|█████████▎| 14/15 [11:59<00:44, 44.78s/it]ELBO: -4496580.9:  93%|█████████▎| 14/15 [12:42<00:44, 44.78s/it]ELBO: -4496580.9: 100%|██████████| 15/15 [12:42<00:00, 44.40s/it]ELBO: -4496580.9: 100%|██████████| 15/15 [12:42<00:00, 50.85s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -1845810.3:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -818377.2:   0%|          | 0/15 [00:14<?, ?it/s] ELBO: -818377.2:   7%|▋         | 1/15 [00:14<03:23, 14.52s/it]ELBO: -818705.7:   7%|▋         | 1/15 [00:19<03:23, 14.52s/it]ELBO: -818705.7:  13%|█▎        | 2/15 [00:19<01:58,  9.11s/it]ELBO: -817887.3:  13%|█▎        | 2/15 [00:25<01:58,  9.11s/it]ELBO: -817887.3:  20%|██        | 3/15 [00:25<01:28,  7.37s/it]ELBO: -818543.8:  20%|██        | 3/15 [00:30<01:28,  7.37s/it]ELBO: -818543.8:  27%|██▋       | 4/15 [00:30<01:12,  6.56s/it]ELBO: -818422.7:  27%|██▋       | 4/15 [00:35<01:12,  6.56s/it]ELBO: -818422.7:  33%|███▎      | 5/15 [00:35<01:01,  6.12s/it]ELBO: -818447.3:  33%|███▎      | 5/15 [00:41<01:01,  6.12s/it]ELBO: -818447.3:  40%|████      | 6/15 [00:41<00:52,  5.85s/it]ELBO: -818233.8:  40%|████      | 6/15 [00:46<00:52,  5.85s/it]ELBO: -818233.8:  47%|████▋     | 7/15 [00:46<00:45,  5.67s/it]ELBO: -818197.6:  47%|████▋     | 7/15 [00:51<00:45,  5.67s/it]ELBO: -818197.6:  53%|█████▎    | 8/15 [00:51<00:38,  5.55s/it]ELBO: -817868.7:  53%|█████▎    | 8/15 [00:57<00:38,  5.55s/it]ELBO: -817868.7:  60%|██████    | 9/15 [00:57<00:32,  5.49s/it]ELBO: -817875.3:  60%|██████    | 9/15 [01:02<00:32,  5.49s/it]ELBO: -817875.3:  67%|██████▋   | 10/15 [01:02<00:27,  5.44s/it]ELBO: -817678.6:  67%|██████▋   | 10/15 [01:07<00:27,  5.44s/it]ELBO: -817678.6:  73%|███████▎  | 11/15 [01:07<00:21,  5.41s/it]ELBO: -817594.8:  73%|███████▎  | 11/15 [01:13<00:21,  5.41s/it]ELBO: -817594.8:  80%|████████  | 12/15 [01:13<00:16,  5.38s/it]ELBO: -817655.2:  80%|████████  | 12/15 [01:18<00:16,  5.38s/it]ELBO: -817655.2:  87%|████████▋ | 13/15 [01:18<00:10,  5.36s/it]ELBO: -817943.4:  87%|████████▋ | 13/15 [01:23<00:10,  5.36s/it]ELBO: -817943.4:  93%|█████████▎| 14/15 [01:23<00:05,  5.35s/it]ELBO: -818012.5:  93%|█████████▎| 14/15 [01:29<00:05,  5.35s/it]ELBO: -818012.5: 100%|██████████| 15/15 [01:29<00:00,  5.34s/it]ELBO: -818012.5: 100%|██████████| 15/15 [01:29<00:00,  5.93s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -1787397.6:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -762237.4:   0%|          | 0/15 [00:16<?, ?it/s] ELBO: -762237.4:   7%|▋         | 1/15 [00:16<03:56, 16.91s/it]ELBO: -762035.8:   7%|▋         | 1/15 [00:22<03:56, 16.91s/it]ELBO: -762035.8:  13%|█▎        | 2/15 [00:22<02:11, 10.08s/it]ELBO: -762169.3:  13%|█▎        | 2/15 [00:27<02:11, 10.08s/it]ELBO: -762169.3:  20%|██        | 3/15 [00:27<01:34,  7.91s/it]ELBO: -762359.3:  20%|██        | 3/15 [00:32<01:34,  7.91s/it]ELBO: -762359.3:  27%|██▋       | 4/15 [00:32<01:15,  6.88s/it]ELBO: -761571.0:  27%|██▋       | 4/15 [00:38<01:15,  6.88s/it]ELBO: -761571.0:  33%|███▎      | 5/15 [00:38<01:03,  6.32s/it]ELBO: -762288.6:  33%|███▎      | 5/15 [00:43<01:03,  6.32s/it]ELBO: -762288.6:  40%|████      | 6/15 [00:43<00:53,  5.98s/it]ELBO: -761699.4:  40%|████      | 6/15 [00:48<00:53,  5.98s/it]ELBO: -761699.4:  47%|████▋     | 7/15 [00:48<00:46,  5.76s/it]ELBO: -761560.3:  47%|████▋     | 7/15 [00:54<00:46,  5.76s/it]ELBO: -761560.3:  53%|█████▎    | 8/15 [00:54<00:39,  5.62s/it]ELBO: -761691.8:  53%|█████▎    | 8/15 [00:59<00:39,  5.62s/it]ELBO: -761691.8:  60%|██████    | 9/15 [00:59<00:33,  5.52s/it]ELBO: -761980.0:  60%|██████    | 9/15 [01:04<00:33,  5.52s/it]ELBO: -761980.0:  67%|██████▋   | 10/15 [01:04<00:27,  5.46s/it]ELBO: -761634.7:  67%|██████▋   | 10/15 [01:10<00:27,  5.46s/it]ELBO: -761634.7:  73%|███████▎  | 11/15 [01:10<00:21,  5.41s/it]ELBO: -762144.1:  73%|███████▎  | 11/15 [01:15<00:21,  5.41s/it]ELBO: -762144.1:  80%|████████  | 12/15 [01:15<00:16,  5.38s/it]ELBO: -762425.4:  80%|████████  | 12/15 [01:20<00:16,  5.38s/it]ELBO: -762425.4:  87%|████████▋ | 13/15 [01:20<00:10,  5.36s/it]ELBO: -761967.0:  87%|████████▋ | 13/15 [01:26<00:10,  5.36s/it]ELBO: -761967.0:  93%|█████████▎| 14/15 [01:26<00:05,  5.36s/it]ELBO: -761822.0:  93%|█████████▎| 14/15 [01:31<00:05,  5.36s/it]ELBO: -761822.0: 100%|██████████| 15/15 [01:31<00:00,  5.34s/it]ELBO: -761822.0: 100%|██████████| 15/15 [01:31<00:00,  6.09s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -1929869.7:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -832550.5:   0%|          | 0/15 [00:14<?, ?it/s] ELBO: -832550.5:   7%|▋         | 1/15 [00:14<03:25, 14.67s/it]ELBO: -832502.1:   7%|▋         | 1/15 [00:19<03:25, 14.67s/it]ELBO: -832502.1:  13%|█▎        | 2/15 [00:19<01:59,  9.18s/it]ELBO: -832460.2:  13%|█▎        | 2/15 [00:25<01:59,  9.18s/it]ELBO: -832460.2:  20%|██        | 3/15 [00:25<01:28,  7.41s/it]ELBO: -832767.8:  20%|██        | 3/15 [00:30<01:28,  7.41s/it]ELBO: -832767.8:  27%|██▋       | 4/15 [00:30<01:12,  6.58s/it]ELBO: -832747.1:  27%|██▋       | 4/15 [00:35<01:12,  6.58s/it]ELBO: -832747.1:  33%|███▎      | 5/15 [00:35<01:01,  6.12s/it]ELBO: -832335.3:  33%|███▎      | 5/15 [00:41<01:01,  6.12s/it]ELBO: -832335.3:  40%|████      | 6/15 [00:41<00:52,  5.85s/it]ELBO: -832732.8:  40%|████      | 6/15 [00:46<00:52,  5.85s/it]ELBO: -832732.8:  47%|████▋     | 7/15 [00:46<00:45,  5.69s/it]ELBO: -831745.4:  47%|████▋     | 7/15 [00:51<00:45,  5.69s/it]ELBO: -831745.4:  53%|█████▎    | 8/15 [00:51<00:38,  5.57s/it]ELBO: -832812.5:  53%|█████▎    | 8/15 [00:57<00:38,  5.57s/it]ELBO: -832812.5:  60%|██████    | 9/15 [00:57<00:32,  5.49s/it]ELBO: -832858.3:  60%|██████    | 9/15 [01:02<00:32,  5.49s/it]ELBO: -832858.3:  67%|██████▋   | 10/15 [01:02<00:27,  5.45s/it]ELBO: -832409.3:  67%|██████▋   | 10/15 [01:07<00:27,  5.45s/it]ELBO: -832409.3:  73%|███████▎  | 11/15 [01:07<00:21,  5.41s/it]ELBO: -832764.9:  73%|███████▎  | 11/15 [01:13<00:21,  5.41s/it]ELBO: -832764.9:  80%|████████  | 12/15 [01:13<00:16,  5.39s/it]ELBO: -832603.9:  80%|████████  | 12/15 [01:18<00:16,  5.39s/it]ELBO: -832603.9:  87%|████████▋ | 13/15 [01:18<00:10,  5.37s/it]ELBO: -832545.6:  87%|████████▋ | 13/15 [01:23<00:10,  5.37s/it]ELBO: -832545.6:  93%|█████████▎| 14/15 [01:23<00:05,  5.36s/it]ELBO: -832088.9:  93%|█████████▎| 14/15 [01:29<00:05,  5.36s/it]ELBO: -832088.9: 100%|██████████| 15/15 [01:29<00:00,  5.35s/it]ELBO: -832088.9: 100%|██████████| 15/15 [01:29<00:00,  5.95s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -1855376.0:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -800269.9:   0%|          | 0/15 [00:15<?, ?it/s] ELBO: -800269.9:   7%|▋         | 1/15 [00:15<03:33, 15.27s/it]ELBO: -799867.5:   7%|▋         | 1/15 [00:20<03:33, 15.27s/it]ELBO: -799867.5:  13%|█▎        | 2/15 [00:20<02:02,  9.41s/it]ELBO: -799653.8:  13%|█▎        | 2/15 [00:25<02:02,  9.41s/it]ELBO: -799653.8:  20%|██        | 3/15 [00:25<01:30,  7.54s/it]ELBO: -800165.3:  20%|██        | 3/15 [00:31<01:30,  7.54s/it]ELBO: -800165.3:  27%|██▋       | 4/15 [00:31<01:13,  6.67s/it]ELBO: -799892.3:  27%|██▋       | 4/15 [00:36<01:13,  6.67s/it]ELBO: -799892.3:  33%|███▎      | 5/15 [00:36<01:01,  6.18s/it]ELBO: -799848.5:  33%|███▎      | 5/15 [00:41<01:01,  6.18s/it]ELBO: -799848.5:  40%|████      | 6/15 [00:41<00:53,  5.89s/it]ELBO: -799713.6:  40%|████      | 6/15 [00:47<00:53,  5.89s/it]ELBO: -799713.6:  47%|████▋     | 7/15 [00:47<00:45,  5.70s/it]ELBO: -799874.0:  47%|████▋     | 7/15 [00:52<00:45,  5.70s/it]ELBO: -799874.0:  53%|█████▎    | 8/15 [00:52<00:39,  5.57s/it]ELBO: -799859.4:  53%|█████▎    | 8/15 [00:57<00:39,  5.57s/it]ELBO: -799859.4:  60%|██████    | 9/15 [00:57<00:32,  5.49s/it]ELBO: -799985.4:  60%|██████    | 9/15 [01:03<00:32,  5.49s/it]ELBO: -799985.4:  67%|██████▋   | 10/15 [01:03<00:27,  5.43s/it]ELBO: -800129.6:  67%|██████▋   | 10/15 [01:08<00:27,  5.43s/it]ELBO: -800129.6:  73%|███████▎  | 11/15 [01:08<00:21,  5.40s/it]ELBO: -800256.3:  73%|███████▎  | 11/15 [01:13<00:21,  5.40s/it]ELBO: -800256.3:  80%|████████  | 12/15 [01:13<00:16,  5.38s/it]ELBO: -800216.9:  80%|████████  | 12/15 [01:19<00:16,  5.38s/it]ELBO: -800216.9:  87%|████████▋ | 13/15 [01:19<00:10,  5.36s/it]ELBO: -799850.2:  87%|████████▋ | 13/15 [01:24<00:10,  5.36s/it]ELBO: -799850.2:  93%|█████████▎| 14/15 [01:24<00:05,  5.35s/it]ELBO: -799986.8:  93%|█████████▎| 14/15 [01:29<00:05,  5.35s/it]ELBO: -799986.8: 100%|██████████| 15/15 [01:29<00:00,  5.33s/it]ELBO: -799986.8: 100%|██████████| 15/15 [01:29<00:00,  5.98s/it]
