Processed spikes from trial 100.
Processed spikes from trial 200.
Processed spikes from trial 300.
  0%|          | 0/1 [00:00<?, ?it/s]ARHMM Initialization restarts:   0%|          | 0/1 [00:00<?, ?it/s]Initializing with an ARHMM using 25 steps of EM.

  0%|          | 0/25 [00:00<?, ?it/s][A
LP: -5525825.2:   0%|          | 0/25 [00:00<?, ?it/s][A
LP: -5525825.2:   0%|          | 0/25 [00:03<?, ?it/s][A
LP: -5525825.2:   4%|▍         | 1/25 [00:03<01:17,  3.25s/it][A
LP: -5525825.2:   4%|▍         | 1/25 [00:05<01:17,  3.25s/it][A
LP: -5525825.2:   8%|▊         | 2/25 [00:05<01:00,  2.63s/it][A
LP: -5525825.2:   8%|▊         | 2/25 [00:07<01:00,  2.63s/it][A
LP: -5525825.2:  12%|█▏        | 3/25 [00:07<00:49,  2.23s/it][A
LP: -5525825.2:  12%|█▏        | 3/25 [00:09<00:49,  2.23s/it][A
LP: -5525825.2:  16%|█▌        | 4/25 [00:09<00:46,  2.21s/it][A
LP: -5525825.2:  16%|█▌        | 4/25 [00:11<00:46,  2.21s/it][A
LP: -5525825.2:  20%|██        | 5/25 [00:11<00:40,  2.03s/it][A
LP: -5525825.2:  20%|██        | 5/25 [00:14<00:40,  2.03s/it][A
LP: -5525825.2:  24%|██▍       | 6/25 [00:14<00:46,  2.44s/it][A
LP: -5525825.2:  24%|██▍       | 6/25 [00:16<00:46,  2.44s/it][A
LP: -5525825.2:  28%|██▊       | 7/25 [00:16<00:42,  2.37s/it][A
LP: -5525825.2:  28%|██▊       | 7/25 [00:18<00:42,  2.37s/it][A
LP: -5525825.2:  32%|███▏      | 8/25 [00:18<00:36,  2.18s/it][A
LP: -5525825.2:  32%|███▏      | 8/25 [00:20<00:36,  2.18s/it][A
LP: -5525825.2:  36%|███▌      | 9/25 [00:20<00:32,  2.05s/it][A
LP: -5525825.2:  36%|███▌      | 9/25 [00:22<00:32,  2.05s/it][A
LP: -5525825.2:  40%|████      | 10/25 [00:22<00:31,  2.09s/it][A
LP: -5525825.2:  40%|████      | 10/25 [00:24<00:31,  2.09s/it][A
LP: -5525825.2:  44%|████▍     | 11/25 [00:24<00:27,  1.99s/it][A
LP: -5525825.2:  44%|████▍     | 11/25 [00:26<00:27,  1.99s/it][A
LP: -5525825.2:  48%|████▊     | 12/25 [00:26<00:26,  2.06s/it][A
LP: -5525825.2:  48%|████▊     | 12/25 [00:28<00:26,  2.06s/it][A
LP: -5525825.2:  52%|█████▏    | 13/25 [00:28<00:24,  2.02s/it][A
LP: -5525825.2:  52%|█████▏    | 13/25 [00:30<00:24,  2.02s/it][A
LP: -5525825.2:  56%|█████▌    | 14/25 [00:30<00:22,  2.08s/it][A
LP: -5525825.2:  56%|█████▌    | 14/25 [00:32<00:22,  2.08s/it][A
LP: -5525825.2:  60%|██████    | 15/25 [00:32<00:20,  2.02s/it][A
LP: -5525825.2:  60%|██████    | 15/25 [00:34<00:20,  2.02s/it][A
LP: -5525825.2:  64%|██████▍   | 16/25 [00:34<00:18,  2.08s/it][A
LP: -5525825.2:  64%|██████▍   | 16/25 [00:36<00:18,  2.08s/it][A
LP: -5525825.2:  68%|██████▊   | 17/25 [00:36<00:16,  2.04s/it][A
LP: -5525825.2:  68%|██████▊   | 17/25 [00:38<00:16,  2.04s/it][A
LP: -5525825.2:  72%|███████▏  | 18/25 [00:38<00:14,  2.09s/it][A
LP: -5525825.2:  72%|███████▏  | 18/25 [00:40<00:14,  2.09s/it][A
LP: -5525825.2:  76%|███████▌  | 19/25 [00:40<00:12,  2.03s/it][A
LP: -5525825.2:  76%|███████▌  | 19/25 [00:42<00:12,  2.03s/it][A
LP: -5525825.2:  80%|████████  | 20/25 [00:42<00:10,  2.08s/it][A
LP: -5525825.2:  80%|████████  | 20/25 [00:44<00:10,  2.08s/it][A
LP: -5525825.2:  84%|████████▍ | 21/25 [00:44<00:08,  2.04s/it][A
LP: -5525825.2:  84%|████████▍ | 21/25 [00:46<00:08,  2.04s/it][A
LP: -5525825.2:  88%|████████▊ | 22/25 [00:46<00:06,  2.09s/it][A
LP: -5525825.2:  88%|████████▊ | 22/25 [00:48<00:06,  2.09s/it][A
LP: -5525825.2:  92%|█████████▏| 23/25 [00:48<00:04,  2.03s/it][A
LP: -5525825.2:  92%|█████████▏| 23/25 [00:50<00:04,  2.03s/it][A
LP: -5525825.2:  96%|█████████▌| 24/25 [00:50<00:02,  2.08s/it][A
LP: -5525825.2:  96%|█████████▌| 24/25 [00:52<00:02,  2.08s/it][A
LP: -5525825.2: 100%|██████████| 25/25 [00:52<00:00,  2.04s/it][ALP: -5525825.2: 100%|██████████| 25/25 [00:52<00:00,  2.12s/it]
ARHMM Initialization restarts: 100%|██████████| 1/1 [00:55<00:00, 55.30s/it]ARHMM Initialization restarts: 100%|██████████| 1/1 [00:55<00:00, 55.30s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -11337864.0:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -4574854.7:   0%|          | 0/15 [07:05<?, ?it/s] ELBO: -4574854.7:   7%|▋         | 1/15 [07:05<1:39:13, 425.27s/it]ELBO: -4505475.8:   7%|▋         | 1/15 [12:14<1:39:13, 425.27s/it]ELBO: -4505475.8:  13%|█▎        | 2/15 [12:14<1:17:21, 357.03s/it]ELBO: -4470195.3:  13%|█▎        | 2/15 [17:28<1:17:21, 357.03s/it]ELBO: -4470195.3:  20%|██        | 3/15 [17:28<1:07:26, 337.20s/it]ELBO: -4451107.7:  20%|██        | 3/15 [22:31<1:07:26, 337.20s/it]ELBO: -4451107.7:  27%|██▋       | 4/15 [22:31<59:22, 323.83s/it]  ELBO: -4437823.0:  27%|██▋       | 4/15 [27:34<59:22, 323.83s/it]ELBO: -4437823.0:  33%|███▎      | 5/15 [27:34<52:41, 316.17s/it]ELBO: -4429988.4:  33%|███▎      | 5/15 [32:38<52:41, 316.17s/it]ELBO: -4429988.4:  40%|████      | 6/15 [32:38<46:50, 312.24s/it]ELBO: -4422591.8:  40%|████      | 6/15 [37:44<46:50, 312.24s/it]ELBO: -4422591.8:  47%|████▋     | 7/15 [37:44<41:20, 310.03s/it]ELBO: -4418065.3:  47%|████▋     | 7/15 [42:50<41:20, 310.03s/it]ELBO: -4418065.3:  53%|█████▎    | 8/15 [42:50<36:01, 308.86s/it]ELBO: -4414161.8:  53%|█████▎    | 8/15 [47:57<36:01, 308.86s/it]ELBO: -4414161.8:  60%|██████    | 9/15 [47:57<30:49, 308.32s/it]ELBO: -4409400.5:  60%|██████    | 9/15 [54:33<30:49, 308.32s/it]ELBO: -4409400.5:  67%|██████▋   | 10/15 [54:33<27:56, 335.30s/it]ELBO: -4407305.8:  67%|██████▋   | 10/15 [1:00:24<27:56, 335.30s/it]ELBO: -4407305.8:  73%|███████▎  | 11/15 [1:00:24<22:41, 340.27s/it]ELBO: -4401603.2:  73%|███████▎  | 11/15 [1:06:02<22:41, 340.27s/it]ELBO: -4401603.2:  80%|████████  | 12/15 [1:06:02<16:58, 339.52s/it]ELBO: -4401697.3:  80%|████████  | 12/15 [1:11:10<16:58, 339.52s/it]ELBO: -4401697.3:  87%|████████▋ | 13/15 [1:11:10<10:59, 329.81s/it]ELBO: -4402267.6:  87%|████████▋ | 13/15 [1:16:11<10:59, 329.81s/it]ELBO: -4402267.6:  93%|█████████▎| 14/15 [1:16:11<05:21, 321.12s/it]ELBO: -4395406.4:  93%|█████████▎| 14/15 [1:21:13<05:21, 321.12s/it]ELBO: -4395406.4: 100%|██████████| 15/15 [1:21:13<00:00, 315.58s/it]ELBO: -4395406.4: 100%|██████████| 15/15 [1:21:13<00:00, 324.93s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -35999802.6:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -892180.2:   0%|          | 0/15 [02:28<?, ?it/s]  ELBO: -892180.2:   7%|▋         | 1/15 [02:28<34:33, 148.11s/it]ELBO: -893767.8:   7%|▋         | 1/15 [03:18<34:33, 148.11s/it]ELBO: -893767.8:  13%|█▎        | 2/15 [03:18<19:38, 90.63s/it] ELBO: -891851.4:  13%|█▎        | 2/15 [04:08<19:38, 90.63s/it]ELBO: -891851.4:  20%|██        | 3/15 [04:08<14:23, 71.96s/it]ELBO: -894079.5:  20%|██        | 3/15 [05:05<14:23, 71.96s/it]ELBO: -894079.5:  27%|██▋       | 4/15 [05:05<12:06, 66.07s/it]ELBO: -893006.9:  27%|██▋       | 4/15 [06:03<12:06, 66.07s/it]ELBO: -893006.9:  33%|███▎      | 5/15 [06:03<10:31, 63.16s/it]ELBO: -892614.0:  33%|███▎      | 5/15 [06:53<10:31, 63.16s/it]ELBO: -892614.0:  40%|████      | 6/15 [06:53<08:47, 58.62s/it]ELBO: -892543.8:  40%|████      | 6/15 [07:42<08:47, 58.62s/it]ELBO: -892543.8:  47%|████▋     | 7/15 [07:42<07:25, 55.72s/it]ELBO: -893564.1:  47%|████▋     | 7/15 [08:32<07:25, 55.72s/it]ELBO: -893564.1:  53%|█████▎    | 8/15 [08:32<06:17, 53.90s/it]ELBO: -892045.8:  53%|█████▎    | 8/15 [09:22<06:17, 53.90s/it]ELBO: -892045.8:  60%|██████    | 9/15 [09:22<05:15, 52.55s/it]ELBO: -893035.4:  60%|██████    | 9/15 [10:12<05:15, 52.55s/it]ELBO: -893035.4:  67%|██████▋   | 10/15 [10:12<04:19, 51.83s/it]ELBO: -892469.3:  67%|██████▋   | 10/15 [11:02<04:19, 51.83s/it]ELBO: -892469.3:  73%|███████▎  | 11/15 [11:02<03:24, 51.23s/it]ELBO: -892934.9:  73%|███████▎  | 11/15 [11:52<03:24, 51.23s/it]ELBO: -892934.9:  80%|████████  | 12/15 [11:52<02:32, 50.75s/it]ELBO: -893609.6:  80%|████████  | 12/15 [12:41<02:32, 50.75s/it]ELBO: -893609.6:  87%|████████▋ | 13/15 [12:41<01:40, 50.41s/it]ELBO: -892662.9:  87%|████████▋ | 13/15 [13:31<01:40, 50.41s/it]ELBO: -892662.9:  93%|█████████▎| 14/15 [13:31<00:50, 50.21s/it]ELBO: -893910.5:  93%|█████████▎| 14/15 [14:20<00:50, 50.21s/it]ELBO: -893910.5: 100%|██████████| 15/15 [14:20<00:00, 49.90s/it]ELBO: -893910.5: 100%|██████████| 15/15 [14:20<00:00, 57.38s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -37600600.2:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -840685.2:   0%|          | 0/15 [01:57<?, ?it/s]  ELBO: -840685.2:   7%|▋         | 1/15 [01:57<27:26, 117.60s/it]ELBO: -840901.5:   7%|▋         | 1/15 [02:45<27:26, 117.60s/it]ELBO: -840901.5:  13%|█▎        | 2/15 [02:45<16:36, 76.64s/it] ELBO: -839667.8:  13%|█▎        | 2/15 [03:34<16:36, 76.64s/it]ELBO: -839667.8:  20%|██        | 3/15 [03:34<12:47, 63.93s/it]ELBO: -840291.4:  20%|██        | 3/15 [04:22<12:47, 63.93s/it]ELBO: -840291.4:  27%|██▋       | 4/15 [04:22<10:36, 57.84s/it]ELBO: -840024.2:  27%|██▋       | 4/15 [05:11<10:36, 57.84s/it]ELBO: -840024.2:  33%|███▎      | 5/15 [05:11<09:05, 54.59s/it]ELBO: -840405.5:  33%|███▎      | 5/15 [05:59<09:05, 54.59s/it]ELBO: -840405.5:  40%|████      | 6/15 [05:59<07:51, 52.38s/it]ELBO: -841830.4:  40%|████      | 6/15 [06:48<07:51, 52.38s/it]ELBO: -841830.4:  47%|████▋     | 7/15 [06:48<06:48, 51.12s/it]ELBO: -839114.3:  47%|████▋     | 7/15 [07:36<06:48, 51.12s/it]ELBO: -839114.3:  53%|█████▎    | 8/15 [07:36<05:51, 50.23s/it]ELBO: -840962.0:  53%|█████▎    | 8/15 [08:24<05:51, 50.23s/it]ELBO: -840962.0:  60%|██████    | 9/15 [08:24<04:56, 49.46s/it]ELBO: -840543.5:  60%|██████    | 9/15 [09:12<04:56, 49.46s/it]ELBO: -840543.5:  67%|██████▋   | 10/15 [09:12<04:05, 49.14s/it]ELBO: -839325.1:  67%|██████▋   | 10/15 [10:00<04:05, 49.14s/it]ELBO: -839325.1:  73%|███████▎  | 11/15 [10:00<03:14, 48.72s/it]ELBO: -840854.7:  73%|███████▎  | 11/15 [10:48<03:14, 48.72s/it]ELBO: -840854.7:  80%|████████  | 12/15 [10:48<02:25, 48.49s/it]ELBO: -841720.6:  80%|████████  | 12/15 [11:36<02:25, 48.49s/it]ELBO: -841720.6:  87%|████████▋ | 13/15 [11:36<01:36, 48.41s/it]ELBO: -840417.3:  87%|████████▋ | 13/15 [12:24<01:36, 48.41s/it]ELBO: -840417.3:  93%|█████████▎| 14/15 [12:24<00:48, 48.21s/it]ELBO: -841189.2:  93%|█████████▎| 14/15 [13:12<00:48, 48.21s/it]ELBO: -841189.2: 100%|██████████| 15/15 [13:12<00:00, 48.21s/it]ELBO: -841189.2: 100%|██████████| 15/15 [13:12<00:00, 52.85s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -32992857.9:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -885625.5:   0%|          | 0/15 [02:24<?, ?it/s]  ELBO: -885625.5:   7%|▋         | 1/15 [02:24<33:37, 144.10s/it]ELBO: -884970.0:   7%|▋         | 1/15 [03:12<33:37, 144.10s/it]ELBO: -884970.0:  13%|█▎        | 2/15 [03:12<18:57, 87.52s/it] ELBO: -883664.8:  13%|█▎        | 2/15 [04:00<18:57, 87.52s/it]ELBO: -883664.8:  20%|██        | 3/15 [04:00<13:56, 69.73s/it]ELBO: -882844.2:  20%|██        | 3/15 [04:48<13:56, 69.73s/it]ELBO: -882844.2:  27%|██▋       | 4/15 [04:48<11:11, 61.05s/it]ELBO: -884056.6:  27%|██▋       | 4/15 [05:36<11:11, 61.05s/it]ELBO: -884056.6:  33%|███▎      | 5/15 [05:36<09:25, 56.54s/it]ELBO: -884316.0:  33%|███▎      | 5/15 [06:25<09:25, 56.54s/it]ELBO: -884316.0:  40%|████      | 6/15 [06:25<08:04, 53.83s/it]ELBO: -883634.4:  40%|████      | 6/15 [07:14<08:04, 53.83s/it]ELBO: -883634.4:  47%|████▋     | 7/15 [07:14<06:59, 52.38s/it]ELBO: -884222.6:  47%|████▋     | 7/15 [08:04<06:59, 52.38s/it]ELBO: -884222.6:  53%|█████▎    | 8/15 [08:04<06:00, 51.53s/it]ELBO: -884151.5:  53%|█████▎    | 8/15 [08:54<06:00, 51.53s/it]ELBO: -884151.5:  60%|██████    | 9/15 [08:54<05:05, 50.93s/it]ELBO: -883502.3:  60%|██████    | 9/15 [09:43<05:05, 50.93s/it]ELBO: -883502.3:  67%|██████▋   | 10/15 [09:43<04:12, 50.52s/it]ELBO: -883181.2:  67%|██████▋   | 10/15 [10:33<04:12, 50.52s/it]ELBO: -883181.2:  73%|███████▎  | 11/15 [10:33<03:20, 50.20s/it]ELBO: -884021.2:  73%|███████▎  | 11/15 [11:22<03:20, 50.20s/it]ELBO: -884021.2:  80%|████████  | 12/15 [11:22<02:30, 50.04s/it]ELBO: -883817.3:  80%|████████  | 12/15 [12:12<02:30, 50.04s/it]ELBO: -883817.3:  87%|████████▋ | 13/15 [12:12<01:39, 49.86s/it]ELBO: -883380.2:  87%|████████▋ | 13/15 [13:01<01:39, 49.86s/it]ELBO: -883380.2:  93%|█████████▎| 14/15 [13:01<00:49, 49.79s/it]ELBO: -883994.0:  93%|█████████▎| 14/15 [13:51<00:49, 49.79s/it]ELBO: -883994.0: 100%|██████████| 15/15 [13:51<00:00, 49.74s/it]ELBO: -883994.0: 100%|██████████| 15/15 [13:51<00:00, 55.44s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -30921121.7:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -846707.6:   0%|          | 0/15 [02:06<?, ?it/s]  ELBO: -846707.6:   7%|▋         | 1/15 [02:06<29:32, 126.58s/it]ELBO: -846195.9:   7%|▋         | 1/15 [02:55<29:32, 126.58s/it]ELBO: -846195.9:  13%|█▎        | 2/15 [02:55<17:34, 81.15s/it] ELBO: -846180.4:  13%|█▎        | 2/15 [03:45<17:34, 81.15s/it]ELBO: -846180.4:  20%|██        | 3/15 [03:45<13:18, 66.51s/it]ELBO: -847723.7:  20%|██        | 3/15 [04:34<13:18, 66.51s/it]ELBO: -847723.7:  27%|██▋       | 4/15 [04:34<10:57, 59.74s/it]ELBO: -846031.2:  27%|██▋       | 4/15 [05:23<10:57, 59.74s/it]ELBO: -846031.2:  33%|███▎      | 5/15 [05:23<09:20, 56.00s/it]ELBO: -846470.6:  33%|███▎      | 5/15 [06:13<09:20, 56.00s/it]ELBO: -846470.6:  40%|████      | 6/15 [06:13<08:03, 53.78s/it]ELBO: -848291.4:  40%|████      | 6/15 [07:03<08:03, 53.78s/it]ELBO: -848291.4:  47%|████▋     | 7/15 [07:03<07:00, 52.52s/it]ELBO: -846887.3:  47%|████▋     | 7/15 [07:52<07:00, 52.52s/it]ELBO: -846887.3:  53%|█████▎    | 8/15 [07:52<06:00, 51.56s/it]ELBO: -846092.7:  53%|█████▎    | 8/15 [08:42<06:00, 51.56s/it]ELBO: -846092.7:  60%|██████    | 9/15 [08:42<05:05, 50.98s/it]ELBO: -847256.1:  60%|██████    | 9/15 [09:31<05:05, 50.98s/it]ELBO: -847256.1:  67%|██████▋   | 10/15 [09:31<04:12, 50.55s/it]ELBO: -846495.2:  67%|██████▋   | 10/15 [10:21<04:12, 50.55s/it]ELBO: -846495.2:  73%|███████▎  | 11/15 [10:21<03:21, 50.29s/it]ELBO: -846705.2:  73%|███████▎  | 11/15 [11:11<03:21, 50.29s/it]ELBO: -846705.2:  80%|████████  | 12/15 [11:11<02:30, 50.08s/it]ELBO: -847099.2:  80%|████████  | 12/15 [12:00<02:30, 50.08s/it]ELBO: -847099.2:  87%|████████▋ | 13/15 [12:00<01:39, 49.92s/it]ELBO: -845907.7:  87%|████████▋ | 13/15 [12:50<01:39, 49.92s/it]ELBO: -845907.7:  93%|█████████▎| 14/15 [12:50<00:49, 49.75s/it]ELBO: -847717.5:  93%|█████████▎| 14/15 [13:39<00:49, 49.75s/it]ELBO: -847717.5: 100%|██████████| 15/15 [13:39<00:00, 49.63s/it]ELBO: -847717.5: 100%|██████████| 15/15 [13:39<00:00, 54.63s/it]
