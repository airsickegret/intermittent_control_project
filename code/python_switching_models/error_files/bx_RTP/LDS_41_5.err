Processed spikes from trial 100.
Processed spikes from trial 200.
Processed spikes from trial 300.
  0%|          | 0/1 [00:00<?, ?it/s]ARHMM Initialization restarts:   0%|          | 0/1 [00:00<?, ?it/s]Initializing with an ARHMM using 25 steps of EM.

  0%|          | 0/25 [00:00<?, ?it/s][A
LP: -3119404.8:   0%|          | 0/25 [00:00<?, ?it/s][A
LP: -3119404.8:   0%|          | 0/25 [00:00<?, ?it/s][A
LP: -3119404.8:   4%|▍         | 1/25 [00:00<00:18,  1.31it/s][A
LP: -3119404.8:   4%|▍         | 1/25 [00:01<00:18,  1.31it/s][A
LP: -3119404.8:   8%|▊         | 2/25 [00:01<00:17,  1.31it/s][A
LP: -3119404.8:   8%|▊         | 2/25 [00:02<00:17,  1.31it/s][A
LP: -3119404.8:  12%|█▏        | 3/25 [00:02<00:17,  1.29it/s][A
LP: -3119404.8:  12%|█▏        | 3/25 [00:03<00:17,  1.29it/s][A
LP: -3119404.8:  16%|█▌        | 4/25 [00:03<00:16,  1.29it/s][A
LP: -3119404.8:  16%|█▌        | 4/25 [00:03<00:16,  1.29it/s][A
LP: -3119404.8:  20%|██        | 5/25 [00:03<00:15,  1.29it/s][A
LP: -3119404.8:  20%|██        | 5/25 [00:04<00:15,  1.29it/s][A
LP: -3119404.8:  24%|██▍       | 6/25 [00:04<00:14,  1.30it/s][A
LP: -3119404.8:  24%|██▍       | 6/25 [00:05<00:14,  1.30it/s][A
LP: -3119404.8:  28%|██▊       | 7/25 [00:05<00:13,  1.29it/s][A
LP: -3119404.8:  28%|██▊       | 7/25 [00:06<00:13,  1.29it/s][A
LP: -3119404.8:  32%|███▏      | 8/25 [00:06<00:13,  1.29it/s][A
LP: -3119404.8:  32%|███▏      | 8/25 [00:06<00:13,  1.29it/s][A
LP: -3119404.8:  36%|███▌      | 9/25 [00:06<00:12,  1.28it/s][A
LP: -3119404.8:  36%|███▌      | 9/25 [00:07<00:12,  1.28it/s][A
LP: -3119404.8:  40%|████      | 10/25 [00:07<00:11,  1.28it/s][A
LP: -3119404.8:  40%|████      | 10/25 [00:08<00:11,  1.28it/s][A
LP: -3119404.8:  44%|████▍     | 11/25 [00:08<00:10,  1.28it/s][A
LP: -3119404.8:  44%|████▍     | 11/25 [00:09<00:10,  1.28it/s][A
LP: -3119404.8:  48%|████▊     | 12/25 [00:09<00:10,  1.29it/s][A
LP: -3119404.8:  48%|████▊     | 12/25 [00:10<00:10,  1.29it/s][A
LP: -3119404.8:  52%|█████▏    | 13/25 [00:10<00:09,  1.28it/s][A
LP: -3119404.8:  52%|█████▏    | 13/25 [00:10<00:09,  1.28it/s][A
LP: -3119404.8:  56%|█████▌    | 14/25 [00:10<00:08,  1.30it/s][A
LP: -3119404.8:  56%|█████▌    | 14/25 [00:11<00:08,  1.30it/s][A
LP: -3119404.8:  60%|██████    | 15/25 [00:11<00:07,  1.30it/s][A
LP: -3119404.8:  60%|██████    | 15/25 [00:12<00:07,  1.30it/s][A
LP: -3119404.8:  64%|██████▍   | 16/25 [00:12<00:06,  1.30it/s][A
LP: -3119404.8:  64%|██████▍   | 16/25 [00:13<00:06,  1.30it/s][A
LP: -3119404.8:  68%|██████▊   | 17/25 [00:13<00:06,  1.31it/s][A
LP: -3119404.8:  68%|██████▊   | 17/25 [00:13<00:06,  1.31it/s][A
LP: -3119404.8:  72%|███████▏  | 18/25 [00:13<00:05,  1.30it/s][A
LP: -3119404.8:  72%|███████▏  | 18/25 [00:14<00:05,  1.30it/s][A
LP: -3119404.8:  76%|███████▌  | 19/25 [00:14<00:04,  1.31it/s][A
LP: -3119404.8:  76%|███████▌  | 19/25 [00:15<00:04,  1.31it/s][A
LP: -3119404.8:  80%|████████  | 20/25 [00:15<00:03,  1.31it/s][A
LP: -3119404.8:  80%|████████  | 20/25 [00:16<00:03,  1.31it/s][A
LP: -3119404.8:  84%|████████▍ | 21/25 [00:16<00:03,  1.31it/s][A
LP: -3119404.8:  84%|████████▍ | 21/25 [00:16<00:03,  1.31it/s][A
LP: -3119404.8:  88%|████████▊ | 22/25 [00:16<00:02,  1.31it/s][A
LP: -3119404.8:  88%|████████▊ | 22/25 [00:17<00:02,  1.31it/s][A
LP: -3119404.8:  92%|█████████▏| 23/25 [00:17<00:01,  1.31it/s][A
LP: -3119404.8:  92%|█████████▏| 23/25 [00:18<00:01,  1.31it/s][A
LP: -3119404.8:  96%|█████████▌| 24/25 [00:18<00:00,  1.30it/s][A
LP: -3119404.8:  96%|█████████▌| 24/25 [00:19<00:00,  1.30it/s][A
LP: -3119404.8: 100%|██████████| 25/25 [00:19<00:00,  1.30it/s][ALP: -3119404.8: 100%|██████████| 25/25 [00:19<00:00,  1.30it/s]
ARHMM Initialization restarts: 100%|██████████| 1/1 [00:20<00:00, 20.20s/it]ARHMM Initialization restarts: 100%|██████████| 1/1 [00:20<00:00, 20.20s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -8238885.5:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -4548311.4:   0%|          | 0/15 [03:02<?, ?it/s]ELBO: -4548311.4:   7%|▋         | 1/15 [03:02<42:31, 182.22s/it]ELBO: -4497235.8:   7%|▋         | 1/15 [05:17<42:31, 182.22s/it]ELBO: -4497235.8:  13%|█▎        | 2/15 [05:17<33:32, 154.84s/it]ELBO: -4473692.6:  13%|█▎        | 2/15 [07:16<33:32, 154.84s/it]ELBO: -4473692.6:  20%|██        | 3/15 [07:16<27:37, 138.10s/it]ELBO: -4460492.6:  20%|██        | 3/15 [09:14<27:37, 138.10s/it]ELBO: -4460492.6:  27%|██▋       | 4/15 [09:14<23:53, 130.30s/it]ELBO: -4451893.8:  27%|██▋       | 4/15 [11:07<23:53, 130.30s/it]ELBO: -4451893.8:  33%|███▎      | 5/15 [11:07<20:41, 124.20s/it]ELBO: -4442641.1:  33%|███▎      | 5/15 [13:01<20:41, 124.20s/it]ELBO: -4442641.1:  40%|████      | 6/15 [13:01<18:05, 120.59s/it]ELBO: -4437957.4:  40%|████      | 6/15 [14:57<18:05, 120.59s/it]ELBO: -4437957.4:  47%|████▋     | 7/15 [14:57<15:52, 119.01s/it]ELBO: -4433554.8:  47%|████▋     | 7/15 [16:52<15:52, 119.01s/it]ELBO: -4433554.8:  53%|█████▎    | 8/15 [16:52<13:45, 117.91s/it]ELBO: -4430526.7:  53%|█████▎    | 8/15 [18:46<13:45, 117.91s/it]ELBO: -4430526.7:  60%|██████    | 9/15 [18:46<11:38, 116.49s/it]ELBO: -4427198.0:  60%|██████    | 9/15 [20:39<11:38, 116.49s/it]ELBO: -4427198.0:  67%|██████▋   | 10/15 [20:39<09:38, 115.60s/it]ELBO: -4423682.4:  67%|██████▋   | 10/15 [22:33<09:38, 115.60s/it]ELBO: -4423682.4:  73%|███████▎  | 11/15 [22:33<07:39, 114.93s/it]ELBO: -4422056.3:  73%|███████▎  | 11/15 [24:26<07:39, 114.93s/it]ELBO: -4422056.3:  80%|████████  | 12/15 [24:26<05:43, 114.44s/it]ELBO: -4419084.6:  80%|████████  | 12/15 [26:19<05:43, 114.44s/it]ELBO: -4419084.6:  87%|████████▋ | 13/15 [26:19<03:48, 114.06s/it]ELBO: -4417208.8:  87%|████████▋ | 13/15 [28:13<03:48, 114.06s/it]ELBO: -4417208.8:  93%|█████████▎| 14/15 [28:13<01:53, 113.90s/it]ELBO: -4416286.8:  93%|█████████▎| 14/15 [30:06<01:53, 113.90s/it]ELBO: -4416286.8: 100%|██████████| 15/15 [30:06<00:00, 113.73s/it]ELBO: -4416286.8: 100%|██████████| 15/15 [30:06<00:00, 120.43s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -5106819.9:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -858024.7:   0%|          | 0/15 [00:40<?, ?it/s] ELBO: -858024.7:   7%|▋         | 1/15 [00:40<09:24, 40.34s/it]ELBO: -858247.7:   7%|▋         | 1/15 [00:56<09:24, 40.34s/it]ELBO: -858247.7:  13%|█▎        | 2/15 [00:56<05:42, 26.31s/it]ELBO: -857945.6:  13%|█▎        | 2/15 [01:13<05:42, 26.31s/it]ELBO: -857945.6:  20%|██        | 3/15 [01:13<04:22, 21.84s/it]ELBO: -857671.4:  20%|██        | 3/15 [01:29<04:22, 21.84s/it]ELBO: -857671.4:  27%|██▋       | 4/15 [01:29<03:36, 19.70s/it]ELBO: -857661.6:  27%|██▋       | 4/15 [01:46<03:36, 19.70s/it]ELBO: -857661.6:  33%|███▎      | 5/15 [01:46<03:04, 18.50s/it]ELBO: -858826.3:  33%|███▎      | 5/15 [02:02<03:04, 18.50s/it]ELBO: -858826.3:  40%|████      | 6/15 [02:02<02:39, 17.77s/it]ELBO: -858655.7:  40%|████      | 6/15 [02:18<02:39, 17.77s/it]ELBO: -858655.7:  47%|████▋     | 7/15 [02:18<02:18, 17.33s/it]ELBO: -858263.2:  47%|████▋     | 7/15 [02:35<02:18, 17.33s/it]ELBO: -858263.2:  53%|█████▎    | 8/15 [02:35<01:59, 17.00s/it]ELBO: -858411.4:  53%|█████▎    | 8/15 [02:51<01:59, 17.00s/it]ELBO: -858411.4:  60%|██████    | 9/15 [02:51<01:40, 16.82s/it]ELBO: -858499.3:  60%|██████    | 9/15 [03:07<01:40, 16.82s/it]ELBO: -858499.3:  67%|██████▋   | 10/15 [03:07<01:23, 16.68s/it]ELBO: -858029.8:  67%|██████▋   | 10/15 [03:24<01:23, 16.68s/it]ELBO: -858029.8:  73%|███████▎  | 11/15 [03:24<01:06, 16.56s/it]ELBO: -858331.9:  73%|███████▎  | 11/15 [03:40<01:06, 16.56s/it]ELBO: -858331.9:  80%|████████  | 12/15 [03:40<00:49, 16.52s/it]ELBO: -857475.9:  80%|████████  | 12/15 [03:57<00:49, 16.52s/it]ELBO: -857475.9:  87%|████████▋ | 13/15 [03:57<00:32, 16.48s/it]ELBO: -857936.8:  87%|████████▋ | 13/15 [04:13<00:32, 16.48s/it]ELBO: -857936.8:  93%|█████████▎| 14/15 [04:13<00:16, 16.45s/it]ELBO: -857558.9:  93%|█████████▎| 14/15 [04:29<00:16, 16.45s/it]ELBO: -857558.9: 100%|██████████| 15/15 [04:29<00:00, 16.43s/it]ELBO: -857558.9: 100%|██████████| 15/15 [04:29<00:00, 17.99s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -5319100.6:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -830466.4:   0%|          | 0/15 [00:38<?, ?it/s] ELBO: -830466.4:   7%|▋         | 1/15 [00:38<08:52, 38.05s/it]ELBO: -830490.9:   7%|▋         | 1/15 [00:54<08:52, 38.05s/it]ELBO: -830490.9:  13%|█▎        | 2/15 [00:54<05:29, 25.34s/it]ELBO: -830753.3:  13%|█▎        | 2/15 [01:10<05:29, 25.34s/it]ELBO: -830753.3:  20%|██        | 3/15 [01:10<04:15, 21.27s/it]ELBO: -830722.2:  20%|██        | 3/15 [01:27<04:15, 21.27s/it]ELBO: -830722.2:  27%|██▋       | 4/15 [01:27<03:33, 19.37s/it]ELBO: -830506.0:  27%|██▋       | 4/15 [01:43<03:33, 19.37s/it]ELBO: -830506.0:  33%|███▎      | 5/15 [01:43<03:02, 18.28s/it]ELBO: -831041.0:  33%|███▎      | 5/15 [01:59<03:02, 18.28s/it]ELBO: -831041.0:  40%|████      | 6/15 [01:59<02:38, 17.60s/it]ELBO: -831123.1:  40%|████      | 6/15 [02:16<02:38, 17.60s/it]ELBO: -831123.1:  47%|████▋     | 7/15 [02:16<02:17, 17.19s/it]ELBO: -830379.0:  47%|████▋     | 7/15 [02:32<02:17, 17.19s/it]ELBO: -830379.0:  53%|█████▎    | 8/15 [02:32<01:58, 16.93s/it]ELBO: -831372.9:  53%|█████▎    | 8/15 [02:49<01:58, 16.93s/it]ELBO: -831372.9:  60%|██████    | 9/15 [02:49<01:40, 16.76s/it]ELBO: -830577.0:  60%|██████    | 9/15 [03:05<01:40, 16.76s/it]ELBO: -830577.0:  67%|██████▋   | 10/15 [03:05<01:23, 16.65s/it]ELBO: -830788.9:  67%|██████▋   | 10/15 [03:21<01:23, 16.65s/it]ELBO: -830788.9:  73%|███████▎  | 11/15 [03:21<01:06, 16.59s/it]ELBO: -831206.1:  73%|███████▎  | 11/15 [03:38<01:06, 16.59s/it]ELBO: -831206.1:  80%|████████  | 12/15 [03:38<00:49, 16.55s/it]ELBO: -831562.9:  80%|████████  | 12/15 [03:54<00:49, 16.55s/it]ELBO: -831562.9:  87%|████████▋ | 13/15 [03:54<00:32, 16.48s/it]ELBO: -830755.1:  87%|████████▋ | 13/15 [04:11<00:32, 16.48s/it]ELBO: -830755.1:  93%|█████████▎| 14/15 [04:11<00:16, 16.45s/it]ELBO: -830812.0:  93%|█████████▎| 14/15 [04:27<00:16, 16.45s/it]ELBO: -830812.0: 100%|██████████| 15/15 [04:27<00:00, 16.44s/it]ELBO: -830812.0: 100%|██████████| 15/15 [04:27<00:00, 17.84s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -6134268.8:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -834446.7:   0%|          | 0/15 [00:44<?, ?it/s] ELBO: -834446.7:   7%|▋         | 1/15 [00:44<10:18, 44.17s/it]ELBO: -833797.2:   7%|▋         | 1/15 [01:00<10:18, 44.17s/it]ELBO: -833797.2:  13%|█▎        | 2/15 [01:00<06:02, 27.86s/it]ELBO: -834280.2:  13%|█▎        | 2/15 [01:16<06:02, 27.86s/it]ELBO: -834280.2:  20%|██        | 3/15 [01:16<04:31, 22.61s/it]ELBO: -834259.1:  20%|██        | 3/15 [01:33<04:31, 22.61s/it]ELBO: -834259.1:  27%|██▋       | 4/15 [01:33<03:41, 20.15s/it]ELBO: -833855.6:  27%|██▋       | 4/15 [01:49<03:41, 20.15s/it]ELBO: -833855.6:  33%|███▎      | 5/15 [01:49<03:08, 18.80s/it]ELBO: -834249.0:  33%|███▎      | 5/15 [02:06<03:08, 18.80s/it]ELBO: -834249.0:  40%|████      | 6/15 [02:06<02:41, 17.97s/it]ELBO: -833515.0:  40%|████      | 6/15 [02:22<02:41, 17.97s/it]ELBO: -833515.0:  47%|████▋     | 7/15 [02:22<02:19, 17.46s/it]ELBO: -833676.5:  47%|████▋     | 7/15 [02:38<02:19, 17.46s/it]ELBO: -833676.5:  53%|█████▎    | 8/15 [02:38<01:59, 17.12s/it]ELBO: -833809.8:  53%|█████▎    | 8/15 [02:55<01:59, 17.12s/it]ELBO: -833809.8:  60%|██████    | 9/15 [02:55<01:41, 16.89s/it]ELBO: -833763.9:  60%|██████    | 9/15 [03:11<01:41, 16.89s/it]ELBO: -833763.9:  67%|██████▋   | 10/15 [03:11<01:23, 16.72s/it]ELBO: -834389.4:  67%|██████▋   | 10/15 [03:28<01:23, 16.72s/it]ELBO: -834389.4:  73%|███████▎  | 11/15 [03:28<01:06, 16.67s/it]ELBO: -833790.2:  73%|███████▎  | 11/15 [03:44<01:06, 16.67s/it]ELBO: -833790.2:  80%|████████  | 12/15 [03:44<00:49, 16.60s/it]ELBO: -833848.0:  80%|████████  | 12/15 [04:01<00:49, 16.60s/it]ELBO: -833848.0:  87%|████████▋ | 13/15 [04:01<00:33, 16.53s/it]ELBO: -833898.3:  87%|████████▋ | 13/15 [04:17<00:33, 16.53s/it]ELBO: -833898.3:  93%|█████████▎| 14/15 [04:17<00:16, 16.52s/it]ELBO: -834064.8:  93%|█████████▎| 14/15 [04:33<00:16, 16.52s/it]ELBO: -834064.8: 100%|██████████| 15/15 [04:33<00:00, 16.48s/it]ELBO: -834064.8: 100%|██████████| 15/15 [04:33<00:00, 18.26s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -5155279.8:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -896223.1:   0%|          | 0/15 [00:44<?, ?it/s] ELBO: -896223.1:   7%|▋         | 1/15 [00:44<10:27, 44.81s/it]ELBO: -896376.6:   7%|▋         | 1/15 [01:01<10:27, 44.81s/it]ELBO: -896376.6:  13%|█▎        | 2/15 [01:01<06:06, 28.17s/it]ELBO: -896818.5:  13%|█▎        | 2/15 [01:17<06:06, 28.17s/it]ELBO: -896818.5:  20%|██        | 3/15 [01:17<04:33, 22.78s/it]ELBO: -895988.3:  20%|██        | 3/15 [01:34<04:33, 22.78s/it]ELBO: -895988.3:  27%|██▋       | 4/15 [01:34<03:42, 20.26s/it]ELBO: -896450.2:  27%|██▋       | 4/15 [01:50<03:42, 20.26s/it]ELBO: -896450.2:  33%|███▎      | 5/15 [01:50<03:08, 18.89s/it]ELBO: -895970.4:  33%|███▎      | 5/15 [02:06<03:08, 18.89s/it]ELBO: -895970.4:  40%|████      | 6/15 [02:06<02:42, 18.05s/it]ELBO: -895635.3:  40%|████      | 6/15 [02:23<02:42, 18.05s/it]ELBO: -895635.3:  47%|████▋     | 7/15 [02:23<02:19, 17.50s/it]ELBO: -895751.6:  47%|████▋     | 7/15 [02:39<02:19, 17.50s/it]ELBO: -895751.6:  53%|█████▎    | 8/15 [02:39<02:00, 17.18s/it]ELBO: -896003.7:  53%|█████▎    | 8/15 [02:56<02:00, 17.18s/it]ELBO: -896003.7:  60%|██████    | 9/15 [02:56<01:41, 16.97s/it]ELBO: -896527.9:  60%|██████    | 9/15 [03:12<01:41, 16.97s/it]ELBO: -896527.9:  67%|██████▋   | 10/15 [03:12<01:23, 16.77s/it]ELBO: -896217.9:  67%|██████▋   | 10/15 [03:29<01:23, 16.77s/it]ELBO: -896217.9:  73%|███████▎  | 11/15 [03:29<01:06, 16.66s/it]ELBO: -895995.5:  73%|███████▎  | 11/15 [03:45<01:06, 16.66s/it]ELBO: -895995.5:  80%|████████  | 12/15 [03:45<00:49, 16.61s/it]ELBO: -895652.5:  80%|████████  | 12/15 [04:01<00:49, 16.61s/it]ELBO: -895652.5:  87%|████████▋ | 13/15 [04:01<00:33, 16.53s/it]ELBO: -896554.1:  87%|████████▋ | 13/15 [04:18<00:33, 16.53s/it]ELBO: -896554.1:  93%|█████████▎| 14/15 [04:18<00:16, 16.51s/it]ELBO: -895821.4:  93%|█████████▎| 14/15 [04:34<00:16, 16.51s/it]ELBO: -895821.4: 100%|██████████| 15/15 [04:34<00:00, 16.49s/it]ELBO: -895821.4: 100%|██████████| 15/15 [04:34<00:00, 18.32s/it]
