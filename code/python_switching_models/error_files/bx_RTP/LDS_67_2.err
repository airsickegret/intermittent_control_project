Processed spikes from trial 100.
Processed spikes from trial 200.
Processed spikes from trial 300.
  0%|          | 0/1 [00:00<?, ?it/s]ARHMM Initialization restarts:   0%|          | 0/1 [00:00<?, ?it/s]Initializing with an ARHMM using 25 steps of EM.

  0%|          | 0/25 [00:00<?, ?it/s][A
LP: -4933603.7:   0%|          | 0/25 [00:00<?, ?it/s][A
LP: -4933603.7:   0%|          | 0/25 [00:01<?, ?it/s][A
LP: -4933603.7:   4%|▍         | 1/25 [00:01<00:43,  1.81s/it][A
LP: -4933603.7:   4%|▍         | 1/25 [00:03<00:43,  1.81s/it][A
LP: -4933603.7:   8%|▊         | 2/25 [00:03<00:39,  1.74s/it][A
LP: -4933603.7:   8%|▊         | 2/25 [00:05<00:39,  1.74s/it][A
LP: -4933603.7:  12%|█▏        | 3/25 [00:05<00:38,  1.77s/it][A
LP: -4933603.7:  12%|█▏        | 3/25 [00:06<00:38,  1.77s/it][A
LP: -4933603.7:  16%|█▌        | 4/25 [00:06<00:36,  1.74s/it][A
LP: -4933603.7:  16%|█▌        | 4/25 [00:08<00:36,  1.74s/it][A
LP: -4933603.7:  20%|██        | 5/25 [00:08<00:35,  1.76s/it][A
LP: -4933603.7:  20%|██        | 5/25 [00:10<00:35,  1.76s/it][A
LP: -4933603.7:  24%|██▍       | 6/25 [00:10<00:32,  1.74s/it][A
LP: -4933603.7:  24%|██▍       | 6/25 [00:12<00:32,  1.74s/it][A
LP: -4933603.7:  28%|██▊       | 7/25 [00:12<00:31,  1.76s/it][A
LP: -4933603.7:  28%|██▊       | 7/25 [00:13<00:31,  1.76s/it][A
LP: -4933603.7:  32%|███▏      | 8/25 [00:13<00:29,  1.74s/it][A
LP: -4933603.7:  32%|███▏      | 8/25 [00:15<00:29,  1.74s/it][A
LP: -4933603.7:  36%|███▌      | 9/25 [00:15<00:27,  1.72s/it][A
LP: -4933603.7:  36%|███▌      | 9/25 [00:17<00:27,  1.72s/it][A
LP: -4933603.7:  40%|████      | 10/25 [00:17<00:25,  1.71s/it][A
LP: -4933603.7:  40%|████      | 10/25 [00:19<00:25,  1.71s/it][A
LP: -4933603.7:  44%|████▍     | 11/25 [00:19<00:24,  1.74s/it][A
LP: -4933603.7:  44%|████▍     | 11/25 [00:20<00:24,  1.74s/it][A
LP: -4933603.7:  48%|████▊     | 12/25 [00:20<00:22,  1.73s/it][A
LP: -4933603.7:  48%|████▊     | 12/25 [00:22<00:22,  1.73s/it][A
LP: -4933603.7:  52%|█████▏    | 13/25 [00:22<00:20,  1.72s/it][A
LP: -4933603.7:  52%|█████▏    | 13/25 [00:24<00:20,  1.72s/it][A
LP: -4933603.7:  56%|█████▌    | 14/25 [00:24<00:18,  1.71s/it][A
LP: -4933603.7:  56%|█████▌    | 14/25 [00:25<00:18,  1.71s/it][A
LP: -4933603.7:  60%|██████    | 15/25 [00:25<00:17,  1.71s/it][A
LP: -4933603.7:  60%|██████    | 15/25 [00:27<00:17,  1.71s/it][A
LP: -4933603.7:  64%|██████▍   | 16/25 [00:27<00:15,  1.74s/it][A
LP: -4933603.7:  64%|██████▍   | 16/25 [00:29<00:15,  1.74s/it][A
LP: -4933603.7:  68%|██████▊   | 17/25 [00:29<00:14,  1.76s/it][A
LP: -4933603.7:  68%|██████▊   | 17/25 [00:31<00:14,  1.76s/it][A
LP: -4933603.7:  72%|███████▏  | 18/25 [00:31<00:12,  1.77s/it][A
LP: -4933603.7:  72%|███████▏  | 18/25 [00:33<00:12,  1.77s/it][A
LP: -4933603.7:  76%|███████▌  | 19/25 [00:33<00:10,  1.78s/it][A
LP: -4933603.7:  76%|███████▌  | 19/25 [00:34<00:10,  1.78s/it][A
LP: -4933603.7:  80%|████████  | 20/25 [00:34<00:08,  1.79s/it][A
LP: -4933603.7:  80%|████████  | 20/25 [00:36<00:08,  1.79s/it][A
LP: -4933603.7:  84%|████████▍ | 21/25 [00:36<00:07,  1.79s/it][A
LP: -4933603.7:  84%|████████▍ | 21/25 [00:38<00:07,  1.79s/it][A
LP: -4933603.7:  88%|████████▊ | 22/25 [00:38<00:05,  1.80s/it][A
LP: -4933603.7:  88%|████████▊ | 22/25 [00:40<00:05,  1.80s/it][A
LP: -4933603.7:  92%|█████████▏| 23/25 [00:40<00:03,  1.80s/it][A
LP: -4933603.7:  92%|█████████▏| 23/25 [00:42<00:03,  1.80s/it][A
LP: -4933603.7:  96%|█████████▌| 24/25 [00:42<00:01,  1.80s/it][A
LP: -4933603.7:  96%|█████████▌| 24/25 [00:44<00:01,  1.80s/it][A
LP: -4933603.7: 100%|██████████| 25/25 [00:44<00:00,  1.80s/it][ALP: -4933603.7: 100%|██████████| 25/25 [00:44<00:00,  1.76s/it]
ARHMM Initialization restarts: 100%|██████████| 1/1 [00:46<00:00, 46.06s/it]ARHMM Initialization restarts: 100%|██████████| 1/1 [00:46<00:00, 46.06s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -10586460.5:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -4616436.2:   0%|          | 0/15 [06:56<?, ?it/s] ELBO: -4616436.2:   7%|▋         | 1/15 [06:56<1:37:11, 416.50s/it]ELBO: -4548146.7:   7%|▋         | 1/15 [12:28<1:37:11, 416.50s/it]ELBO: -4548146.7:  13%|█▎        | 2/15 [12:28<1:19:31, 367.05s/it]ELBO: -4520386.2:  13%|█▎        | 2/15 [17:31<1:19:31, 367.05s/it]ELBO: -4520386.2:  20%|██        | 3/15 [17:31<1:07:33, 337.77s/it]ELBO: -4503938.7:  20%|██        | 3/15 [22:37<1:07:33, 337.77s/it]ELBO: -4503938.7:  27%|██▋       | 4/15 [22:37<59:37, 325.20s/it]  ELBO: -4486144.1:  27%|██▋       | 4/15 [27:44<59:37, 325.20s/it]ELBO: -4486144.1:  33%|███▎      | 5/15 [27:44<53:06, 318.68s/it]ELBO: -4477472.7:  33%|███▎      | 5/15 [32:53<53:06, 318.68s/it]ELBO: -4477472.7:  40%|████      | 6/15 [32:53<47:17, 315.33s/it]ELBO: -4473421.6:  40%|████      | 6/15 [38:00<47:17, 315.33s/it]ELBO: -4473421.6:  47%|████▋     | 7/15 [38:00<41:40, 312.59s/it]ELBO: -4467390.7:  47%|████▋     | 7/15 [43:08<41:40, 312.59s/it]ELBO: -4467390.7:  53%|█████▎    | 8/15 [43:08<36:17, 311.11s/it]ELBO: -4462745.0:  53%|█████▎    | 8/15 [48:10<36:17, 311.11s/it]ELBO: -4462745.0:  60%|██████    | 9/15 [48:10<30:48, 308.10s/it]ELBO: -4460249.2:  60%|██████    | 9/15 [53:14<30:48, 308.10s/it]ELBO: -4460249.2:  67%|██████▋   | 10/15 [53:14<25:34, 306.91s/it]ELBO: -4455097.4:  67%|██████▋   | 10/15 [58:18<25:34, 306.91s/it]ELBO: -4455097.4:  73%|███████▎  | 11/15 [58:18<20:24, 306.09s/it]ELBO: -4454222.7:  73%|███████▎  | 11/15 [1:03:23<20:24, 306.09s/it]ELBO: -4454222.7:  80%|████████  | 12/15 [1:03:23<15:17, 305.71s/it]ELBO: -4451268.6:  80%|████████  | 12/15 [1:08:27<15:17, 305.71s/it]ELBO: -4451268.6:  87%|████████▋ | 13/15 [1:08:27<10:10, 305.09s/it]ELBO: -4449454.5:  87%|████████▋ | 13/15 [1:13:26<10:10, 305.09s/it]ELBO: -4449454.5:  93%|█████████▎| 14/15 [1:13:26<05:03, 303.50s/it]ELBO: -4445851.1:  93%|█████████▎| 14/15 [1:18:30<05:03, 303.50s/it]ELBO: -4445851.1: 100%|██████████| 15/15 [1:18:30<00:00, 303.47s/it]ELBO: -4445851.1: 100%|██████████| 15/15 [1:18:30<00:00, 314.02s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -18620668.5:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -863283.3:   0%|          | 0/15 [02:00<?, ?it/s]  ELBO: -863283.3:   7%|▋         | 1/15 [02:00<28:12, 120.89s/it]ELBO: -863125.5:   7%|▋         | 1/15 [02:47<28:12, 120.89s/it]ELBO: -863125.5:  13%|█▎        | 2/15 [02:47<16:40, 76.98s/it] ELBO: -862919.6:  13%|█▎        | 2/15 [03:33<16:40, 76.98s/it]ELBO: -862919.6:  20%|██        | 3/15 [03:33<12:34, 62.89s/it]ELBO: -862660.7:  20%|██        | 3/15 [04:19<12:34, 62.89s/it]ELBO: -862660.7:  27%|██▋       | 4/15 [04:19<10:20, 56.42s/it]ELBO: -863128.7:  27%|██▋       | 4/15 [05:06<10:20, 56.42s/it]ELBO: -863128.7:  33%|███▎      | 5/15 [05:06<08:47, 52.78s/it]ELBO: -862651.3:  33%|███▎      | 5/15 [05:51<08:47, 52.78s/it]ELBO: -862651.3:  40%|████      | 6/15 [05:51<07:33, 50.37s/it]ELBO: -862343.7:  40%|████      | 6/15 [06:38<07:33, 50.37s/it]ELBO: -862343.7:  47%|████▋     | 7/15 [06:38<06:32, 49.11s/it]ELBO: -863145.9:  47%|████▋     | 7/15 [07:24<06:32, 49.11s/it]ELBO: -863145.9:  53%|█████▎    | 8/15 [07:24<05:37, 48.16s/it]ELBO: -863497.8:  53%|█████▎    | 8/15 [08:10<05:37, 48.16s/it]ELBO: -863497.8:  60%|██████    | 9/15 [08:10<04:44, 47.49s/it]ELBO: -863114.5:  60%|██████    | 9/15 [08:56<04:44, 47.49s/it]ELBO: -863114.5:  67%|██████▋   | 10/15 [08:56<03:55, 47.13s/it]ELBO: -864230.2:  67%|██████▋   | 10/15 [09:42<03:55, 47.13s/it]ELBO: -864230.2:  73%|███████▎  | 11/15 [09:42<03:07, 46.82s/it]ELBO: -863943.6:  73%|███████▎  | 11/15 [10:29<03:07, 46.82s/it]ELBO: -863943.6:  80%|████████  | 12/15 [10:29<02:19, 46.64s/it]ELBO: -863446.5:  80%|████████  | 12/15 [11:15<02:19, 46.64s/it]ELBO: -863446.5:  87%|████████▋ | 13/15 [11:15<01:32, 46.49s/it]ELBO: -863647.0:  87%|████████▋ | 13/15 [12:01<01:32, 46.49s/it]ELBO: -863647.0:  93%|█████████▎| 14/15 [12:01<00:46, 46.34s/it]ELBO: -864159.4:  93%|█████████▎| 14/15 [12:47<00:46, 46.34s/it]ELBO: -864159.4: 100%|██████████| 15/15 [12:47<00:00, 46.30s/it]ELBO: -864159.4: 100%|██████████| 15/15 [12:47<00:00, 51.16s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -18439973.6:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -783873.5:   0%|          | 0/15 [02:04<?, ?it/s]  ELBO: -783873.5:   7%|▋         | 1/15 [02:04<29:02, 124.49s/it]ELBO: -784633.8:   7%|▋         | 1/15 [02:51<29:02, 124.49s/it]ELBO: -784633.8:  13%|█▎        | 2/15 [02:51<17:05, 78.85s/it] ELBO: -782736.0:  13%|█▎        | 2/15 [03:37<17:05, 78.85s/it]ELBO: -782736.0:  20%|██        | 3/15 [03:37<12:48, 64.08s/it]ELBO: -783760.0:  20%|██        | 3/15 [04:24<12:48, 64.08s/it]ELBO: -783760.0:  27%|██▋       | 4/15 [04:24<10:28, 57.11s/it]ELBO: -784108.5:  27%|██▋       | 4/15 [05:11<10:28, 57.11s/it]ELBO: -784108.5:  33%|███▎      | 5/15 [05:11<08:54, 53.44s/it]ELBO: -784468.5:  33%|███▎      | 5/15 [05:57<08:54, 53.44s/it]ELBO: -784468.5:  40%|████      | 6/15 [05:57<07:37, 50.88s/it]ELBO: -784085.3:  40%|████      | 6/15 [06:43<07:37, 50.88s/it]ELBO: -784085.3:  47%|████▋     | 7/15 [06:43<06:36, 49.52s/it]ELBO: -784027.6:  47%|████▋     | 7/15 [07:29<06:36, 49.52s/it]ELBO: -784027.6:  53%|█████▎    | 8/15 [07:29<05:39, 48.44s/it]ELBO: -784681.7:  53%|█████▎    | 8/15 [08:16<05:39, 48.44s/it]ELBO: -784681.7:  60%|██████    | 9/15 [08:16<04:46, 47.73s/it]ELBO: -783484.7:  60%|██████    | 9/15 [09:02<04:46, 47.73s/it]ELBO: -783484.7:  67%|██████▋   | 10/15 [09:02<03:56, 47.28s/it]ELBO: -783934.9:  67%|██████▋   | 10/15 [09:49<03:56, 47.28s/it]ELBO: -783934.9:  73%|███████▎  | 11/15 [09:49<03:08, 47.07s/it]ELBO: -783841.1:  73%|███████▎  | 11/15 [10:35<03:08, 47.07s/it]ELBO: -783841.1:  80%|████████  | 12/15 [10:35<02:20, 46.74s/it]ELBO: -783119.4:  80%|████████  | 12/15 [11:21<02:20, 46.74s/it]ELBO: -783119.4:  87%|████████▋ | 13/15 [11:21<01:33, 46.62s/it]ELBO: -783807.3:  87%|████████▋ | 13/15 [12:07<01:33, 46.62s/it]ELBO: -783807.3:  93%|█████████▎| 14/15 [12:07<00:46, 46.54s/it]ELBO: -783935.9:  93%|█████████▎| 14/15 [12:53<00:46, 46.54s/it]ELBO: -783935.9: 100%|██████████| 15/15 [12:53<00:00, 46.39s/it]ELBO: -783935.9: 100%|██████████| 15/15 [12:53<00:00, 51.58s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -18578304.9:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -785546.0:   0%|          | 0/15 [02:03<?, ?it/s]  ELBO: -785546.0:   7%|▋         | 1/15 [02:03<28:46, 123.30s/it]ELBO: -785777.0:   7%|▋         | 1/15 [02:49<28:46, 123.30s/it]ELBO: -785777.0:  13%|█▎        | 2/15 [02:49<16:55, 78.14s/it] ELBO: -784695.5:  13%|█▎        | 2/15 [03:35<16:55, 78.14s/it]ELBO: -784695.5:  20%|██        | 3/15 [03:35<12:41, 63.47s/it]ELBO: -784830.2:  20%|██        | 3/15 [04:22<12:41, 63.47s/it]ELBO: -784830.2:  27%|██▋       | 4/15 [04:22<10:23, 56.71s/it]ELBO: -785899.0:  27%|██▋       | 4/15 [05:08<10:23, 56.71s/it]ELBO: -785899.0:  33%|███▎      | 5/15 [05:08<08:49, 52.98s/it]ELBO: -785908.2:  33%|███▎      | 5/15 [05:54<08:49, 52.98s/it]ELBO: -785908.2:  40%|████      | 6/15 [05:54<07:35, 50.64s/it]ELBO: -784737.8:  40%|████      | 6/15 [06:40<07:35, 50.64s/it]ELBO: -784737.8:  47%|████▋     | 7/15 [06:40<06:33, 49.21s/it]ELBO: -785249.5:  47%|████▋     | 7/15 [07:27<06:33, 49.21s/it]ELBO: -785249.5:  53%|█████▎    | 8/15 [07:27<05:38, 48.29s/it]ELBO: -784882.2:  53%|█████▎    | 8/15 [08:13<05:38, 48.29s/it]ELBO: -784882.2:  60%|██████    | 9/15 [08:13<04:46, 47.78s/it]ELBO: -784913.3:  60%|██████    | 9/15 [09:00<04:46, 47.78s/it]ELBO: -784913.3:  67%|██████▋   | 10/15 [09:00<03:56, 47.37s/it]ELBO: -786020.8:  67%|██████▋   | 10/15 [09:46<03:56, 47.37s/it]ELBO: -786020.8:  73%|███████▎  | 11/15 [09:46<03:07, 46.97s/it]ELBO: -783744.2:  73%|███████▎  | 11/15 [10:32<03:07, 46.97s/it]ELBO: -783744.2:  80%|████████  | 12/15 [10:32<02:20, 46.75s/it]ELBO: -785801.8:  80%|████████  | 12/15 [11:18<02:20, 46.75s/it]ELBO: -785801.8:  87%|████████▋ | 13/15 [11:18<01:33, 46.61s/it]ELBO: -784834.1:  87%|████████▋ | 13/15 [12:05<01:33, 46.61s/it]ELBO: -784834.1:  93%|█████████▎| 14/15 [12:05<00:46, 46.56s/it]ELBO: -785703.6:  93%|█████████▎| 14/15 [12:52<00:46, 46.56s/it]ELBO: -785703.6: 100%|██████████| 15/15 [12:52<00:00, 46.64s/it]ELBO: -785703.6: 100%|██████████| 15/15 [12:52<00:00, 51.48s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -19652278.2:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -883988.2:   0%|          | 0/15 [02:14<?, ?it/s]  ELBO: -883988.2:   7%|▋         | 1/15 [02:14<31:18, 134.19s/it]ELBO: -883833.3:   7%|▋         | 1/15 [03:00<31:18, 134.19s/it]ELBO: -883833.3:  13%|█▎        | 2/15 [03:00<17:52, 82.53s/it] ELBO: -883880.8:  13%|█▎        | 2/15 [03:46<17:52, 82.53s/it]ELBO: -883880.8:  20%|██        | 3/15 [03:46<13:11, 65.99s/it]ELBO: -884379.4:  20%|██        | 3/15 [04:33<13:11, 65.99s/it]ELBO: -884379.4:  27%|██▋       | 4/15 [04:33<10:41, 58.30s/it]ELBO: -883732.5:  27%|██▋       | 4/15 [05:19<10:41, 58.30s/it]ELBO: -883732.5:  33%|███▎      | 5/15 [05:19<08:59, 53.98s/it]ELBO: -884792.8:  33%|███▎      | 5/15 [06:05<08:59, 53.98s/it]ELBO: -884792.8:  40%|████      | 6/15 [06:05<07:42, 51.36s/it]ELBO: -884277.6:  40%|████      | 6/15 [06:52<07:42, 51.36s/it]ELBO: -884277.6:  47%|████▋     | 7/15 [06:52<06:38, 49.84s/it]ELBO: -885102.7:  47%|████▋     | 7/15 [07:39<06:38, 49.84s/it]ELBO: -885102.7:  53%|█████▎    | 8/15 [07:39<05:41, 48.72s/it]ELBO: -884450.2:  53%|█████▎    | 8/15 [08:25<05:41, 48.72s/it]ELBO: -884450.2:  60%|██████    | 9/15 [08:25<04:47, 47.87s/it]ELBO: -884476.8:  60%|██████    | 9/15 [09:11<04:47, 47.87s/it]ELBO: -884476.8:  67%|██████▋   | 10/15 [09:11<03:57, 47.42s/it]ELBO: -884109.0:  67%|██████▋   | 10/15 [09:57<03:57, 47.42s/it]ELBO: -884109.0:  73%|███████▎  | 11/15 [09:57<03:08, 47.08s/it]ELBO: -884147.9:  73%|███████▎  | 11/15 [10:43<03:08, 47.08s/it]ELBO: -884147.9:  80%|████████  | 12/15 [10:43<02:20, 46.77s/it]ELBO: -884935.8:  80%|████████  | 12/15 [11:30<02:20, 46.77s/it]ELBO: -884935.8:  87%|████████▋ | 13/15 [11:30<01:33, 46.66s/it]ELBO: -884546.1:  87%|████████▋ | 13/15 [12:16<01:33, 46.66s/it]ELBO: -884546.1:  93%|█████████▎| 14/15 [12:16<00:46, 46.59s/it]ELBO: -883921.7:  93%|█████████▎| 14/15 [13:02<00:46, 46.59s/it]ELBO: -883921.7: 100%|██████████| 15/15 [13:02<00:00, 46.49s/it]ELBO: -883921.7: 100%|██████████| 15/15 [13:02<00:00, 52.19s/it]
