Processed spikes from trial 100.
Processed spikes from trial 200.
Processed spikes from trial 300.
  0%|          | 0/1 [00:00<?, ?it/s]ARHMM Initialization restarts:   0%|          | 0/1 [00:00<?, ?it/s]Initializing with an ARHMM using 25 steps of EM.

  0%|          | 0/25 [00:00<?, ?it/s][A
LP: -2615590.8:   0%|          | 0/25 [00:00<?, ?it/s][A
LP: -2615590.8:   0%|          | 0/25 [00:00<?, ?it/s][A
LP: -2615590.8:   4%|▍         | 1/25 [00:00<00:15,  1.58it/s][A
LP: -2615590.8:   4%|▍         | 1/25 [00:01<00:15,  1.58it/s][A
LP: -2615590.8:   8%|▊         | 2/25 [00:01<00:14,  1.56it/s][A
LP: -2615590.8:   8%|▊         | 2/25 [00:01<00:14,  1.56it/s][A
LP: -2615590.8:  12%|█▏        | 3/25 [00:01<00:14,  1.56it/s][A
LP: -2615590.8:  12%|█▏        | 3/25 [00:02<00:14,  1.56it/s][A
LP: -2615590.8:  16%|█▌        | 4/25 [00:02<00:13,  1.56it/s][A
LP: -2615590.8:  16%|█▌        | 4/25 [00:03<00:13,  1.56it/s][A
LP: -2615590.8:  20%|██        | 5/25 [00:03<00:12,  1.56it/s][A
LP: -2615590.8:  20%|██        | 5/25 [00:03<00:12,  1.56it/s][A
LP: -2615590.8:  24%|██▍       | 6/25 [00:03<00:12,  1.57it/s][A
LP: -2615590.8:  24%|██▍       | 6/25 [00:04<00:12,  1.57it/s][A
LP: -2615590.8:  28%|██▊       | 7/25 [00:04<00:11,  1.57it/s][A
LP: -2615590.8:  28%|██▊       | 7/25 [00:05<00:11,  1.57it/s][A
LP: -2615590.8:  32%|███▏      | 8/25 [00:05<00:10,  1.58it/s][A
LP: -2615590.8:  32%|███▏      | 8/25 [00:05<00:10,  1.58it/s][A
LP: -2615590.8:  36%|███▌      | 9/25 [00:05<00:10,  1.58it/s][A
LP: -2615590.8:  36%|███▌      | 9/25 [00:06<00:10,  1.58it/s][A
LP: -2615590.8:  40%|████      | 10/25 [00:06<00:09,  1.58it/s][A
LP: -2615590.8:  40%|████      | 10/25 [00:06<00:09,  1.58it/s][A
LP: -2615590.8:  44%|████▍     | 11/25 [00:06<00:08,  1.58it/s][A
LP: -2615590.8:  44%|████▍     | 11/25 [00:07<00:08,  1.58it/s][A
LP: -2615590.8:  48%|████▊     | 12/25 [00:07<00:08,  1.58it/s][A
LP: -2615590.8:  48%|████▊     | 12/25 [00:08<00:08,  1.58it/s][A
LP: -2615590.8:  52%|█████▏    | 13/25 [00:08<00:07,  1.57it/s][A
LP: -2615590.8:  52%|█████▏    | 13/25 [00:08<00:07,  1.57it/s][A
LP: -2615590.8:  56%|█████▌    | 14/25 [00:08<00:07,  1.57it/s][A
LP: -2615590.8:  56%|█████▌    | 14/25 [00:09<00:07,  1.57it/s][A
LP: -2615590.8:  60%|██████    | 15/25 [00:09<00:06,  1.57it/s][A
LP: -2615590.8:  60%|██████    | 15/25 [00:10<00:06,  1.57it/s][A
LP: -2615590.8:  64%|██████▍   | 16/25 [00:10<00:05,  1.57it/s][A
LP: -2615590.8:  64%|██████▍   | 16/25 [00:10<00:05,  1.57it/s][A
LP: -2615590.8:  68%|██████▊   | 17/25 [00:10<00:05,  1.58it/s][A
LP: -2615590.8:  68%|██████▊   | 17/25 [00:11<00:05,  1.58it/s][A
LP: -2615590.8:  72%|███████▏  | 18/25 [00:11<00:04,  1.59it/s][A
LP: -2615590.8:  72%|███████▏  | 18/25 [00:12<00:04,  1.59it/s][A
LP: -2615590.8:  76%|███████▌  | 19/25 [00:12<00:03,  1.58it/s][A
LP: -2615590.8:  76%|███████▌  | 19/25 [00:12<00:03,  1.58it/s][A
LP: -2615590.8:  80%|████████  | 20/25 [00:12<00:03,  1.58it/s][A
LP: -2615590.8:  80%|████████  | 20/25 [00:13<00:03,  1.58it/s][A
LP: -2615590.8:  84%|████████▍ | 21/25 [00:13<00:02,  1.58it/s][A
LP: -2615590.8:  84%|████████▍ | 21/25 [00:13<00:02,  1.58it/s][A
LP: -2615590.8:  88%|████████▊ | 22/25 [00:13<00:01,  1.58it/s][A
LP: -2615590.8:  88%|████████▊ | 22/25 [00:14<00:01,  1.58it/s][A
LP: -2615590.8:  92%|█████████▏| 23/25 [00:14<00:01,  1.58it/s][A
LP: -2615590.8:  92%|█████████▏| 23/25 [00:15<00:01,  1.58it/s][A
LP: -2615590.8:  96%|█████████▌| 24/25 [00:15<00:00,  1.55it/s][A
LP: -2615590.8:  96%|█████████▌| 24/25 [00:15<00:00,  1.55it/s][A
LP: -2615590.8: 100%|██████████| 25/25 [00:15<00:00,  1.56it/s][ALP: -2615590.8: 100%|██████████| 25/25 [00:15<00:00,  1.57it/s]
ARHMM Initialization restarts: 100%|██████████| 1/1 [00:16<00:00, 16.76s/it]ARHMM Initialization restarts: 100%|██████████| 1/1 [00:16<00:00, 16.76s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -7611414.4:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -4530357.2:   0%|          | 0/15 [02:25<?, ?it/s]ELBO: -4530357.2:   7%|▋         | 1/15 [02:25<33:53, 145.22s/it]ELBO: -4483791.3:   7%|▋         | 1/15 [04:12<33:53, 145.22s/it]ELBO: -4483791.3:  13%|█▎        | 2/15 [04:12<26:35, 122.75s/it]ELBO: -4463113.8:  13%|█▎        | 2/15 [05:43<26:35, 122.75s/it]ELBO: -4463113.8:  20%|██        | 3/15 [05:43<21:39, 108.26s/it]ELBO: -4454346.3:  20%|██        | 3/15 [07:14<21:39, 108.26s/it]ELBO: -4454346.3:  27%|██▋       | 4/15 [07:14<18:35, 101.44s/it]ELBO: -4444575.1:  27%|██▋       | 4/15 [08:42<18:35, 101.44s/it]ELBO: -4444575.1:  33%|███▎      | 5/15 [08:42<16:06, 96.64s/it] ELBO: -4435499.3:  33%|███▎      | 5/15 [10:10<16:06, 96.64s/it]ELBO: -4435499.3:  40%|████      | 6/15 [10:10<14:04, 93.89s/it]ELBO: -4432384.2:  40%|████      | 6/15 [11:37<14:04, 93.89s/it]ELBO: -4432384.2:  47%|████▋     | 7/15 [11:37<12:11, 91.42s/it]ELBO: -4429341.5:  47%|████▋     | 7/15 [13:03<12:11, 91.42s/it]ELBO: -4429341.5:  53%|█████▎    | 8/15 [13:03<10:29, 89.89s/it]ELBO: -4424290.7:  53%|█████▎    | 8/15 [14:30<10:29, 89.89s/it]ELBO: -4424290.7:  60%|██████    | 9/15 [14:30<08:52, 88.80s/it]ELBO: -4421907.2:  60%|██████    | 9/15 [15:56<08:52, 88.80s/it]ELBO: -4421907.2:  67%|██████▋   | 10/15 [15:56<07:19, 87.90s/it]ELBO: -4418207.0:  67%|██████▋   | 10/15 [17:22<07:19, 87.90s/it]ELBO: -4418207.0:  73%|███████▎  | 11/15 [17:22<05:50, 87.53s/it]ELBO: -4417733.9:  73%|███████▎  | 11/15 [18:49<05:50, 87.53s/it]ELBO: -4417733.9:  80%|████████  | 12/15 [18:49<04:21, 87.25s/it]ELBO: -4413835.5:  80%|████████  | 12/15 [20:10<04:21, 87.25s/it]ELBO: -4413835.5:  87%|████████▋ | 13/15 [20:10<02:50, 85.43s/it]ELBO: -4414038.8:  87%|████████▋ | 13/15 [21:34<02:50, 85.43s/it]ELBO: -4414038.8:  93%|█████████▎| 14/15 [21:34<01:24, 84.85s/it]ELBO: -4412581.1:  93%|█████████▎| 14/15 [22:58<01:24, 84.85s/it]ELBO: -4412581.1: 100%|██████████| 15/15 [22:58<00:00, 84.57s/it]ELBO: -4412581.1: 100%|██████████| 15/15 [22:58<00:00, 91.88s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -3496115.0:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -839684.9:   0%|          | 0/15 [00:31<?, ?it/s] ELBO: -839684.9:   7%|▋         | 1/15 [00:31<07:24, 31.78s/it]ELBO: -838767.0:   7%|▋         | 1/15 [00:43<07:24, 31.78s/it]ELBO: -838767.0:  13%|█▎        | 2/15 [00:43<04:21, 20.14s/it]ELBO: -840060.3:  13%|█▎        | 2/15 [00:55<04:21, 20.14s/it]ELBO: -840060.3:  20%|██        | 3/15 [00:55<03:17, 16.45s/it]ELBO: -840083.2:  20%|██        | 3/15 [01:07<03:17, 16.45s/it]ELBO: -840083.2:  27%|██▋       | 4/15 [01:07<02:41, 14.71s/it]ELBO: -840099.4:  27%|██▋       | 4/15 [01:19<02:41, 14.71s/it]ELBO: -840099.4:  33%|███▎      | 5/15 [01:19<02:17, 13.73s/it]ELBO: -839822.9:  33%|███▎      | 5/15 [01:31<02:17, 13.73s/it]ELBO: -839822.9:  40%|████      | 6/15 [01:31<01:58, 13.15s/it]ELBO: -840123.6:  40%|████      | 6/15 [01:43<01:58, 13.15s/it]ELBO: -840123.6:  47%|████▋     | 7/15 [01:43<01:42, 12.78s/it]ELBO: -839575.0:  47%|████▋     | 7/15 [01:55<01:42, 12.78s/it]ELBO: -839575.0:  53%|█████▎    | 8/15 [01:55<01:27, 12.54s/it]ELBO: -839821.5:  53%|█████▎    | 8/15 [02:07<01:27, 12.54s/it]ELBO: -839821.5:  60%|██████    | 9/15 [02:07<01:14, 12.38s/it]ELBO: -840143.5:  60%|██████    | 9/15 [02:19<01:14, 12.38s/it]ELBO: -840143.5:  67%|██████▋   | 10/15 [02:19<01:01, 12.27s/it]ELBO: -839701.5:  67%|██████▋   | 10/15 [02:32<01:01, 12.27s/it]ELBO: -839701.5:  73%|███████▎  | 11/15 [02:32<00:48, 12.22s/it]ELBO: -839797.1:  73%|███████▎  | 11/15 [02:44<00:48, 12.22s/it]ELBO: -839797.1:  80%|████████  | 12/15 [02:44<00:36, 12.16s/it]ELBO: -839924.6:  80%|████████  | 12/15 [02:56<00:36, 12.16s/it]ELBO: -839924.6:  87%|████████▋ | 13/15 [02:56<00:24, 12.11s/it]ELBO: -839629.6:  87%|████████▋ | 13/15 [03:08<00:24, 12.11s/it]ELBO: -839629.6:  93%|█████████▎| 14/15 [03:08<00:12, 12.09s/it]ELBO: -839747.5:  93%|█████████▎| 14/15 [03:20<00:12, 12.09s/it]ELBO: -839747.5: 100%|██████████| 15/15 [03:20<00:00, 12.07s/it]ELBO: -839747.5: 100%|██████████| 15/15 [03:20<00:00, 13.34s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -3439819.0:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -828696.9:   0%|          | 0/15 [00:31<?, ?it/s] ELBO: -828696.9:   7%|▋         | 1/15 [00:31<07:17, 31.23s/it]ELBO: -828441.3:   7%|▋         | 1/15 [00:43<07:17, 31.23s/it]ELBO: -828441.3:  13%|█▎        | 2/15 [00:43<04:18, 19.92s/it]ELBO: -828417.2:  13%|█▎        | 2/15 [00:55<04:18, 19.92s/it]ELBO: -828417.2:  20%|██        | 3/15 [00:55<03:15, 16.27s/it]ELBO: -828480.0:  20%|██        | 3/15 [01:07<03:15, 16.27s/it]ELBO: -828480.0:  27%|██▋       | 4/15 [01:07<02:40, 14.56s/it]ELBO: -828252.0:  27%|██▋       | 4/15 [01:19<02:40, 14.56s/it]ELBO: -828252.0:  33%|███▎      | 5/15 [01:19<02:16, 13.62s/it]ELBO: -828808.3:  33%|███▎      | 5/15 [01:31<02:16, 13.62s/it]ELBO: -828808.3:  40%|████      | 6/15 [01:31<01:57, 13.06s/it]ELBO: -829127.0:  40%|████      | 6/15 [01:43<01:57, 13.06s/it]ELBO: -829127.0:  47%|████▋     | 7/15 [01:43<01:41, 12.73s/it]ELBO: -828545.5:  47%|████▋     | 7/15 [01:55<01:41, 12.73s/it]ELBO: -828545.5:  53%|█████▎    | 8/15 [01:55<01:27, 12.50s/it]ELBO: -828191.6:  53%|█████▎    | 8/15 [02:07<01:27, 12.50s/it]ELBO: -828191.6:  60%|██████    | 9/15 [02:07<01:14, 12.36s/it]ELBO: -827998.0:  60%|██████    | 9/15 [02:19<01:14, 12.36s/it]ELBO: -827998.0:  67%|██████▋   | 10/15 [02:19<01:01, 12.25s/it]ELBO: -828433.9:  67%|██████▋   | 10/15 [02:31<01:01, 12.25s/it]ELBO: -828433.9:  73%|███████▎  | 11/15 [02:31<00:48, 12.19s/it]ELBO: -828284.4:  73%|███████▎  | 11/15 [02:43<00:48, 12.19s/it]ELBO: -828284.4:  80%|████████  | 12/15 [02:43<00:36, 12.14s/it]ELBO: -827472.9:  80%|████████  | 12/15 [02:55<00:36, 12.14s/it]ELBO: -827472.9:  87%|████████▋ | 13/15 [02:55<00:24, 12.09s/it]ELBO: -828304.6:  87%|████████▋ | 13/15 [03:07<00:24, 12.09s/it]ELBO: -828304.6:  93%|█████████▎| 14/15 [03:07<00:12, 12.10s/it]ELBO: -828255.4:  93%|█████████▎| 14/15 [03:19<00:12, 12.10s/it]ELBO: -828255.4: 100%|██████████| 15/15 [03:19<00:00, 12.07s/it]ELBO: -828255.4: 100%|██████████| 15/15 [03:19<00:00, 13.29s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -3916390.0:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -908641.7:   0%|          | 0/15 [00:31<?, ?it/s] ELBO: -908641.7:   7%|▋         | 1/15 [00:31<07:24, 31.76s/it]ELBO: -908376.5:   7%|▋         | 1/15 [00:43<07:24, 31.76s/it]ELBO: -908376.5:  13%|█▎        | 2/15 [00:43<04:22, 20.21s/it]ELBO: -908953.1:  13%|█▎        | 2/15 [00:55<04:22, 20.21s/it]ELBO: -908953.1:  20%|██        | 3/15 [00:55<03:17, 16.48s/it]ELBO: -908176.6:  20%|██        | 3/15 [01:07<03:17, 16.48s/it]ELBO: -908176.6:  27%|██▋       | 4/15 [01:07<02:42, 14.73s/it]ELBO: -908329.8:  27%|██▋       | 4/15 [01:20<02:42, 14.73s/it]ELBO: -908329.8:  33%|███▎      | 5/15 [01:20<02:17, 13.77s/it]ELBO: -908610.8:  33%|███▎      | 5/15 [01:32<02:17, 13.77s/it]ELBO: -908610.8:  40%|████      | 6/15 [01:32<01:58, 13.19s/it]ELBO: -908435.7:  40%|████      | 6/15 [01:44<01:58, 13.19s/it]ELBO: -908435.7:  47%|████▋     | 7/15 [01:44<01:42, 12.84s/it]ELBO: -908300.9:  47%|████▋     | 7/15 [01:56<01:42, 12.84s/it]ELBO: -908300.9:  53%|█████▎    | 8/15 [01:56<01:27, 12.56s/it]ELBO: -908467.7:  53%|█████▎    | 8/15 [02:08<01:27, 12.56s/it]ELBO: -908467.7:  60%|██████    | 9/15 [02:08<01:14, 12.42s/it]ELBO: -908664.2:  60%|██████    | 9/15 [02:20<01:14, 12.42s/it]ELBO: -908664.2:  67%|██████▋   | 10/15 [02:20<01:01, 12.32s/it]ELBO: -908203.4:  67%|██████▋   | 10/15 [02:32<01:01, 12.32s/it]ELBO: -908203.4:  73%|███████▎  | 11/15 [02:32<00:48, 12.23s/it]ELBO: -908811.4:  73%|███████▎  | 11/15 [02:44<00:48, 12.23s/it]ELBO: -908811.4:  80%|████████  | 12/15 [02:44<00:36, 12.17s/it]ELBO: -908680.1:  80%|████████  | 12/15 [02:56<00:36, 12.17s/it]ELBO: -908680.1:  87%|████████▋ | 13/15 [02:56<00:24, 12.11s/it]ELBO: -909516.7:  87%|████████▋ | 13/15 [03:08<00:24, 12.11s/it]ELBO: -909516.7:  93%|█████████▎| 14/15 [03:08<00:12, 12.10s/it]ELBO: -908889.7:  93%|█████████▎| 14/15 [03:20<00:12, 12.10s/it]ELBO: -908889.7: 100%|██████████| 15/15 [03:20<00:00, 12.08s/it]ELBO: -908889.7: 100%|██████████| 15/15 [03:20<00:00, 13.37s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -3674361.3:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -862677.5:   0%|          | 0/15 [00:36<?, ?it/s] ELBO: -862677.5:   7%|▋         | 1/15 [00:36<08:30, 36.47s/it]ELBO: -861898.8:   7%|▋         | 1/15 [00:48<08:30, 36.47s/it]ELBO: -861898.8:  13%|█▎        | 2/15 [00:48<04:47, 22.14s/it]ELBO: -862691.6:  13%|█▎        | 2/15 [01:00<04:47, 22.14s/it]ELBO: -862691.6:  20%|██        | 3/15 [01:00<03:29, 17.49s/it]ELBO: -862310.9:  20%|██        | 3/15 [01:12<03:29, 17.49s/it]ELBO: -862310.9:  27%|██▋       | 4/15 [01:12<02:48, 15.35s/it]ELBO: -862313.3:  27%|██▋       | 4/15 [01:24<02:48, 15.35s/it]ELBO: -862313.3:  33%|███▎      | 5/15 [01:24<02:21, 14.13s/it]ELBO: -862371.5:  33%|███▎      | 5/15 [01:36<02:21, 14.13s/it]ELBO: -862371.5:  40%|████      | 6/15 [01:36<02:00, 13.40s/it]ELBO: -862529.6:  40%|████      | 6/15 [01:48<02:00, 13.40s/it]ELBO: -862529.6:  47%|████▋     | 7/15 [01:48<01:43, 12.95s/it]ELBO: -862638.1:  47%|████▋     | 7/15 [02:00<01:43, 12.95s/it]ELBO: -862638.1:  53%|█████▎    | 8/15 [02:00<01:28, 12.65s/it]ELBO: -861989.6:  53%|█████▎    | 8/15 [02:12<01:28, 12.65s/it]ELBO: -861989.6:  60%|██████    | 9/15 [02:12<01:14, 12.46s/it]ELBO: -862632.1:  60%|██████    | 9/15 [02:24<01:14, 12.46s/it]ELBO: -862632.1:  67%|██████▋   | 10/15 [02:24<01:01, 12.32s/it]ELBO: -862532.3:  67%|██████▋   | 10/15 [02:36<01:01, 12.32s/it]ELBO: -862532.3:  73%|███████▎  | 11/15 [02:36<00:48, 12.23s/it]ELBO: -862287.4:  73%|███████▎  | 11/15 [02:48<00:48, 12.23s/it]ELBO: -862287.4:  80%|████████  | 12/15 [02:48<00:36, 12.15s/it]ELBO: -862568.1:  80%|████████  | 12/15 [03:00<00:36, 12.15s/it]ELBO: -862568.1:  87%|████████▋ | 13/15 [03:00<00:24, 12.10s/it]ELBO: -862604.1:  87%|████████▋ | 13/15 [03:12<00:24, 12.10s/it]ELBO: -862604.1:  93%|█████████▎| 14/15 [03:12<00:12, 12.07s/it]ELBO: -862121.8:  93%|█████████▎| 14/15 [03:24<00:12, 12.07s/it]ELBO: -862121.8: 100%|██████████| 15/15 [03:24<00:00, 12.05s/it]ELBO: -862121.8: 100%|██████████| 15/15 [03:24<00:00, 13.64s/it]
