Processed spikes from trial 100.
Processed spikes from trial 200.
Processed spikes from trial 300.
  0%|          | 0/1 [00:00<?, ?it/s]ARHMM Initialization restarts:   0%|          | 0/1 [00:00<?, ?it/s]Initializing with an ARHMM using 25 steps of EM.

  0%|          | 0/25 [00:00<?, ?it/s][A
LP: -2385735.1:   0%|          | 0/25 [00:00<?, ?it/s][A
LP: -2385735.1:   0%|          | 0/25 [00:00<?, ?it/s][A
LP: -2385735.1:   4%|▍         | 1/25 [00:00<00:13,  1.75it/s][A
LP: -2385735.1:   4%|▍         | 1/25 [00:01<00:13,  1.75it/s][A
LP: -2385735.1:   8%|▊         | 2/25 [00:01<00:13,  1.77it/s][A
LP: -2385735.1:   8%|▊         | 2/25 [00:01<00:13,  1.77it/s][A
LP: -2385735.1:  12%|█▏        | 3/25 [00:01<00:12,  1.76it/s][A
LP: -2385735.1:  12%|█▏        | 3/25 [00:02<00:12,  1.76it/s][A
LP: -2385735.1:  16%|█▌        | 4/25 [00:02<00:11,  1.76it/s][A
LP: -2385735.1:  16%|█▌        | 4/25 [00:02<00:11,  1.76it/s][A
LP: -2385735.1:  20%|██        | 5/25 [00:02<00:11,  1.76it/s][A
LP: -2385735.1:  20%|██        | 5/25 [00:03<00:11,  1.76it/s][A
LP: -2385735.1:  24%|██▍       | 6/25 [00:03<00:10,  1.76it/s][A
LP: -2385735.1:  24%|██▍       | 6/25 [00:03<00:10,  1.76it/s][A
LP: -2385735.1:  28%|██▊       | 7/25 [00:03<00:10,  1.77it/s][A
LP: -2385735.1:  28%|██▊       | 7/25 [00:04<00:10,  1.77it/s][A
LP: -2385735.1:  32%|███▏      | 8/25 [00:04<00:09,  1.77it/s][A
LP: -2385735.1:  32%|███▏      | 8/25 [00:05<00:09,  1.77it/s][A
LP: -2385735.1:  36%|███▌      | 9/25 [00:05<00:09,  1.77it/s][A
LP: -2385735.1:  36%|███▌      | 9/25 [00:05<00:09,  1.77it/s][A
LP: -2385735.1:  40%|████      | 10/25 [00:05<00:08,  1.78it/s][A
LP: -2385735.1:  40%|████      | 10/25 [00:06<00:08,  1.78it/s][A
LP: -2385735.1:  44%|████▍     | 11/25 [00:06<00:07,  1.78it/s][A
LP: -2385735.1:  44%|████▍     | 11/25 [00:06<00:07,  1.78it/s][A
LP: -2385735.1:  48%|████▊     | 12/25 [00:06<00:07,  1.78it/s][A
LP: -2385735.1:  48%|████▊     | 12/25 [00:07<00:07,  1.78it/s][A
LP: -2385735.1:  52%|█████▏    | 13/25 [00:07<00:06,  1.79it/s][A
LP: -2385735.1:  52%|█████▏    | 13/25 [00:07<00:06,  1.79it/s][A
LP: -2385735.1:  56%|█████▌    | 14/25 [00:07<00:06,  1.79it/s][A
LP: -2385735.1:  56%|█████▌    | 14/25 [00:08<00:06,  1.79it/s][A
LP: -2385735.1:  60%|██████    | 15/25 [00:08<00:05,  1.79it/s][A
LP: -2385735.1:  60%|██████    | 15/25 [00:09<00:05,  1.79it/s][A
LP: -2385735.1:  64%|██████▍   | 16/25 [00:09<00:05,  1.78it/s][A
LP: -2385735.1:  64%|██████▍   | 16/25 [00:09<00:05,  1.78it/s][A
LP: -2385735.1:  68%|██████▊   | 17/25 [00:09<00:04,  1.77it/s][A
LP: -2385735.1:  68%|██████▊   | 17/25 [00:10<00:04,  1.77it/s][A
LP: -2385735.1:  72%|███████▏  | 18/25 [00:10<00:03,  1.78it/s][A
LP: -2385735.1:  72%|███████▏  | 18/25 [00:10<00:03,  1.78it/s][A
LP: -2385735.1:  76%|███████▌  | 19/25 [00:10<00:03,  1.77it/s][A
LP: -2385735.1:  76%|███████▌  | 19/25 [00:11<00:03,  1.77it/s][A
LP: -2385735.1:  80%|████████  | 20/25 [00:11<00:02,  1.77it/s][A
LP: -2385735.1:  80%|████████  | 20/25 [00:11<00:02,  1.77it/s][A
LP: -2385735.1:  84%|████████▍ | 21/25 [00:11<00:02,  1.76it/s][A
LP: -2385735.1:  84%|████████▍ | 21/25 [00:12<00:02,  1.76it/s][A
LP: -2385735.1:  88%|████████▊ | 22/25 [00:12<00:01,  1.76it/s][A
LP: -2385735.1:  88%|████████▊ | 22/25 [00:12<00:01,  1.76it/s][A
LP: -2385735.1:  92%|█████████▏| 23/25 [00:12<00:01,  1.76it/s][A
LP: -2385735.1:  92%|█████████▏| 23/25 [00:13<00:01,  1.76it/s][A
LP: -2385735.1:  96%|█████████▌| 24/25 [00:13<00:00,  1.77it/s][A
LP: -2385735.1:  96%|█████████▌| 24/25 [00:14<00:00,  1.77it/s][A
LP: -2385735.1: 100%|██████████| 25/25 [00:14<00:00,  1.78it/s][ALP: -2385735.1: 100%|██████████| 25/25 [00:14<00:00,  1.77it/s]
ARHMM Initialization restarts: 100%|██████████| 1/1 [00:14<00:00, 14.83s/it]ARHMM Initialization restarts: 100%|██████████| 1/1 [00:14<00:00, 14.83s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -7307500.7:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -4502602.6:   0%|          | 0/15 [02:13<?, ?it/s]ELBO: -4502602.6:   7%|▋         | 1/15 [02:13<31:10, 133.59s/it]ELBO: -4459141.4:   7%|▋         | 1/15 [03:50<31:10, 133.59s/it]ELBO: -4459141.4:  13%|█▎        | 2/15 [03:50<24:18, 112.16s/it]ELBO: -4439402.4:  13%|█▎        | 2/15 [05:13<24:18, 112.16s/it]ELBO: -4439402.4:  20%|██        | 3/15 [05:13<19:44, 98.69s/it] ELBO: -4428950.8:  20%|██        | 3/15 [06:36<19:44, 98.69s/it]ELBO: -4428950.8:  27%|██▋       | 4/15 [06:36<16:57, 92.47s/it]ELBO: -4420919.0:  27%|██▋       | 4/15 [07:56<16:57, 92.47s/it]ELBO: -4420919.0:  33%|███▎      | 5/15 [07:56<14:41, 88.10s/it]ELBO: -4413063.9:  33%|███▎      | 5/15 [09:17<14:41, 88.10s/it]ELBO: -4413063.9:  40%|████      | 6/15 [09:17<12:49, 85.54s/it]ELBO: -4409869.2:  40%|████      | 6/15 [10:35<12:49, 85.54s/it]ELBO: -4409869.2:  47%|████▋     | 7/15 [10:35<11:05, 83.17s/it]ELBO: -4405229.9:  47%|████▋     | 7/15 [11:53<11:05, 83.17s/it]ELBO: -4405229.9:  53%|█████▎    | 8/15 [11:53<09:30, 81.57s/it]ELBO: -4401605.6:  53%|█████▎    | 8/15 [13:11<09:30, 81.57s/it]ELBO: -4401605.6:  60%|██████    | 9/15 [13:11<08:02, 80.48s/it]ELBO: -4398530.7:  60%|██████    | 9/15 [14:29<08:02, 80.48s/it]ELBO: -4398530.7:  67%|██████▋   | 10/15 [14:29<06:38, 79.72s/it]ELBO: -4396506.7:  67%|██████▋   | 10/15 [15:47<06:38, 79.72s/it]ELBO: -4396506.7:  73%|███████▎  | 11/15 [15:47<05:16, 79.21s/it]ELBO: -4394313.9:  73%|███████▎  | 11/15 [17:01<05:16, 79.21s/it]ELBO: -4394313.9:  80%|████████  | 12/15 [17:01<03:52, 77.45s/it]ELBO: -4392938.1:  80%|████████  | 12/15 [18:16<03:52, 77.45s/it]ELBO: -4392938.1:  87%|████████▋ | 13/15 [18:16<02:33, 76.92s/it]ELBO: -4392768.1:  87%|████████▋ | 13/15 [19:32<02:33, 76.92s/it]ELBO: -4392768.1:  93%|█████████▎| 14/15 [19:32<01:16, 76.48s/it]ELBO: -4391434.8:  93%|█████████▎| 14/15 [20:45<01:16, 76.48s/it]ELBO: -4391434.8: 100%|██████████| 15/15 [20:45<00:00, 75.53s/it]ELBO: -4391434.8: 100%|██████████| 15/15 [20:45<00:00, 83.05s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -3115833.7:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -876140.0:   0%|          | 0/15 [00:24<?, ?it/s] ELBO: -876140.0:   7%|▋         | 1/15 [00:24<05:46, 24.75s/it]ELBO: -876467.9:   7%|▋         | 1/15 [00:35<05:46, 24.75s/it]ELBO: -876467.9:  13%|█▎        | 2/15 [00:35<03:35, 16.56s/it]ELBO: -875842.4:  13%|█▎        | 2/15 [00:46<03:35, 16.56s/it]ELBO: -875842.4:  20%|██        | 3/15 [00:46<02:47, 13.96s/it]ELBO: -875625.9:  20%|██        | 3/15 [00:57<02:47, 13.96s/it]ELBO: -875625.9:  27%|██▋       | 4/15 [00:57<02:19, 12.72s/it]ELBO: -876683.6:  27%|██▋       | 4/15 [01:08<02:19, 12.72s/it]ELBO: -876683.6:  33%|███▎      | 5/15 [01:08<02:00, 12.04s/it]ELBO: -876453.2:  33%|███▎      | 5/15 [01:18<02:00, 12.04s/it]ELBO: -876453.2:  40%|████      | 6/15 [01:18<01:44, 11.61s/it]ELBO: -876500.3:  40%|████      | 6/15 [01:29<01:44, 11.61s/it]ELBO: -876500.3:  47%|████▋     | 7/15 [01:29<01:30, 11.35s/it]ELBO: -876940.1:  47%|████▋     | 7/15 [01:40<01:30, 11.35s/it]ELBO: -876940.1:  53%|█████▎    | 8/15 [01:40<01:18, 11.19s/it]ELBO: -877103.2:  53%|█████▎    | 8/15 [01:51<01:18, 11.19s/it]ELBO: -877103.2:  60%|██████    | 9/15 [01:51<01:06, 11.08s/it]ELBO: -876627.3:  60%|██████    | 9/15 [02:02<01:06, 11.08s/it]ELBO: -876627.3:  67%|██████▋   | 10/15 [02:02<00:54, 10.98s/it]ELBO: -876571.2:  67%|██████▋   | 10/15 [02:12<00:54, 10.98s/it]ELBO: -876571.2:  73%|███████▎  | 11/15 [02:12<00:43, 10.94s/it]ELBO: -876312.6:  73%|███████▎  | 11/15 [02:23<00:43, 10.94s/it]ELBO: -876312.6:  80%|████████  | 12/15 [02:23<00:32, 10.91s/it]ELBO: -876568.3:  80%|████████  | 12/15 [02:34<00:32, 10.91s/it]ELBO: -876568.3:  87%|████████▋ | 13/15 [02:34<00:21, 10.88s/it]ELBO: -876683.7:  87%|████████▋ | 13/15 [02:45<00:21, 10.88s/it]ELBO: -876683.7:  93%|█████████▎| 14/15 [02:45<00:10, 10.87s/it]ELBO: -875907.8:  93%|█████████▎| 14/15 [02:56<00:10, 10.87s/it]ELBO: -875907.8: 100%|██████████| 15/15 [02:56<00:00, 10.84s/it]ELBO: -875907.8: 100%|██████████| 15/15 [02:56<00:00, 11.75s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -3006929.6:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -856442.6:   0%|          | 0/15 [00:28<?, ?it/s] ELBO: -856442.6:   7%|▋         | 1/15 [00:28<06:36, 28.31s/it]ELBO: -856242.4:   7%|▋         | 1/15 [00:39<06:36, 28.31s/it]ELBO: -856242.4:  13%|█▎        | 2/15 [00:39<03:54, 18.06s/it]ELBO: -856498.0:  13%|█▎        | 2/15 [00:49<03:54, 18.06s/it]ELBO: -856498.0:  20%|██        | 3/15 [00:49<02:56, 14.74s/it]ELBO: -855966.5:  20%|██        | 3/15 [01:00<02:56, 14.74s/it]ELBO: -855966.5:  27%|██▋       | 4/15 [01:00<02:25, 13.18s/it]ELBO: -855782.7:  27%|██▋       | 4/15 [01:11<02:25, 13.18s/it]ELBO: -855782.7:  33%|███▎      | 5/15 [01:11<02:03, 12.33s/it]ELBO: -856062.5:  33%|███▎      | 5/15 [01:22<02:03, 12.33s/it]ELBO: -856062.5:  40%|████      | 6/15 [01:22<01:46, 11.81s/it]ELBO: -855351.1:  40%|████      | 6/15 [01:33<01:46, 11.81s/it]ELBO: -855351.1:  47%|████▋     | 7/15 [01:33<01:31, 11.49s/it]ELBO: -856214.7:  47%|████▋     | 7/15 [01:44<01:31, 11.49s/it]ELBO: -856214.7:  53%|█████▎    | 8/15 [01:44<01:18, 11.28s/it]ELBO: -856841.1:  53%|█████▎    | 8/15 [01:54<01:18, 11.28s/it]ELBO: -856841.1:  60%|██████    | 9/15 [01:54<01:06, 11.14s/it]ELBO: -856010.4:  60%|██████    | 9/15 [02:05<01:06, 11.14s/it]ELBO: -856010.4:  67%|██████▋   | 10/15 [02:05<00:55, 11.05s/it]ELBO: -856293.2:  67%|██████▋   | 10/15 [02:16<00:55, 11.05s/it]ELBO: -856293.2:  73%|███████▎  | 11/15 [02:16<00:43, 10.97s/it]ELBO: -856093.5:  73%|███████▎  | 11/15 [02:27<00:43, 10.97s/it]ELBO: -856093.5:  80%|████████  | 12/15 [02:27<00:32, 10.92s/it]ELBO: -855804.8:  80%|████████  | 12/15 [02:38<00:32, 10.92s/it]ELBO: -855804.8:  87%|████████▋ | 13/15 [02:38<00:21, 10.88s/it]ELBO: -855776.7:  87%|████████▋ | 13/15 [02:49<00:21, 10.88s/it]ELBO: -855776.7:  93%|█████████▎| 14/15 [02:49<00:10, 10.88s/it]ELBO: -855787.4:  93%|█████████▎| 14/15 [02:59<00:10, 10.88s/it]ELBO: -855787.4: 100%|██████████| 15/15 [02:59<00:00, 10.86s/it]ELBO: -855787.4: 100%|██████████| 15/15 [02:59<00:00, 11.99s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -3726322.3:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -873504.5:   0%|          | 0/15 [00:32<?, ?it/s] ELBO: -873504.5:   7%|▋         | 1/15 [00:32<07:31, 32.28s/it]ELBO: -874098.4:   7%|▋         | 1/15 [00:43<07:31, 32.28s/it]ELBO: -874098.4:  13%|█▎        | 2/15 [00:43<04:15, 19.69s/it]ELBO: -873468.1:  13%|█▎        | 2/15 [00:53<04:15, 19.69s/it]ELBO: -873468.1:  20%|██        | 3/15 [00:53<03:07, 15.63s/it]ELBO: -873809.5:  20%|██        | 3/15 [01:04<03:07, 15.63s/it]ELBO: -873809.5:  27%|██▋       | 4/15 [01:04<02:31, 13.74s/it]ELBO: -873556.9:  27%|██▋       | 4/15 [01:15<02:31, 13.74s/it]ELBO: -873556.9:  33%|███▎      | 5/15 [01:15<02:06, 12.70s/it]ELBO: -874079.6:  33%|███▎      | 5/15 [01:26<02:06, 12.70s/it]ELBO: -874079.6:  40%|████      | 6/15 [01:26<01:48, 12.06s/it]ELBO: -873978.1:  40%|████      | 6/15 [01:37<01:48, 12.06s/it]ELBO: -873978.1:  47%|████▋     | 7/15 [01:37<01:33, 11.65s/it]ELBO: -873670.8:  47%|████▋     | 7/15 [01:48<01:33, 11.65s/it]ELBO: -873670.8:  53%|█████▎    | 8/15 [01:48<01:19, 11.38s/it]ELBO: -872999.7:  53%|█████▎    | 8/15 [01:58<01:19, 11.38s/it]ELBO: -872999.7:  60%|██████    | 9/15 [01:58<01:07, 11.20s/it]ELBO: -873332.3:  60%|██████    | 9/15 [02:09<01:07, 11.20s/it]ELBO: -873332.3:  67%|██████▋   | 10/15 [02:09<00:55, 11.10s/it]ELBO: -874162.5:  67%|██████▋   | 10/15 [02:20<00:55, 11.10s/it]ELBO: -874162.5:  73%|███████▎  | 11/15 [02:20<00:44, 11.03s/it]ELBO: -873397.1:  73%|███████▎  | 11/15 [02:31<00:44, 11.03s/it]ELBO: -873397.1:  80%|████████  | 12/15 [02:31<00:32, 10.96s/it]ELBO: -873334.2:  80%|████████  | 12/15 [02:42<00:32, 10.96s/it]ELBO: -873334.2:  87%|████████▋ | 13/15 [02:42<00:21, 10.93s/it]ELBO: -873361.5:  87%|████████▋ | 13/15 [02:53<00:21, 10.93s/it]ELBO: -873361.5:  93%|█████████▎| 14/15 [02:53<00:10, 10.89s/it]ELBO: -873178.7:  93%|█████████▎| 14/15 [03:03<00:10, 10.89s/it]ELBO: -873178.7: 100%|██████████| 15/15 [03:03<00:00, 10.88s/it]ELBO: -873178.7: 100%|██████████| 15/15 [03:03<00:00, 12.26s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -3213537.6:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -905275.8:   0%|          | 0/15 [00:30<?, ?it/s] ELBO: -905275.8:   7%|▋         | 1/15 [00:30<07:06, 30.46s/it]ELBO: -906105.8:   7%|▋         | 1/15 [00:41<07:06, 30.46s/it]ELBO: -906105.8:  13%|█▎        | 2/15 [00:41<04:06, 18.92s/it]ELBO: -905657.3:  13%|█▎        | 2/15 [00:52<04:06, 18.92s/it]ELBO: -905657.3:  20%|██        | 3/15 [00:52<03:02, 15.21s/it]ELBO: -905019.4:  20%|██        | 3/15 [01:02<03:02, 15.21s/it]ELBO: -905019.4:  27%|██▋       | 4/15 [01:02<02:28, 13.47s/it]ELBO: -905126.6:  27%|██▋       | 4/15 [01:13<02:28, 13.47s/it]ELBO: -905126.6:  33%|███▎      | 5/15 [01:13<02:05, 12.51s/it]ELBO: -904986.6:  33%|███▎      | 5/15 [01:24<02:05, 12.51s/it]ELBO: -904986.6:  40%|████      | 6/15 [01:24<01:47, 11.94s/it]ELBO: -905599.4:  40%|████      | 6/15 [01:35<01:47, 11.94s/it]ELBO: -905599.4:  47%|████▋     | 7/15 [01:35<01:32, 11.56s/it]ELBO: -905396.7:  47%|████▋     | 7/15 [01:46<01:32, 11.56s/it]ELBO: -905396.7:  53%|█████▎    | 8/15 [01:46<01:19, 11.34s/it]ELBO: -904743.8:  53%|█████▎    | 8/15 [01:57<01:19, 11.34s/it]ELBO: -904743.8:  60%|██████    | 9/15 [01:57<01:07, 11.19s/it]ELBO: -905559.0:  60%|██████    | 9/15 [02:07<01:07, 11.19s/it]ELBO: -905559.0:  67%|██████▋   | 10/15 [02:07<00:55, 11.08s/it]ELBO: -905633.6:  67%|██████▋   | 10/15 [02:18<00:55, 11.08s/it]ELBO: -905633.6:  73%|███████▎  | 11/15 [02:18<00:44, 11.00s/it]ELBO: -905490.8:  73%|███████▎  | 11/15 [02:29<00:44, 11.00s/it]ELBO: -905490.8:  80%|████████  | 12/15 [02:29<00:32, 10.93s/it]ELBO: -905275.6:  80%|████████  | 12/15 [02:40<00:32, 10.93s/it]ELBO: -905275.6:  87%|████████▋ | 13/15 [02:40<00:21, 10.91s/it]ELBO: -904800.1:  87%|████████▋ | 13/15 [02:51<00:21, 10.91s/it]ELBO: -904800.1:  93%|█████████▎| 14/15 [02:51<00:10, 10.89s/it]ELBO: -905898.3:  93%|█████████▎| 14/15 [03:02<00:10, 10.89s/it]ELBO: -905898.3: 100%|██████████| 15/15 [03:02<00:00, 10.87s/it]ELBO: -905898.3: 100%|██████████| 15/15 [03:02<00:00, 12.13s/it]
