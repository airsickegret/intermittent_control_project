Processed spikes from trial 100.
Processed spikes from trial 200.
Processed spikes from trial 300.
  0%|          | 0/1 [00:00<?, ?it/s]ARHMM Initialization restarts:   0%|          | 0/1 [00:00<?, ?it/s]Initializing with an ARHMM using 25 steps of EM.

  0%|          | 0/25 [00:00<?, ?it/s][A
LP: -2191783.0:   0%|          | 0/25 [00:00<?, ?it/s][A
LP: -2191783.0:   0%|          | 0/25 [00:00<?, ?it/s][A
LP: -2191783.0:   4%|▍         | 1/25 [00:00<00:12,  1.98it/s][A
LP: -2191783.0:   4%|▍         | 1/25 [00:01<00:12,  1.98it/s][A
LP: -2191783.0:   8%|▊         | 2/25 [00:01<00:11,  1.97it/s][A
LP: -2191783.0:   8%|▊         | 2/25 [00:01<00:11,  1.97it/s][A
LP: -2191783.0:  12%|█▏        | 3/25 [00:01<00:11,  1.97it/s][A
LP: -2191783.0:  12%|█▏        | 3/25 [00:02<00:11,  1.97it/s][A
LP: -2191783.0:  16%|█▌        | 4/25 [00:02<00:10,  1.96it/s][A
LP: -2191783.0:  16%|█▌        | 4/25 [00:02<00:10,  1.96it/s][A
LP: -2191783.0:  20%|██        | 5/25 [00:02<00:10,  1.97it/s][A
LP: -2191783.0:  20%|██        | 5/25 [00:03<00:10,  1.97it/s][A
LP: -2191783.0:  24%|██▍       | 6/25 [00:03<00:09,  1.97it/s][A
LP: -2191783.0:  24%|██▍       | 6/25 [00:03<00:09,  1.97it/s][A
LP: -2191783.0:  28%|██▊       | 7/25 [00:03<00:09,  1.97it/s][A
LP: -2191783.0:  28%|██▊       | 7/25 [00:04<00:09,  1.97it/s][A
LP: -2191783.0:  32%|███▏      | 8/25 [00:04<00:08,  1.97it/s][A
LP: -2191783.0:  32%|███▏      | 8/25 [00:04<00:08,  1.97it/s][A
LP: -2191783.0:  36%|███▌      | 9/25 [00:04<00:08,  1.98it/s][A
LP: -2191783.0:  36%|███▌      | 9/25 [00:05<00:08,  1.98it/s][A
LP: -2191783.0:  40%|████      | 10/25 [00:05<00:07,  1.98it/s][A
LP: -2191783.0:  40%|████      | 10/25 [00:05<00:07,  1.98it/s][A
LP: -2191783.0:  44%|████▍     | 11/25 [00:05<00:07,  1.97it/s][A
LP: -2191783.0:  44%|████▍     | 11/25 [00:06<00:07,  1.97it/s][A
LP: -2191783.0:  48%|████▊     | 12/25 [00:06<00:06,  1.97it/s][A
LP: -2191783.0:  48%|████▊     | 12/25 [00:06<00:06,  1.97it/s][A
LP: -2191783.0:  52%|█████▏    | 13/25 [00:06<00:06,  1.98it/s][A
LP: -2191783.0:  52%|█████▏    | 13/25 [00:07<00:06,  1.98it/s][A
LP: -2191783.0:  56%|█████▌    | 14/25 [00:07<00:05,  1.98it/s][A
LP: -2191783.0:  56%|█████▌    | 14/25 [00:07<00:05,  1.98it/s][A
LP: -2191783.0:  60%|██████    | 15/25 [00:07<00:05,  1.97it/s][A
LP: -2191783.0:  60%|██████    | 15/25 [00:08<00:05,  1.97it/s][A
LP: -2191783.0:  64%|██████▍   | 16/25 [00:08<00:04,  1.98it/s][A
LP: -2191783.0:  64%|██████▍   | 16/25 [00:08<00:04,  1.98it/s][A
LP: -2191783.0:  68%|██████▊   | 17/25 [00:08<00:04,  1.98it/s][A
LP: -2191783.0:  68%|██████▊   | 17/25 [00:09<00:04,  1.98it/s][A
LP: -2191783.0:  72%|███████▏  | 18/25 [00:09<00:03,  1.98it/s][A
LP: -2191783.0:  72%|███████▏  | 18/25 [00:09<00:03,  1.98it/s][A
LP: -2191783.0:  76%|███████▌  | 19/25 [00:09<00:03,  1.98it/s][A
LP: -2191783.0:  76%|███████▌  | 19/25 [00:10<00:03,  1.98it/s][A
LP: -2191783.0:  80%|████████  | 20/25 [00:10<00:02,  1.97it/s][A
LP: -2191783.0:  80%|████████  | 20/25 [00:10<00:02,  1.97it/s][A
LP: -2191783.0:  84%|████████▍ | 21/25 [00:10<00:02,  1.97it/s][A
LP: -2191783.0:  84%|████████▍ | 21/25 [00:11<00:02,  1.97it/s][A
LP: -2191783.0:  88%|████████▊ | 22/25 [00:11<00:01,  1.98it/s][A
LP: -2191783.0:  88%|████████▊ | 22/25 [00:11<00:01,  1.98it/s][A
LP: -2191783.0:  92%|█████████▏| 23/25 [00:11<00:01,  1.98it/s][A
LP: -2191783.0:  92%|█████████▏| 23/25 [00:12<00:01,  1.98it/s][A
LP: -2191783.0:  96%|█████████▌| 24/25 [00:12<00:00,  1.99it/s][A
LP: -2191783.0:  96%|█████████▌| 24/25 [00:12<00:00,  1.99it/s][A
LP: -2191783.0: 100%|██████████| 25/25 [00:12<00:00,  1.99it/s][ALP: -2191783.0: 100%|██████████| 25/25 [00:12<00:00,  1.98it/s]
ARHMM Initialization restarts: 100%|██████████| 1/1 [00:13<00:00, 13.31s/it]ARHMM Initialization restarts: 100%|██████████| 1/1 [00:13<00:00, 13.31s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -7120159.7:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -4544878.9:   0%|          | 0/15 [02:02<?, ?it/s]ELBO: -4544878.9:   7%|▋         | 1/15 [02:02<28:40, 122.89s/it]ELBO: -4502723.4:   7%|▋         | 1/15 [03:29<28:40, 122.89s/it]ELBO: -4502723.4:  13%|█▎        | 2/15 [03:29<22:01, 101.69s/it]ELBO: -4485107.9:  13%|█▎        | 2/15 [04:42<22:01, 101.69s/it]ELBO: -4485107.9:  20%|██        | 3/15 [04:42<17:42, 88.53s/it] ELBO: -4472686.1:  20%|██        | 3/15 [05:55<17:42, 88.53s/it]ELBO: -4472686.1:  27%|██▋       | 4/15 [05:55<15:05, 82.31s/it]ELBO: -4465167.4:  27%|██▋       | 4/15 [07:05<15:05, 82.31s/it]ELBO: -4465167.4:  33%|███▎      | 5/15 [07:05<13:00, 78.05s/it]ELBO: -4458506.6:  33%|███▎      | 5/15 [08:16<13:00, 78.05s/it]ELBO: -4458506.6:  40%|████      | 6/15 [08:16<11:19, 75.48s/it]ELBO: -4453142.9:  40%|████      | 6/15 [09:24<11:19, 75.48s/it]ELBO: -4453142.9:  47%|████▋     | 7/15 [09:24<09:44, 73.02s/it]ELBO: -4449701.8:  47%|████▋     | 7/15 [10:32<09:44, 73.02s/it]ELBO: -4449701.8:  53%|█████▎    | 8/15 [10:32<08:20, 71.47s/it]ELBO: -4446804.0:  53%|█████▎    | 8/15 [11:40<08:20, 71.47s/it]ELBO: -4446804.0:  60%|██████    | 9/15 [11:40<07:02, 70.41s/it]ELBO: -4444474.4:  60%|██████    | 9/15 [12:48<07:02, 70.41s/it]ELBO: -4444474.4:  67%|██████▋   | 10/15 [12:48<05:48, 69.70s/it]ELBO: -4442614.5:  67%|██████▋   | 10/15 [13:52<05:48, 69.70s/it]ELBO: -4442614.5:  73%|███████▎  | 11/15 [13:52<04:31, 67.79s/it]ELBO: -4439859.6:  73%|███████▎  | 11/15 [14:57<04:31, 67.79s/it]ELBO: -4439859.6:  80%|████████  | 12/15 [14:57<03:21, 67.12s/it]ELBO: -4438520.3:  80%|████████  | 12/15 [16:03<03:21, 67.12s/it]ELBO: -4438520.3:  87%|████████▋ | 13/15 [16:03<02:13, 66.78s/it]ELBO: -4438262.1:  87%|████████▋ | 13/15 [17:06<02:13, 66.78s/it]ELBO: -4438262.1:  93%|█████████▎| 14/15 [17:06<01:05, 65.70s/it]ELBO: -4435632.0:  93%|█████████▎| 14/15 [18:10<01:05, 65.70s/it]ELBO: -4435632.0: 100%|██████████| 15/15 [18:10<00:00, 65.06s/it]ELBO: -4435632.0: 100%|██████████| 15/15 [18:10<00:00, 72.70s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -2578305.6:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -888919.5:   0%|          | 0/15 [00:23<?, ?it/s] ELBO: -888919.5:   7%|▋         | 1/15 [00:23<05:32, 23.73s/it]ELBO: -888404.6:   7%|▋         | 1/15 [00:32<05:32, 23.73s/it]ELBO: -888404.6:  13%|█▎        | 2/15 [00:32<03:13, 14.86s/it]ELBO: -887832.9:  13%|█▎        | 2/15 [00:41<03:13, 14.86s/it]ELBO: -887832.9:  20%|██        | 3/15 [00:41<02:24, 12.03s/it]ELBO: -888246.5:  20%|██        | 3/15 [00:49<02:24, 12.03s/it]ELBO: -888246.5:  27%|██▋       | 4/15 [00:49<01:57, 10.72s/it]ELBO: -888282.0:  27%|██▋       | 4/15 [00:58<01:57, 10.72s/it]ELBO: -888282.0:  33%|███▎      | 5/15 [00:58<01:40, 10.00s/it]ELBO: -888968.9:  33%|███▎      | 5/15 [01:07<01:40, 10.00s/it]ELBO: -888968.9:  40%|████      | 6/15 [01:07<01:26,  9.58s/it]ELBO: -888439.6:  40%|████      | 6/15 [01:15<01:26,  9.58s/it]ELBO: -888439.6:  47%|████▋     | 7/15 [01:15<01:14,  9.29s/it]ELBO: -888131.9:  47%|████▋     | 7/15 [01:24<01:14,  9.29s/it]ELBO: -888131.9:  53%|█████▎    | 8/15 [01:24<01:03,  9.11s/it]ELBO: -887603.7:  53%|█████▎    | 8/15 [01:33<01:03,  9.11s/it]ELBO: -887603.7:  60%|██████    | 9/15 [01:33<00:53,  8.98s/it]ELBO: -888449.3:  60%|██████    | 9/15 [01:42<00:53,  8.98s/it]ELBO: -888449.3:  67%|██████▋   | 10/15 [01:42<00:44,  8.90s/it]ELBO: -888870.8:  67%|██████▋   | 10/15 [01:50<00:44,  8.90s/it]ELBO: -888870.8:  73%|███████▎  | 11/15 [01:50<00:35,  8.85s/it]ELBO: -889031.6:  73%|███████▎  | 11/15 [01:59<00:35,  8.85s/it]ELBO: -889031.6:  80%|████████  | 12/15 [01:59<00:26,  8.82s/it]ELBO: -888223.5:  80%|████████  | 12/15 [02:08<00:26,  8.82s/it]ELBO: -888223.5:  87%|████████▋ | 13/15 [02:08<00:17,  8.79s/it]ELBO: -888926.1:  87%|████████▋ | 13/15 [02:16<00:17,  8.79s/it]ELBO: -888926.1:  93%|█████████▎| 14/15 [02:16<00:08,  8.77s/it]ELBO: -888627.8:  93%|█████████▎| 14/15 [02:25<00:08,  8.77s/it]ELBO: -888627.8: 100%|██████████| 15/15 [02:25<00:00,  8.76s/it]ELBO: -888627.8: 100%|██████████| 15/15 [02:25<00:00,  9.72s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -2678170.2:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -771711.0:   0%|          | 0/15 [00:23<?, ?it/s] ELBO: -771711.0:   7%|▋         | 1/15 [00:23<05:27, 23.39s/it]ELBO: -770881.3:   7%|▋         | 1/15 [00:32<05:27, 23.39s/it]ELBO: -770881.3:  13%|█▎        | 2/15 [00:32<03:12, 14.78s/it]ELBO: -771177.5:  13%|█▎        | 2/15 [00:40<03:12, 14.78s/it]ELBO: -771177.5:  20%|██        | 3/15 [00:40<02:24, 12.03s/it]ELBO: -771716.8:  20%|██        | 3/15 [00:49<02:24, 12.03s/it]ELBO: -771716.8:  27%|██▋       | 4/15 [00:49<01:57, 10.72s/it]ELBO: -770900.1:  27%|██▋       | 4/15 [00:58<01:57, 10.72s/it]ELBO: -770900.1:  33%|███▎      | 5/15 [00:58<01:39,  9.99s/it]ELBO: -771289.7:  33%|███▎      | 5/15 [01:07<01:39,  9.99s/it]ELBO: -771289.7:  40%|████      | 6/15 [01:07<01:25,  9.55s/it]ELBO: -771895.1:  40%|████      | 6/15 [01:15<01:25,  9.55s/it]ELBO: -771895.1:  47%|████▋     | 7/15 [01:15<01:14,  9.27s/it]ELBO: -771612.1:  47%|████▋     | 7/15 [01:24<01:14,  9.27s/it]ELBO: -771612.1:  53%|█████▎    | 8/15 [01:24<01:03,  9.07s/it]ELBO: -771341.6:  53%|█████▎    | 8/15 [01:33<01:03,  9.07s/it]ELBO: -771341.6:  60%|██████    | 9/15 [01:33<00:53,  8.99s/it]ELBO: -771491.7:  60%|██████    | 9/15 [01:41<00:53,  8.99s/it]ELBO: -771491.7:  67%|██████▋   | 10/15 [01:41<00:44,  8.90s/it]ELBO: -771855.8:  67%|██████▋   | 10/15 [01:50<00:44,  8.90s/it]ELBO: -771855.8:  73%|███████▎  | 11/15 [01:50<00:35,  8.86s/it]ELBO: -771103.5:  73%|███████▎  | 11/15 [01:59<00:35,  8.86s/it]ELBO: -771103.5:  80%|████████  | 12/15 [01:59<00:26,  8.82s/it]ELBO: -771338.2:  80%|████████  | 12/15 [02:08<00:26,  8.82s/it]ELBO: -771338.2:  87%|████████▋ | 13/15 [02:08<00:17,  8.81s/it]ELBO: -771861.3:  87%|████████▋ | 13/15 [02:16<00:17,  8.81s/it]ELBO: -771861.3:  93%|█████████▎| 14/15 [02:16<00:08,  8.81s/it]ELBO: -771741.5:  93%|█████████▎| 14/15 [02:25<00:08,  8.81s/it]ELBO: -771741.5: 100%|██████████| 15/15 [02:25<00:00,  8.80s/it]ELBO: -771741.5: 100%|██████████| 15/15 [02:25<00:00,  9.71s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -2677110.2:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -861600.8:   0%|          | 0/15 [00:23<?, ?it/s] ELBO: -861600.8:   7%|▋         | 1/15 [00:23<05:33, 23.81s/it]ELBO: -862347.7:   7%|▋         | 1/15 [00:32<05:33, 23.81s/it]ELBO: -862347.7:  13%|█▎        | 2/15 [00:32<03:14, 15.00s/it]ELBO: -862047.4:  13%|█▎        | 2/15 [00:41<03:14, 15.00s/it]ELBO: -862047.4:  20%|██        | 3/15 [00:41<02:26, 12.17s/it]ELBO: -861991.9:  20%|██        | 3/15 [00:50<02:26, 12.17s/it]ELBO: -861991.9:  27%|██▋       | 4/15 [00:50<01:58, 10.82s/it]ELBO: -862195.3:  27%|██▋       | 4/15 [00:58<01:58, 10.82s/it]ELBO: -862195.3:  33%|███▎      | 5/15 [00:58<01:40, 10.08s/it]ELBO: -861890.1:  33%|███▎      | 5/15 [01:07<01:40, 10.08s/it]ELBO: -861890.1:  40%|████      | 6/15 [01:07<01:26,  9.62s/it]ELBO: -862575.8:  40%|████      | 6/15 [01:16<01:26,  9.62s/it]ELBO: -862575.8:  47%|████▋     | 7/15 [01:16<01:14,  9.35s/it]ELBO: -862325.8:  47%|████▋     | 7/15 [01:25<01:14,  9.35s/it]ELBO: -862325.8:  53%|█████▎    | 8/15 [01:25<01:04,  9.17s/it]ELBO: -862118.1:  53%|█████▎    | 8/15 [01:33<01:04,  9.17s/it]ELBO: -862118.1:  60%|██████    | 9/15 [01:33<00:54,  9.03s/it]ELBO: -862442.9:  60%|██████    | 9/15 [01:42<00:54,  9.03s/it]ELBO: -862442.9:  67%|██████▋   | 10/15 [01:42<00:44,  8.93s/it]ELBO: -862403.9:  67%|██████▋   | 10/15 [01:51<00:44,  8.93s/it]ELBO: -862403.9:  73%|███████▎  | 11/15 [01:51<00:35,  8.87s/it]ELBO: -863149.1:  73%|███████▎  | 11/15 [02:00<00:35,  8.87s/it]ELBO: -863149.1:  80%|████████  | 12/15 [02:00<00:26,  8.83s/it]ELBO: -862622.9:  80%|████████  | 12/15 [02:08<00:26,  8.83s/it]ELBO: -862622.9:  87%|████████▋ | 13/15 [02:08<00:17,  8.79s/it]ELBO: -862429.4:  87%|████████▋ | 13/15 [02:17<00:17,  8.79s/it]ELBO: -862429.4:  93%|█████████▎| 14/15 [02:17<00:08,  8.75s/it]ELBO: -862343.6:  93%|█████████▎| 14/15 [02:26<00:08,  8.75s/it]ELBO: -862343.6: 100%|██████████| 15/15 [02:26<00:00,  8.77s/it]ELBO: -862343.6: 100%|██████████| 15/15 [02:26<00:00,  9.75s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -2827998.9:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -855527.5:   0%|          | 0/15 [00:26<?, ?it/s] ELBO: -855527.5:   7%|▋         | 1/15 [00:26<06:14, 26.78s/it]ELBO: -855365.5:   7%|▋         | 1/15 [00:35<06:14, 26.78s/it]ELBO: -855365.5:  13%|█▎        | 2/15 [00:35<03:30, 16.16s/it]ELBO: -854646.4:  13%|█▎        | 2/15 [00:44<03:30, 16.16s/it]ELBO: -854646.4:  20%|██        | 3/15 [00:44<02:33, 12.77s/it]ELBO: -855309.4:  20%|██        | 3/15 [00:52<02:33, 12.77s/it]ELBO: -855309.4:  27%|██▋       | 4/15 [00:52<02:02, 11.18s/it]ELBO: -855307.8:  27%|██▋       | 4/15 [01:01<02:02, 11.18s/it]ELBO: -855307.8:  33%|███▎      | 5/15 [01:01<01:42, 10.30s/it]ELBO: -855405.8:  33%|███▎      | 5/15 [01:10<01:42, 10.30s/it]ELBO: -855405.8:  40%|████      | 6/15 [01:10<01:27,  9.75s/it]ELBO: -855559.7:  40%|████      | 6/15 [01:19<01:27,  9.75s/it]ELBO: -855559.7:  47%|████▋     | 7/15 [01:19<01:15,  9.40s/it]ELBO: -855063.6:  47%|████▋     | 7/15 [01:27<01:15,  9.40s/it]ELBO: -855063.6:  53%|█████▎    | 8/15 [01:27<01:04,  9.20s/it]ELBO: -855583.0:  53%|█████▎    | 8/15 [01:36<01:04,  9.20s/it]ELBO: -855583.0:  60%|██████    | 9/15 [01:36<00:54,  9.05s/it]ELBO: -855417.8:  60%|██████    | 9/15 [01:45<00:54,  9.05s/it]ELBO: -855417.8:  67%|██████▋   | 10/15 [01:45<00:44,  8.95s/it]ELBO: -854627.0:  67%|██████▋   | 10/15 [01:54<00:44,  8.95s/it]ELBO: -854627.0:  73%|███████▎  | 11/15 [01:54<00:35,  8.90s/it]ELBO: -855340.8:  73%|███████▎  | 11/15 [02:02<00:35,  8.90s/it]ELBO: -855340.8:  80%|████████  | 12/15 [02:02<00:26,  8.86s/it]ELBO: -854968.3:  80%|████████  | 12/15 [02:11<00:26,  8.86s/it]ELBO: -854968.3:  87%|████████▋ | 13/15 [02:11<00:17,  8.85s/it]ELBO: -855866.4:  87%|████████▋ | 13/15 [02:20<00:17,  8.85s/it]ELBO: -855866.4:  93%|█████████▎| 14/15 [02:20<00:08,  8.81s/it]ELBO: -855266.2:  93%|█████████▎| 14/15 [02:29<00:08,  8.81s/it]ELBO: -855266.2: 100%|██████████| 15/15 [02:29<00:00,  8.79s/it]ELBO: -855266.2: 100%|██████████| 15/15 [02:29<00:00,  9.94s/it]
