Processed spikes from trial 100.
Processed spikes from trial 200.
Processed spikes from trial 300.
  0%|          | 0/1 [00:00<?, ?it/s]ARHMM Initialization restarts:   0%|          | 0/1 [00:00<?, ?it/s]Initializing with an ARHMM using 25 steps of EM.

  0%|          | 0/25 [00:00<?, ?it/s][A
LP: -5089814.1:   0%|          | 0/25 [00:00<?, ?it/s][A
LP: -5089814.1:   0%|          | 0/25 [00:02<?, ?it/s][A
LP: -5089814.1:   4%|▍         | 1/25 [00:02<00:48,  2.04s/it][A
LP: -5089814.1:   4%|▍         | 1/25 [00:03<00:48,  2.04s/it][A
LP: -5089814.1:   8%|▊         | 2/25 [00:03<00:41,  1.82s/it][A
LP: -5089814.1:   8%|▊         | 2/25 [00:05<00:41,  1.82s/it][A
LP: -5089814.1:  12%|█▏        | 3/25 [00:05<00:38,  1.75s/it][A
LP: -5089814.1:  12%|█▏        | 3/25 [00:07<00:38,  1.75s/it][A
LP: -5089814.1:  16%|█▌        | 4/25 [00:07<00:36,  1.72s/it][A
LP: -5089814.1:  16%|█▌        | 4/25 [00:08<00:36,  1.72s/it][A
LP: -5089814.1:  20%|██        | 5/25 [00:08<00:34,  1.71s/it][A
LP: -5089814.1:  20%|██        | 5/25 [00:10<00:34,  1.71s/it][A
LP: -5089814.1:  24%|██▍       | 6/25 [00:10<00:32,  1.70s/it][A
LP: -5089814.1:  24%|██▍       | 6/25 [00:12<00:32,  1.70s/it][A
LP: -5089814.1:  28%|██▊       | 7/25 [00:12<00:30,  1.69s/it][A
LP: -5089814.1:  28%|██▊       | 7/25 [00:13<00:30,  1.69s/it][A
LP: -5089814.1:  32%|███▏      | 8/25 [00:13<00:28,  1.69s/it][A
LP: -5089814.1:  32%|███▏      | 8/25 [00:15<00:28,  1.69s/it][A
LP: -5089814.1:  36%|███▌      | 9/25 [00:15<00:27,  1.69s/it][A
LP: -5089814.1:  36%|███▌      | 9/25 [00:17<00:27,  1.69s/it][A
LP: -5089814.1:  40%|████      | 10/25 [00:17<00:25,  1.69s/it][A
LP: -5089814.1:  40%|████      | 10/25 [00:18<00:25,  1.69s/it][A
LP: -5089814.1:  44%|████▍     | 11/25 [00:18<00:23,  1.69s/it][A
LP: -5089814.1:  44%|████▍     | 11/25 [00:20<00:23,  1.69s/it][A
LP: -5089814.1:  48%|████▊     | 12/25 [00:20<00:21,  1.69s/it][A
LP: -5089814.1:  48%|████▊     | 12/25 [00:22<00:21,  1.69s/it][A
LP: -5089814.1:  52%|█████▏    | 13/25 [00:22<00:20,  1.69s/it][A
LP: -5089814.1:  52%|█████▏    | 13/25 [00:23<00:20,  1.69s/it][A
LP: -5089814.1:  56%|█████▌    | 14/25 [00:23<00:18,  1.68s/it][A
LP: -5089814.1:  56%|█████▌    | 14/25 [00:25<00:18,  1.68s/it][A
LP: -5089814.1:  60%|██████    | 15/25 [00:25<00:16,  1.68s/it][A
LP: -5089814.1:  60%|██████    | 15/25 [00:27<00:16,  1.68s/it][A
LP: -5089814.1:  64%|██████▍   | 16/25 [00:27<00:15,  1.68s/it][A
LP: -5089814.1:  64%|██████▍   | 16/25 [00:28<00:15,  1.68s/it][A
LP: -5089814.1:  68%|██████▊   | 17/25 [00:28<00:13,  1.68s/it][A
LP: -5089814.1:  68%|██████▊   | 17/25 [00:30<00:13,  1.68s/it][A
LP: -5089814.1:  72%|███████▏  | 18/25 [00:30<00:11,  1.69s/it][A
LP: -5089814.1:  72%|███████▏  | 18/25 [00:32<00:11,  1.69s/it][A
LP: -5089814.1:  76%|███████▌  | 19/25 [00:32<00:10,  1.68s/it][A
LP: -5089814.1:  76%|███████▌  | 19/25 [00:33<00:10,  1.68s/it][A
LP: -5089814.1:  80%|████████  | 20/25 [00:33<00:08,  1.68s/it][A
LP: -5089814.1:  80%|████████  | 20/25 [00:35<00:08,  1.68s/it][A
LP: -5089814.1:  84%|████████▍ | 21/25 [00:35<00:06,  1.68s/it][A
LP: -5089814.1:  84%|████████▍ | 21/25 [00:37<00:06,  1.68s/it][A
LP: -5089814.1:  88%|████████▊ | 22/25 [00:37<00:05,  1.68s/it][A
LP: -5089814.1:  88%|████████▊ | 22/25 [00:39<00:05,  1.68s/it][A
LP: -5089814.1:  92%|█████████▏| 23/25 [00:39<00:03,  1.68s/it][A
LP: -5089814.1:  92%|█████████▏| 23/25 [00:40<00:03,  1.68s/it][A
LP: -5089814.1:  96%|█████████▌| 24/25 [00:40<00:01,  1.68s/it][A
LP: -5089814.1:  96%|█████████▌| 24/25 [00:42<00:01,  1.68s/it][A
LP: -5089814.1: 100%|██████████| 25/25 [00:42<00:00,  1.68s/it][ALP: -5089814.1: 100%|██████████| 25/25 [00:42<00:00,  1.70s/it]
ARHMM Initialization restarts: 100%|██████████| 1/1 [00:44<00:00, 44.64s/it]ARHMM Initialization restarts: 100%|██████████| 1/1 [00:44<00:00, 44.64s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -10757907.3:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -4576630.9:   0%|          | 0/15 [07:19<?, ?it/s] ELBO: -4576630.9:   7%|▋         | 1/15 [07:19<1:42:36, 439.75s/it]ELBO: -4510194.2:   7%|▋         | 1/15 [12:57<1:42:36, 439.75s/it]ELBO: -4510194.2:  13%|█▎        | 2/15 [12:57<1:22:14, 379.55s/it]ELBO: -4477014.1:  13%|█▎        | 2/15 [18:06<1:22:14, 379.55s/it]ELBO: -4477014.1:  20%|██        | 3/15 [18:06<1:09:27, 347.28s/it]ELBO: -4458932.4:  20%|██        | 3/15 [23:16<1:09:27, 347.28s/it]ELBO: -4458932.4:  27%|██▋       | 4/15 [23:16<1:01:00, 332.78s/it]ELBO: -4447385.8:  27%|██▋       | 4/15 [28:28<1:01:00, 332.78s/it]ELBO: -4447385.8:  33%|███▎      | 5/15 [28:28<54:13, 325.36s/it]  ELBO: -4437078.0:  33%|███▎      | 5/15 [33:42<54:13, 325.36s/it]ELBO: -4437078.0:  40%|████      | 6/15 [33:42<48:13, 321.54s/it]ELBO: -4433319.1:  40%|████      | 6/15 [38:55<48:13, 321.54s/it]ELBO: -4433319.1:  47%|████▋     | 7/15 [38:55<42:27, 318.49s/it]ELBO: -4428365.1:  47%|████▋     | 7/15 [44:07<42:27, 318.49s/it]ELBO: -4428365.1:  53%|█████▎    | 8/15 [44:07<36:56, 316.63s/it]ELBO: -4423091.3:  53%|█████▎    | 8/15 [49:16<36:56, 316.63s/it]ELBO: -4423091.3:  60%|██████    | 9/15 [49:16<31:24, 314.11s/it]ELBO: -4418021.5:  60%|██████    | 9/15 [54:25<31:24, 314.11s/it]ELBO: -4418021.5:  67%|██████▋   | 10/15 [54:25<26:03, 312.66s/it]ELBO: -4417007.3:  67%|██████▋   | 10/15 [59:35<26:03, 312.66s/it]ELBO: -4417007.3:  73%|███████▎  | 11/15 [59:35<20:46, 311.66s/it]ELBO: -4412502.6:  73%|███████▎  | 11/15 [1:04:45<20:46, 311.66s/it]ELBO: -4412502.6:  80%|████████  | 12/15 [1:04:45<15:34, 311.35s/it]ELBO: -4411301.7:  80%|████████  | 12/15 [1:09:54<15:34, 311.35s/it]ELBO: -4411301.7:  87%|████████▋ | 13/15 [1:09:54<10:20, 310.41s/it]ELBO: -4410112.1:  87%|████████▋ | 13/15 [1:15:00<10:20, 310.41s/it]ELBO: -4410112.1:  93%|█████████▎| 14/15 [1:15:00<05:09, 309.25s/it]ELBO: -4408607.0:  93%|█████████▎| 14/15 [1:20:10<05:09, 309.25s/it]ELBO: -4408607.0: 100%|██████████| 15/15 [1:20:10<00:00, 309.45s/it]ELBO: -4408607.0: 100%|██████████| 15/15 [1:20:10<00:00, 320.70s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -23955812.3:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -904607.9:   0%|          | 0/15 [02:12<?, ?it/s]  ELBO: -904607.9:   7%|▋         | 1/15 [02:12<30:50, 132.18s/it]ELBO: -903422.1:   7%|▋         | 1/15 [03:01<30:50, 132.18s/it]ELBO: -903422.1:  13%|█▎        | 2/15 [03:01<18:06, 83.59s/it] ELBO: -903505.0:  13%|█▎        | 2/15 [03:51<18:06, 83.59s/it]ELBO: -903505.0:  20%|██        | 3/15 [03:51<13:35, 67.93s/it]ELBO: -904080.7:  20%|██        | 3/15 [04:41<13:35, 67.93s/it]ELBO: -904080.7:  27%|██▋       | 4/15 [04:41<11:10, 60.97s/it]ELBO: -904003.3:  27%|██▋       | 4/15 [05:30<11:10, 60.97s/it]ELBO: -904003.3:  33%|███▎      | 5/15 [05:30<09:28, 56.86s/it]ELBO: -904138.8:  33%|███▎      | 5/15 [06:19<09:28, 56.86s/it]ELBO: -904138.8:  40%|████      | 6/15 [06:19<08:07, 54.17s/it]ELBO: -903851.4:  40%|████      | 6/15 [07:09<08:07, 54.17s/it]ELBO: -903851.4:  47%|████▋     | 7/15 [07:09<07:00, 52.58s/it]ELBO: -904380.1:  47%|████▋     | 7/15 [07:58<07:00, 52.58s/it]ELBO: -904380.1:  53%|█████▎    | 8/15 [07:58<05:59, 51.40s/it]ELBO: -904442.7:  53%|█████▎    | 8/15 [08:47<05:59, 51.40s/it]ELBO: -904442.7:  60%|██████    | 9/15 [08:47<05:03, 50.64s/it]ELBO: -904088.0:  60%|██████    | 9/15 [09:35<05:03, 50.64s/it]ELBO: -904088.0:  67%|██████▋   | 10/15 [09:35<04:10, 50.06s/it]ELBO: -903450.1:  67%|██████▋   | 10/15 [10:24<04:10, 50.06s/it]ELBO: -903450.1:  73%|███████▎  | 11/15 [10:24<03:18, 49.74s/it]ELBO: -905021.7:  73%|███████▎  | 11/15 [11:13<03:18, 49.74s/it]ELBO: -905021.7:  80%|████████  | 12/15 [11:13<02:28, 49.46s/it]ELBO: -903974.0:  80%|████████  | 12/15 [12:02<02:28, 49.46s/it]ELBO: -903974.0:  87%|████████▋ | 13/15 [12:02<01:38, 49.35s/it]ELBO: -904269.2:  87%|████████▋ | 13/15 [12:52<01:38, 49.35s/it]ELBO: -904269.2:  93%|█████████▎| 14/15 [12:52<00:49, 49.38s/it]ELBO: -903893.2:  93%|█████████▎| 14/15 [13:40<00:49, 49.38s/it]ELBO: -903893.2: 100%|██████████| 15/15 [13:40<00:00, 49.21s/it]ELBO: -903893.2: 100%|██████████| 15/15 [13:40<00:00, 54.73s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -18450188.7:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -801520.0:   0%|          | 0/15 [02:10<?, ?it/s]  ELBO: -801520.0:   7%|▋         | 1/15 [02:10<30:23, 130.21s/it]ELBO: -802375.7:   7%|▋         | 1/15 [02:59<30:23, 130.21s/it]ELBO: -802375.7:  13%|█▎        | 2/15 [02:59<17:53, 82.56s/it] ELBO: -801363.8:  13%|█▎        | 2/15 [03:47<17:53, 82.56s/it]ELBO: -801363.8:  20%|██        | 3/15 [03:47<13:23, 66.96s/it]ELBO: -801348.4:  20%|██        | 3/15 [04:37<13:23, 66.96s/it]ELBO: -801348.4:  27%|██▋       | 4/15 [04:37<11:01, 60.14s/it]ELBO: -801404.9:  27%|██▋       | 4/15 [05:27<11:01, 60.14s/it]ELBO: -801404.9:  33%|███▎      | 5/15 [05:27<09:24, 56.41s/it]ELBO: -802033.0:  33%|███▎      | 5/15 [06:15<09:24, 56.41s/it]ELBO: -802033.0:  40%|████      | 6/15 [06:15<08:03, 53.76s/it]ELBO: -801020.5:  40%|████      | 6/15 [07:05<08:03, 53.76s/it]ELBO: -801020.5:  47%|████▋     | 7/15 [07:05<06:58, 52.35s/it]ELBO: -801338.0:  47%|████▋     | 7/15 [07:54<06:58, 52.35s/it]ELBO: -801338.0:  53%|█████▎    | 8/15 [07:54<05:59, 51.42s/it]ELBO: -801086.3:  53%|█████▎    | 8/15 [08:43<05:59, 51.42s/it]ELBO: -801086.3:  60%|██████    | 9/15 [08:43<05:03, 50.62s/it]ELBO: -800669.3:  60%|██████    | 9/15 [09:33<05:03, 50.62s/it]ELBO: -800669.3:  67%|██████▋   | 10/15 [09:33<04:11, 50.27s/it]ELBO: -800788.2:  67%|██████▋   | 10/15 [10:22<04:11, 50.27s/it]ELBO: -800788.2:  73%|███████▎  | 11/15 [10:22<03:19, 49.98s/it]ELBO: -801387.8:  73%|███████▎  | 11/15 [11:11<03:19, 49.98s/it]ELBO: -801387.8:  80%|████████  | 12/15 [11:11<02:29, 49.69s/it]ELBO: -802604.0:  80%|████████  | 12/15 [12:00<02:29, 49.69s/it]ELBO: -802604.0:  87%|████████▋ | 13/15 [12:00<01:39, 49.61s/it]ELBO: -801139.6:  87%|████████▋ | 13/15 [12:50<01:39, 49.61s/it]ELBO: -801139.6:  93%|█████████▎| 14/15 [12:50<00:49, 49.61s/it]ELBO: -801120.7:  93%|█████████▎| 14/15 [13:39<00:49, 49.61s/it]ELBO: -801120.7: 100%|██████████| 15/15 [13:39<00:00, 49.38s/it]ELBO: -801120.7: 100%|██████████| 15/15 [13:39<00:00, 54.62s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -24511345.2:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -869469.7:   0%|          | 0/15 [02:09<?, ?it/s]  ELBO: -869469.7:   7%|▋         | 1/15 [02:09<30:18, 129.91s/it]ELBO: -870005.7:   7%|▋         | 1/15 [02:58<30:18, 129.91s/it]ELBO: -870005.7:  13%|█▎        | 2/15 [02:58<17:45, 81.99s/it] ELBO: -870028.4:  13%|█▎        | 2/15 [03:46<17:45, 81.99s/it]ELBO: -870028.4:  20%|██        | 3/15 [03:46<13:19, 66.66s/it]ELBO: -869981.1:  20%|██        | 3/15 [04:35<13:19, 66.66s/it]ELBO: -869981.1:  27%|██▋       | 4/15 [04:35<10:56, 59.68s/it]ELBO: -870087.7:  27%|██▋       | 4/15 [05:24<10:56, 59.68s/it]ELBO: -870087.7:  33%|███▎      | 5/15 [05:24<09:17, 55.76s/it]ELBO: -869924.7:  33%|███▎      | 5/15 [06:13<09:17, 55.76s/it]ELBO: -869924.7:  40%|████      | 6/15 [06:13<08:00, 53.38s/it]ELBO: -869837.7:  40%|████      | 6/15 [07:02<08:00, 53.38s/it]ELBO: -869837.7:  47%|████▋     | 7/15 [07:02<06:55, 51.91s/it]ELBO: -869449.9:  47%|████▋     | 7/15 [07:51<06:55, 51.91s/it]ELBO: -869449.9:  53%|█████▎    | 8/15 [07:51<05:57, 51.07s/it]ELBO: -869612.8:  53%|█████▎    | 8/15 [08:40<05:57, 51.07s/it]ELBO: -869612.8:  60%|██████    | 9/15 [08:40<05:01, 50.28s/it]ELBO: -869615.4:  60%|██████    | 9/15 [09:28<05:01, 50.28s/it]ELBO: -869615.4:  67%|██████▋   | 10/15 [09:28<04:09, 49.81s/it]ELBO: -870033.0:  67%|██████▋   | 10/15 [10:17<04:09, 49.81s/it]ELBO: -870033.0:  73%|███████▎  | 11/15 [10:17<03:18, 49.53s/it]ELBO: -869899.3:  73%|███████▎  | 11/15 [11:06<03:18, 49.53s/it]ELBO: -869899.3:  80%|████████  | 12/15 [11:06<02:28, 49.41s/it]ELBO: -870315.1:  80%|████████  | 12/15 [11:55<02:28, 49.41s/it]ELBO: -870315.1:  87%|████████▋ | 13/15 [11:55<01:38, 49.25s/it]ELBO: -869744.0:  87%|████████▋ | 13/15 [12:44<01:38, 49.25s/it]ELBO: -869744.0:  93%|█████████▎| 14/15 [12:44<00:49, 49.10s/it]ELBO: -869696.4:  93%|█████████▎| 14/15 [13:33<00:49, 49.10s/it]ELBO: -869696.4: 100%|██████████| 15/15 [13:33<00:00, 49.07s/it]ELBO: -869696.4: 100%|██████████| 15/15 [13:33<00:00, 54.23s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -21483603.5:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -860105.4:   0%|          | 0/15 [02:10<?, ?it/s]  ELBO: -860105.4:   7%|▋         | 1/15 [02:10<30:32, 130.86s/it]ELBO: -860410.0:   7%|▋         | 1/15 [03:00<30:32, 130.86s/it]ELBO: -860410.0:  13%|█▎        | 2/15 [03:00<17:57, 82.91s/it] ELBO: -858790.1:  13%|█▎        | 2/15 [03:49<17:57, 82.91s/it]ELBO: -858790.1:  20%|██        | 3/15 [03:49<13:31, 67.62s/it]ELBO: -859396.3:  20%|██        | 3/15 [04:38<13:31, 67.62s/it]ELBO: -859396.3:  27%|██▋       | 4/15 [04:38<11:04, 60.37s/it]ELBO: -861216.8:  27%|██▋       | 4/15 [05:27<11:04, 60.37s/it]ELBO: -861216.8:  33%|███▎      | 5/15 [05:27<09:22, 56.28s/it]ELBO: -859961.9:  33%|███▎      | 5/15 [06:16<09:22, 56.28s/it]ELBO: -859961.9:  40%|████      | 6/15 [06:16<08:03, 53.74s/it]ELBO: -860563.0:  40%|████      | 6/15 [07:06<08:03, 53.74s/it]ELBO: -860563.0:  47%|████▋     | 7/15 [07:06<06:58, 52.35s/it]ELBO: -859538.2:  47%|████▋     | 7/15 [07:54<06:58, 52.35s/it]ELBO: -859538.2:  53%|█████▎    | 8/15 [07:54<05:58, 51.19s/it]ELBO: -860413.1:  53%|█████▎    | 8/15 [08:43<05:58, 51.19s/it]ELBO: -860413.1:  60%|██████    | 9/15 [08:43<05:02, 50.42s/it]ELBO: -859351.8:  60%|██████    | 9/15 [09:32<05:02, 50.42s/it]ELBO: -859351.8:  67%|██████▋   | 10/15 [09:32<04:10, 50.07s/it]ELBO: -860405.3:  67%|██████▋   | 10/15 [10:21<04:10, 50.07s/it]ELBO: -860405.3:  73%|███████▎  | 11/15 [10:21<03:18, 49.58s/it]ELBO: -859352.3:  73%|███████▎  | 11/15 [11:10<03:18, 49.58s/it]ELBO: -859352.3:  80%|████████  | 12/15 [11:10<02:28, 49.38s/it]ELBO: -860300.6:  80%|████████  | 12/15 [11:59<02:28, 49.38s/it]ELBO: -860300.6:  87%|████████▋ | 13/15 [11:59<01:38, 49.26s/it]ELBO: -859928.0:  87%|████████▋ | 13/15 [12:47<01:38, 49.26s/it]ELBO: -859928.0:  93%|█████████▎| 14/15 [12:47<00:49, 49.08s/it]ELBO: -860426.7:  93%|█████████▎| 14/15 [13:36<00:49, 49.08s/it]ELBO: -860426.7: 100%|██████████| 15/15 [13:36<00:00, 48.95s/it]ELBO: -860426.7: 100%|██████████| 15/15 [13:36<00:00, 54.44s/it]
