Processed spikes from trial 100.
Processed spikes from trial 200.
Processed spikes from trial 300.
  0%|          | 0/1 [00:00<?, ?it/s]ARHMM Initialization restarts:   0%|          | 0/1 [00:00<?, ?it/s]Initializing with an ARHMM using 25 steps of EM.

  0%|          | 0/25 [00:00<?, ?it/s][A
LP: -4384647.0:   0%|          | 0/25 [00:00<?, ?it/s][A
LP: -4384647.0:   0%|          | 0/25 [00:01<?, ?it/s][A
LP: -4384647.0:   4%|▍         | 1/25 [00:01<00:29,  1.21s/it][A
LP: -4384647.0:   4%|▍         | 1/25 [00:02<00:29,  1.21s/it][A
LP: -4384647.0:   8%|▊         | 2/25 [00:02<00:28,  1.24s/it][A
LP: -4384647.0:   8%|▊         | 2/25 [00:03<00:28,  1.24s/it][A
LP: -4384647.0:  12%|█▏        | 3/25 [00:03<00:27,  1.23s/it][A
LP: -4384647.0:  12%|█▏        | 3/25 [00:04<00:27,  1.23s/it][A
LP: -4384647.0:  16%|█▌        | 4/25 [00:04<00:25,  1.23s/it][A
LP: -4384647.0:  16%|█▌        | 4/25 [00:06<00:25,  1.23s/it][A
LP: -4384647.0:  20%|██        | 5/25 [00:06<00:24,  1.24s/it][A
LP: -4384647.0:  20%|██        | 5/25 [00:07<00:24,  1.24s/it][A
LP: -4384647.0:  24%|██▍       | 6/25 [00:07<00:23,  1.23s/it][A
LP: -4384647.0:  24%|██▍       | 6/25 [00:08<00:23,  1.23s/it][A
LP: -4384647.0:  28%|██▊       | 7/25 [00:08<00:22,  1.23s/it][A
LP: -4384647.0:  28%|██▊       | 7/25 [00:09<00:22,  1.23s/it][A
LP: -4384647.0:  32%|███▏      | 8/25 [00:09<00:21,  1.24s/it][A
LP: -4384647.0:  32%|███▏      | 8/25 [00:11<00:21,  1.24s/it][A
LP: -4384647.0:  36%|███▌      | 9/25 [00:11<00:20,  1.30s/it][A
LP: -4384647.0:  36%|███▌      | 9/25 [00:12<00:20,  1.30s/it][A
LP: -4384647.0:  40%|████      | 10/25 [00:12<00:19,  1.29s/it][A
LP: -4384647.0:  40%|████      | 10/25 [00:13<00:19,  1.29s/it][A
LP: -4384647.0:  44%|████▍     | 11/25 [00:13<00:18,  1.33s/it][A
LP: -4384647.0:  44%|████▍     | 11/25 [00:15<00:18,  1.33s/it][A
LP: -4384647.0:  48%|████▊     | 12/25 [00:15<00:16,  1.30s/it][A
LP: -4384647.0:  48%|████▊     | 12/25 [00:16<00:16,  1.30s/it][A
LP: -4384647.0:  52%|█████▏    | 13/25 [00:16<00:15,  1.29s/it][A
LP: -4384647.0:  52%|█████▏    | 13/25 [00:17<00:15,  1.29s/it][A
LP: -4384647.0:  56%|█████▌    | 14/25 [00:17<00:13,  1.27s/it][A
LP: -4384647.0:  56%|█████▌    | 14/25 [00:18<00:13,  1.27s/it][A
LP: -4384647.0:  60%|██████    | 15/25 [00:18<00:12,  1.27s/it][A
LP: -4384647.0:  60%|██████    | 15/25 [00:20<00:12,  1.27s/it][A
LP: -4384647.0:  64%|██████▍   | 16/25 [00:20<00:11,  1.26s/it][A
LP: -4384647.0:  64%|██████▍   | 16/25 [00:21<00:11,  1.26s/it][A
LP: -4384647.0:  68%|██████▊   | 17/25 [00:21<00:10,  1.26s/it][A
LP: -4384647.0:  68%|██████▊   | 17/25 [00:22<00:10,  1.26s/it][A
LP: -4384647.0:  72%|███████▏  | 18/25 [00:22<00:08,  1.26s/it][A
LP: -4384647.0:  72%|███████▏  | 18/25 [00:24<00:08,  1.26s/it][A
LP: -4384647.0:  76%|███████▌  | 19/25 [00:24<00:07,  1.26s/it][A
LP: -4384647.0:  76%|███████▌  | 19/25 [00:25<00:07,  1.26s/it][A
LP: -4384647.0:  80%|████████  | 20/25 [00:25<00:06,  1.25s/it][A
LP: -4384647.0:  80%|████████  | 20/25 [00:26<00:06,  1.25s/it][A
LP: -4384647.0:  84%|████████▍ | 21/25 [00:26<00:05,  1.30s/it][A
LP: -4384647.0:  84%|████████▍ | 21/25 [00:27<00:05,  1.30s/it][A
LP: -4384647.0:  88%|████████▊ | 22/25 [00:27<00:03,  1.28s/it][A
LP: -4384647.0:  88%|████████▊ | 22/25 [00:29<00:03,  1.28s/it][A
LP: -4384647.0:  92%|█████████▏| 23/25 [00:29<00:02,  1.27s/it][A
LP: -4384647.0:  92%|█████████▏| 23/25 [00:30<00:02,  1.27s/it][A
LP: -4384647.0:  96%|█████████▌| 24/25 [00:30<00:01,  1.26s/it][A
LP: -4384647.0:  96%|█████████▌| 24/25 [00:31<00:01,  1.26s/it][A
LP: -4384647.0: 100%|██████████| 25/25 [00:31<00:00,  1.26s/it][ALP: -4384647.0: 100%|██████████| 25/25 [00:31<00:00,  1.27s/it]
ARHMM Initialization restarts: 100%|██████████| 1/1 [00:33<00:00, 33.19s/it]ARHMM Initialization restarts: 100%|██████████| 1/1 [00:33<00:00, 33.19s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -9849849.5:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -4585269.9:   0%|          | 0/15 [05:09<?, ?it/s]ELBO: -4585269.9:   7%|▋         | 1/15 [05:09<1:12:12, 309.45s/it]ELBO: -4523835.3:   7%|▋         | 1/15 [09:06<1:12:12, 309.45s/it]ELBO: -4523835.3:  13%|█▎        | 2/15 [09:06<57:45, 266.60s/it]  ELBO: -4496007.8:  13%|█▎        | 2/15 [12:42<57:45, 266.60s/it]ELBO: -4496007.8:  20%|██        | 3/15 [12:42<48:42, 243.55s/it]ELBO: -4479108.7:  20%|██        | 3/15 [16:20<48:42, 243.55s/it]ELBO: -4479108.7:  27%|██▋       | 4/15 [16:20<42:48, 233.47s/it]ELBO: -4467795.3:  27%|██▋       | 4/15 [19:59<42:48, 233.47s/it]ELBO: -4467795.3:  33%|███▎      | 5/15 [19:59<38:04, 228.44s/it]ELBO: -4459380.9:  33%|███▎      | 5/15 [23:38<38:04, 228.44s/it]ELBO: -4459380.9:  40%|████      | 6/15 [23:38<33:47, 225.26s/it]ELBO: -4453660.0:  40%|████      | 6/15 [27:16<33:47, 225.26s/it]ELBO: -4453660.0:  47%|████▋     | 7/15 [27:16<29:41, 222.73s/it]ELBO: -4446660.8:  47%|████▋     | 7/15 [30:51<29:41, 222.73s/it]ELBO: -4446660.8:  53%|█████▎    | 8/15 [30:51<25:42, 220.41s/it]ELBO: -4442380.4:  53%|█████▎    | 8/15 [34:27<25:42, 220.41s/it]ELBO: -4442380.4:  60%|██████    | 9/15 [34:27<21:53, 218.94s/it]ELBO: -4438976.9:  60%|██████    | 9/15 [38:02<21:53, 218.94s/it]ELBO: -4438976.9:  67%|██████▋   | 10/15 [38:02<18:08, 217.73s/it]ELBO: -4437561.9:  67%|██████▋   | 10/15 [41:38<18:08, 217.73s/it]ELBO: -4437561.9:  73%|███████▎  | 11/15 [41:38<14:28, 217.06s/it]ELBO: -4436196.8:  73%|███████▎  | 11/15 [45:10<14:28, 217.06s/it]ELBO: -4436196.8:  80%|████████  | 12/15 [45:10<10:46, 215.60s/it]ELBO: -4431819.7:  80%|████████  | 12/15 [48:42<10:46, 215.60s/it]ELBO: -4431819.7:  87%|████████▋ | 13/15 [48:42<07:08, 214.42s/it]ELBO: -4427710.2:  87%|████████▋ | 13/15 [52:13<07:08, 214.42s/it]ELBO: -4427710.2:  93%|█████████▎| 14/15 [52:13<03:33, 213.63s/it]ELBO: -4428360.7:  93%|█████████▎| 14/15 [55:45<03:33, 213.63s/it]ELBO: -4428360.7: 100%|██████████| 15/15 [55:45<00:00, 213.17s/it]ELBO: -4428360.7: 100%|██████████| 15/15 [55:45<00:00, 223.06s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -13457631.1:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -884388.5:   0%|          | 0/15 [01:19<?, ?it/s]  ELBO: -884388.5:   7%|▋         | 1/15 [01:19<18:28, 79.20s/it]ELBO: -884735.3:   7%|▋         | 1/15 [01:51<18:28, 79.20s/it]ELBO: -884735.3:  13%|█▎        | 2/15 [01:51<11:11, 51.63s/it]ELBO: -884780.2:  13%|█▎        | 2/15 [02:23<11:11, 51.63s/it]ELBO: -884780.2:  20%|██        | 3/15 [02:23<08:33, 42.77s/it]ELBO: -884230.3:  20%|██        | 3/15 [02:56<08:33, 42.77s/it]ELBO: -884230.3:  27%|██▋       | 4/15 [02:56<07:05, 38.70s/it]ELBO: -884626.5:  27%|██▋       | 4/15 [03:28<07:05, 38.70s/it]ELBO: -884626.5:  33%|███▎      | 5/15 [03:28<06:04, 36.45s/it]ELBO: -884177.4:  33%|███▎      | 5/15 [04:01<06:04, 36.45s/it]ELBO: -884177.4:  40%|████      | 6/15 [04:01<05:15, 35.08s/it]ELBO: -884318.0:  40%|████      | 6/15 [04:33<05:15, 35.08s/it]ELBO: -884318.0:  47%|████▋     | 7/15 [04:33<04:33, 34.15s/it]ELBO: -884248.7:  47%|████▋     | 7/15 [05:05<04:33, 34.15s/it]ELBO: -884248.7:  53%|█████▎    | 8/15 [05:05<03:54, 33.56s/it]ELBO: -884427.1:  53%|█████▎    | 8/15 [05:37<03:54, 33.56s/it]ELBO: -884427.1:  60%|██████    | 9/15 [05:37<03:19, 33.17s/it]ELBO: -884573.8:  60%|██████    | 9/15 [06:10<03:19, 33.17s/it]ELBO: -884573.8:  67%|██████▋   | 10/15 [06:10<02:44, 32.90s/it]ELBO: -884218.1:  67%|██████▋   | 10/15 [06:42<02:44, 32.90s/it]ELBO: -884218.1:  73%|███████▎  | 11/15 [06:42<02:10, 32.71s/it]ELBO: -884328.2:  73%|███████▎  | 11/15 [07:14<02:10, 32.71s/it]ELBO: -884328.2:  80%|████████  | 12/15 [07:14<01:37, 32.64s/it]ELBO: -885290.4:  80%|████████  | 12/15 [07:47<01:37, 32.64s/it]ELBO: -885290.4:  87%|████████▋ | 13/15 [07:47<01:05, 32.57s/it]ELBO: -884268.4:  87%|████████▋ | 13/15 [08:20<01:05, 32.57s/it]ELBO: -884268.4:  93%|█████████▎| 14/15 [08:20<00:32, 32.63s/it]ELBO: -883893.3:  93%|█████████▎| 14/15 [08:52<00:32, 32.63s/it]ELBO: -883893.3: 100%|██████████| 15/15 [08:52<00:00, 32.50s/it]ELBO: -883893.3: 100%|██████████| 15/15 [08:52<00:00, 35.49s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -12803716.8:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -788355.1:   0%|          | 0/15 [01:23<?, ?it/s]  ELBO: -788355.1:   7%|▋         | 1/15 [01:23<19:24, 83.16s/it]ELBO: -789433.8:   7%|▋         | 1/15 [01:55<19:24, 83.16s/it]ELBO: -789433.8:  13%|█▎        | 2/15 [01:55<11:32, 53.30s/it]ELBO: -787864.5:  13%|█▎        | 2/15 [02:27<11:32, 53.30s/it]ELBO: -787864.5:  20%|██        | 3/15 [02:27<08:44, 43.71s/it]ELBO: -789417.7:  20%|██        | 3/15 [03:00<08:44, 43.71s/it]ELBO: -789417.7:  27%|██▋       | 4/15 [03:00<07:12, 39.29s/it]ELBO: -787582.4:  27%|██▋       | 4/15 [03:32<07:12, 39.29s/it]ELBO: -787582.4:  33%|███▎      | 5/15 [03:32<06:08, 36.83s/it]ELBO: -788192.7:  33%|███▎      | 5/15 [04:05<06:08, 36.83s/it]ELBO: -788192.7:  40%|████      | 6/15 [04:05<05:18, 35.35s/it]ELBO: -788454.3:  40%|████      | 6/15 [04:37<05:18, 35.35s/it]ELBO: -788454.3:  47%|████▋     | 7/15 [04:37<04:35, 34.45s/it]ELBO: -788167.4:  47%|████▋     | 7/15 [05:10<04:35, 34.45s/it]ELBO: -788167.4:  53%|█████▎    | 8/15 [05:10<03:57, 33.90s/it]ELBO: -788463.7:  53%|█████▎    | 8/15 [05:43<03:57, 33.90s/it]ELBO: -788463.7:  60%|██████    | 9/15 [05:43<03:20, 33.44s/it]ELBO: -788276.7:  60%|██████    | 9/15 [06:15<03:20, 33.44s/it]ELBO: -788276.7:  67%|██████▋   | 10/15 [06:15<02:46, 33.27s/it]ELBO: -788573.2:  67%|██████▋   | 10/15 [06:48<02:46, 33.27s/it]ELBO: -788573.2:  73%|███████▎  | 11/15 [06:48<02:12, 33.00s/it]ELBO: -789189.6:  73%|███████▎  | 11/15 [07:21<02:12, 33.00s/it]ELBO: -789189.6:  80%|████████  | 12/15 [07:21<01:38, 32.92s/it]ELBO: -787921.5:  80%|████████  | 12/15 [07:53<01:38, 32.92s/it]ELBO: -787921.5:  87%|████████▋ | 13/15 [07:53<01:05, 32.82s/it]ELBO: -789711.4:  87%|████████▋ | 13/15 [08:26<01:05, 32.82s/it]ELBO: -789711.4:  93%|█████████▎| 14/15 [08:26<00:32, 32.76s/it]ELBO: -787685.2:  93%|█████████▎| 14/15 [08:58<00:32, 32.76s/it]ELBO: -787685.2: 100%|██████████| 15/15 [08:58<00:00, 32.71s/it]ELBO: -787685.2: 100%|██████████| 15/15 [08:58<00:00, 35.93s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -13742305.7:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -849052.8:   0%|          | 0/15 [01:36<?, ?it/s]  ELBO: -849052.8:   7%|▋         | 1/15 [01:36<22:29, 96.36s/it]ELBO: -848376.3:   7%|▋         | 1/15 [02:08<22:29, 96.36s/it]ELBO: -848376.3:  13%|█▎        | 2/15 [02:08<12:40, 58.51s/it]ELBO: -847365.7:  13%|█▎        | 2/15 [02:40<12:40, 58.51s/it]ELBO: -847365.7:  20%|██        | 3/15 [02:40<09:19, 46.59s/it]ELBO: -848338.4:  20%|██        | 3/15 [03:12<09:19, 46.59s/it]ELBO: -848338.4:  27%|██▋       | 4/15 [03:12<07:29, 40.88s/it]ELBO: -848941.2:  27%|██▋       | 4/15 [03:45<07:29, 40.88s/it]ELBO: -848941.2:  33%|███▎      | 5/15 [03:45<06:19, 37.92s/it]ELBO: -849079.6:  33%|███▎      | 5/15 [04:17<06:19, 37.92s/it]ELBO: -849079.6:  40%|████      | 6/15 [04:17<05:23, 36.00s/it]ELBO: -848669.4:  40%|████      | 6/15 [04:50<05:23, 36.00s/it]ELBO: -848669.4:  47%|████▋     | 7/15 [04:50<04:39, 34.92s/it]ELBO: -848802.1:  47%|████▋     | 7/15 [05:22<04:39, 34.92s/it]ELBO: -848802.1:  53%|█████▎    | 8/15 [05:22<03:58, 34.12s/it]ELBO: -848310.7:  53%|█████▎    | 8/15 [05:55<03:58, 34.12s/it]ELBO: -848310.7:  60%|██████    | 9/15 [05:55<03:21, 33.58s/it]ELBO: -849197.7:  60%|██████    | 9/15 [06:27<03:21, 33.58s/it]ELBO: -849197.7:  67%|██████▋   | 10/15 [06:27<02:46, 33.25s/it]ELBO: -848762.3:  67%|██████▋   | 10/15 [07:00<02:46, 33.25s/it]ELBO: -848762.3:  73%|███████▎  | 11/15 [07:00<02:12, 33.04s/it]ELBO: -848667.0:  73%|███████▎  | 11/15 [07:32<02:12, 33.04s/it]ELBO: -848667.0:  80%|████████  | 12/15 [07:32<01:38, 32.83s/it]ELBO: -848993.3:  80%|████████  | 12/15 [08:05<01:38, 32.83s/it]ELBO: -848993.3:  87%|████████▋ | 13/15 [08:05<01:05, 32.75s/it]ELBO: -848524.3:  87%|████████▋ | 13/15 [08:37<01:05, 32.75s/it]ELBO: -848524.3:  93%|█████████▎| 14/15 [08:37<00:32, 32.61s/it]ELBO: -848431.1:  93%|█████████▎| 14/15 [09:10<00:32, 32.61s/it]ELBO: -848431.1: 100%|██████████| 15/15 [09:10<00:00, 32.55s/it]ELBO: -848431.1: 100%|██████████| 15/15 [09:10<00:00, 36.67s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -12041932.2:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -854734.4:   0%|          | 0/15 [01:24<?, ?it/s]  ELBO: -854734.4:   7%|▋         | 1/15 [01:24<19:45, 84.71s/it]ELBO: -853689.6:   7%|▋         | 1/15 [01:56<19:45, 84.71s/it]ELBO: -853689.6:  13%|█▎        | 2/15 [01:56<11:39, 53.78s/it]ELBO: -853210.7:  13%|█▎        | 2/15 [02:29<11:39, 53.78s/it]ELBO: -853210.7:  20%|██        | 3/15 [02:29<08:48, 44.08s/it]ELBO: -854414.8:  20%|██        | 3/15 [03:01<08:48, 44.08s/it]ELBO: -854414.8:  27%|██▋       | 4/15 [03:01<07:14, 39.46s/it]ELBO: -854196.6:  27%|██▋       | 4/15 [03:34<07:14, 39.46s/it]ELBO: -854196.6:  33%|███▎      | 5/15 [03:34<06:09, 36.93s/it]ELBO: -853739.6:  33%|███▎      | 5/15 [04:06<06:09, 36.93s/it]ELBO: -853739.6:  40%|████      | 6/15 [04:06<05:18, 35.40s/it]ELBO: -855305.5:  40%|████      | 6/15 [04:39<05:18, 35.40s/it]ELBO: -855305.5:  47%|████▋     | 7/15 [04:39<04:35, 34.45s/it]ELBO: -854414.9:  47%|████▋     | 7/15 [05:11<04:35, 34.45s/it]ELBO: -854414.9:  53%|█████▎    | 8/15 [05:11<03:56, 33.78s/it]ELBO: -854003.5:  53%|█████▎    | 8/15 [05:44<03:56, 33.78s/it]ELBO: -854003.5:  60%|██████    | 9/15 [05:44<03:20, 33.40s/it]ELBO: -854137.0:  60%|██████    | 9/15 [06:16<03:20, 33.40s/it]ELBO: -854137.0:  67%|██████▋   | 10/15 [06:16<02:45, 33.11s/it]ELBO: -853974.1:  67%|██████▋   | 10/15 [06:48<02:45, 33.11s/it]ELBO: -853974.1:  73%|███████▎  | 11/15 [06:48<02:11, 32.92s/it]ELBO: -854341.1:  73%|███████▎  | 11/15 [07:21<02:11, 32.92s/it]ELBO: -854341.1:  80%|████████  | 12/15 [07:21<01:38, 32.80s/it]ELBO: -853711.6:  80%|████████  | 12/15 [07:53<01:38, 32.80s/it]ELBO: -853711.6:  87%|████████▋ | 13/15 [07:53<01:05, 32.70s/it]ELBO: -854405.3:  87%|████████▋ | 13/15 [08:26<01:05, 32.70s/it]ELBO: -854405.3:  93%|█████████▎| 14/15 [08:26<00:32, 32.63s/it]ELBO: -853954.3:  93%|█████████▎| 14/15 [08:58<00:32, 32.63s/it]ELBO: -853954.3: 100%|██████████| 15/15 [08:58<00:00, 32.59s/it]ELBO: -853954.3: 100%|██████████| 15/15 [08:58<00:00, 35.93s/it]
