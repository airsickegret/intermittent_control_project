Processed spikes from trial 100.
Processed spikes from trial 200.
Processed spikes from trial 300.
  0%|          | 0/1 [00:00<?, ?it/s]ARHMM Initialization restarts:   0%|          | 0/1 [00:00<?, ?it/s]Initializing with an ARHMM using 25 steps of EM.

  0%|          | 0/25 [00:00<?, ?it/s][A
LP: -5076822.8:   0%|          | 0/25 [00:00<?, ?it/s][A
LP: -5076822.8:   0%|          | 0/25 [00:01<?, ?it/s][A
LP: -5076822.8:   4%|▍         | 1/25 [00:01<00:43,  1.83s/it][A
LP: -5076822.8:   4%|▍         | 1/25 [00:03<00:43,  1.83s/it][A
LP: -5076822.8:   8%|▊         | 2/25 [00:03<00:41,  1.82s/it][A
LP: -5076822.8:   8%|▊         | 2/25 [00:05<00:41,  1.82s/it][A
LP: -5076822.8:  12%|█▏        | 3/25 [00:05<00:40,  1.82s/it][A
LP: -5076822.8:  12%|█▏        | 3/25 [00:07<00:40,  1.82s/it][A
LP: -5076822.8:  16%|█▌        | 4/25 [00:07<00:38,  1.82s/it][A
LP: -5076822.8:  16%|█▌        | 4/25 [00:08<00:38,  1.82s/it][A
LP: -5076822.8:  20%|██        | 5/25 [00:08<00:35,  1.78s/it][A
LP: -5076822.8:  20%|██        | 5/25 [00:10<00:35,  1.78s/it][A
LP: -5076822.8:  24%|██▍       | 6/25 [00:10<00:34,  1.82s/it][A
LP: -5076822.8:  24%|██▍       | 6/25 [00:12<00:34,  1.82s/it][A
LP: -5076822.8:  28%|██▊       | 7/25 [00:12<00:32,  1.78s/it][A
LP: -5076822.8:  28%|██▊       | 7/25 [00:14<00:32,  1.78s/it][A
LP: -5076822.8:  32%|███▏      | 8/25 [00:14<00:29,  1.76s/it][A
LP: -5076822.8:  32%|███▏      | 8/25 [00:16<00:29,  1.76s/it][A
LP: -5076822.8:  36%|███▌      | 9/25 [00:16<00:27,  1.74s/it][A
LP: -5076822.8:  36%|███▌      | 9/25 [00:17<00:27,  1.74s/it][A
LP: -5076822.8:  40%|████      | 10/25 [00:17<00:26,  1.77s/it][A
LP: -5076822.8:  40%|████      | 10/25 [00:19<00:26,  1.77s/it][A
LP: -5076822.8:  44%|████▍     | 11/25 [00:19<00:25,  1.79s/it][A
LP: -5076822.8:  44%|████▍     | 11/25 [00:21<00:25,  1.79s/it][A
LP: -5076822.8:  48%|████▊     | 12/25 [00:21<00:23,  1.80s/it][A
LP: -5076822.8:  48%|████▊     | 12/25 [00:23<00:23,  1.80s/it][A
LP: -5076822.8:  52%|█████▏    | 13/25 [00:23<00:21,  1.81s/it][A
LP: -5076822.8:  52%|█████▏    | 13/25 [00:25<00:21,  1.81s/it][A
LP: -5076822.8:  56%|█████▌    | 14/25 [00:25<00:20,  1.83s/it][A
LP: -5076822.8:  56%|█████▌    | 14/25 [00:27<00:20,  1.83s/it][A
LP: -5076822.8:  60%|██████    | 15/25 [00:27<00:18,  1.83s/it][A
LP: -5076822.8:  60%|██████    | 15/25 [00:28<00:18,  1.83s/it][A
LP: -5076822.8:  64%|██████▍   | 16/25 [00:28<00:16,  1.85s/it][A
LP: -5076822.8:  64%|██████▍   | 16/25 [00:30<00:16,  1.85s/it][A
LP: -5076822.8:  68%|██████▊   | 17/25 [00:30<00:14,  1.85s/it][A
LP: -5076822.8:  68%|██████▊   | 17/25 [00:32<00:14,  1.85s/it][A
LP: -5076822.8:  72%|███████▏  | 18/25 [00:32<00:12,  1.85s/it][A
LP: -5076822.8:  72%|███████▏  | 18/25 [00:34<00:12,  1.85s/it][A
LP: -5076822.8:  76%|███████▌  | 19/25 [00:34<00:11,  1.86s/it][A
LP: -5076822.8:  76%|███████▌  | 19/25 [00:36<00:11,  1.86s/it][A
LP: -5076822.8:  80%|████████  | 20/25 [00:36<00:09,  1.86s/it][A
LP: -5076822.8:  80%|████████  | 20/25 [00:38<00:09,  1.86s/it][A
LP: -5076822.8:  84%|████████▍ | 21/25 [00:38<00:07,  1.86s/it][A
LP: -5076822.8:  84%|████████▍ | 21/25 [00:40<00:07,  1.86s/it][A
LP: -5076822.8:  88%|████████▊ | 22/25 [00:40<00:05,  1.84s/it][A
LP: -5076822.8:  88%|████████▊ | 22/25 [00:41<00:05,  1.84s/it][A
LP: -5076822.8:  92%|█████████▏| 23/25 [00:41<00:03,  1.86s/it][A
LP: -5076822.8:  92%|█████████▏| 23/25 [00:43<00:03,  1.86s/it][A
LP: -5076822.8:  96%|█████████▌| 24/25 [00:43<00:01,  1.85s/it][A
LP: -5076822.8:  96%|█████████▌| 24/25 [00:45<00:01,  1.85s/it][A
LP: -5076822.8: 100%|██████████| 25/25 [00:45<00:00,  1.91s/it][ALP: -5076822.8: 100%|██████████| 25/25 [00:45<00:00,  1.83s/it]
ARHMM Initialization restarts: 100%|██████████| 1/1 [00:48<00:00, 48.07s/it]ARHMM Initialization restarts: 100%|██████████| 1/1 [00:48<00:00, 48.07s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -10774089.8:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -4616824.7:   0%|          | 0/15 [07:27<?, ?it/s] ELBO: -4616824.7:   7%|▋         | 1/15 [07:27<1:44:31, 447.98s/it]ELBO: -4548674.7:   7%|▋         | 1/15 [13:08<1:44:31, 447.98s/it]ELBO: -4548674.7:  13%|█▎        | 2/15 [13:08<1:23:24, 384.95s/it]ELBO: -4516975.5:  13%|█▎        | 2/15 [18:22<1:23:24, 384.95s/it]ELBO: -4516975.5:  20%|██        | 3/15 [18:22<1:10:26, 352.20s/it]ELBO: -4500927.0:  20%|██        | 3/15 [23:39<1:10:26, 352.20s/it]ELBO: -4500927.0:  27%|██▋       | 4/15 [23:39<1:02:04, 338.59s/it]ELBO: -4488053.4:  27%|██▋       | 4/15 [28:57<1:02:04, 338.59s/it]ELBO: -4488053.4:  33%|███▎      | 5/15 [28:57<55:09, 331.00s/it]  ELBO: -4477882.4:  33%|███▎      | 5/15 [34:16<55:09, 331.00s/it]ELBO: -4477882.4:  40%|████      | 6/15 [34:16<49:03, 327.09s/it]ELBO: -4470761.3:  40%|████      | 6/15 [39:33<49:03, 327.09s/it]ELBO: -4470761.3:  47%|████▋     | 7/15 [39:33<43:10, 323.81s/it]ELBO: -4466823.8:  47%|████▋     | 7/15 [44:52<43:10, 323.81s/it]ELBO: -4466823.8:  53%|█████▎    | 8/15 [44:52<37:34, 322.06s/it]ELBO: -4460026.6:  53%|█████▎    | 8/15 [50:06<37:34, 322.06s/it]ELBO: -4460026.6:  60%|██████    | 9/15 [50:06<31:57, 319.62s/it]ELBO: -4457626.5:  60%|██████    | 9/15 [55:19<31:57, 319.62s/it]ELBO: -4457626.5:  67%|██████▋   | 10/15 [55:19<26:28, 317.64s/it]ELBO: -4454670.7:  67%|██████▋   | 10/15 [1:00:34<26:28, 317.64s/it]ELBO: -4454670.7:  73%|███████▎  | 11/15 [1:00:34<21:07, 316.77s/it]ELBO: -4455027.5:  73%|███████▎  | 11/15 [1:05:48<21:07, 316.77s/it]ELBO: -4455027.5:  80%|████████  | 12/15 [1:05:48<15:47, 315.88s/it]ELBO: -4452282.4:  80%|████████  | 12/15 [1:11:01<15:47, 315.88s/it]ELBO: -4452282.4:  87%|████████▋ | 13/15 [1:11:01<10:29, 314.98s/it]ELBO: -4448918.1:  87%|████████▋ | 13/15 [1:16:12<10:29, 314.98s/it]ELBO: -4448918.1:  93%|█████████▎| 14/15 [1:16:12<05:13, 313.84s/it]ELBO: -4445465.8:  93%|█████████▎| 14/15 [1:21:25<05:13, 313.84s/it]ELBO: -4445465.8: 100%|██████████| 15/15 [1:21:25<00:00, 313.54s/it]ELBO: -4445465.8: 100%|██████████| 15/15 [1:21:25<00:00, 325.68s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -21260690.7:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -882007.8:   0%|          | 0/15 [02:03<?, ?it/s]  ELBO: -882007.8:   7%|▋         | 1/15 [02:03<28:51, 123.71s/it]ELBO: -881762.4:   7%|▋         | 1/15 [02:50<28:51, 123.71s/it]ELBO: -881762.4:  13%|█▎        | 2/15 [02:50<17:03, 78.75s/it] ELBO: -882030.0:  13%|█▎        | 2/15 [03:38<17:03, 78.75s/it]ELBO: -882030.0:  20%|██        | 3/15 [03:38<12:52, 64.34s/it]ELBO: -881625.3:  20%|██        | 3/15 [04:25<12:52, 64.34s/it]ELBO: -881625.3:  27%|██▋       | 4/15 [04:25<10:31, 57.43s/it]ELBO: -881276.1:  27%|██▋       | 4/15 [05:11<10:31, 57.43s/it]ELBO: -881276.1:  33%|███▎      | 5/15 [05:11<08:55, 53.53s/it]ELBO: -882151.2:  33%|███▎      | 5/15 [05:58<08:55, 53.53s/it]ELBO: -882151.2:  40%|████      | 6/15 [05:58<07:41, 51.28s/it]ELBO: -881923.3:  40%|████      | 6/15 [06:45<07:41, 51.28s/it]ELBO: -881923.3:  47%|████▋     | 7/15 [06:45<06:38, 49.81s/it]ELBO: -881633.5:  47%|████▋     | 7/15 [07:32<06:38, 49.81s/it]ELBO: -881633.5:  53%|█████▎    | 8/15 [07:32<05:43, 49.08s/it]ELBO: -882192.2:  53%|█████▎    | 8/15 [08:19<05:43, 49.08s/it]ELBO: -882192.2:  60%|██████    | 9/15 [08:19<04:49, 48.30s/it]ELBO: -882235.4:  60%|██████    | 9/15 [09:05<04:49, 48.30s/it]ELBO: -882235.4:  67%|██████▋   | 10/15 [09:05<03:58, 47.72s/it]ELBO: -881727.2:  67%|██████▋   | 10/15 [09:52<03:58, 47.72s/it]ELBO: -881727.2:  73%|███████▎  | 11/15 [09:52<03:10, 47.52s/it]ELBO: -881428.8:  73%|███████▎  | 11/15 [10:39<03:10, 47.52s/it]ELBO: -881428.8:  80%|████████  | 12/15 [10:39<02:22, 47.37s/it]ELBO: -880261.0:  80%|████████  | 12/15 [11:26<02:22, 47.37s/it]ELBO: -880261.0:  87%|████████▋ | 13/15 [11:26<01:34, 47.23s/it]ELBO: -880887.8:  87%|████████▋ | 13/15 [12:14<01:34, 47.23s/it]ELBO: -880887.8:  93%|█████████▎| 14/15 [12:14<00:47, 47.23s/it]ELBO: -881626.1:  93%|█████████▎| 14/15 [13:00<00:47, 47.23s/it]ELBO: -881626.1: 100%|██████████| 15/15 [13:00<00:00, 47.08s/it]ELBO: -881626.1: 100%|██████████| 15/15 [13:00<00:00, 52.05s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -20366715.3:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -800245.3:   0%|          | 0/15 [01:52<?, ?it/s]  ELBO: -800245.3:   7%|▋         | 1/15 [01:52<26:08, 112.03s/it]ELBO: -800004.9:   7%|▋         | 1/15 [02:39<26:08, 112.03s/it]ELBO: -800004.9:  13%|█▎        | 2/15 [02:39<15:59, 73.78s/it] ELBO: -800410.1:  13%|█▎        | 2/15 [03:26<15:59, 73.78s/it]ELBO: -800410.1:  20%|██        | 3/15 [03:26<12:18, 61.57s/it]ELBO: -800906.4:  20%|██        | 3/15 [04:13<12:18, 61.57s/it]ELBO: -800906.4:  27%|██▋       | 4/15 [04:13<10:16, 56.05s/it]ELBO: -800605.3:  27%|██▋       | 4/15 [05:01<10:16, 56.05s/it]ELBO: -800605.3:  33%|███▎      | 5/15 [05:01<08:49, 52.98s/it]ELBO: -800742.4:  33%|███▎      | 5/15 [05:48<08:49, 52.98s/it]ELBO: -800742.4:  40%|████      | 6/15 [05:48<07:39, 51.03s/it]ELBO: -800026.3:  40%|████      | 6/15 [06:35<07:39, 51.03s/it]ELBO: -800026.3:  47%|████▋     | 7/15 [06:35<06:38, 49.83s/it]ELBO: -800001.3:  47%|████▋     | 7/15 [07:23<06:38, 49.83s/it]ELBO: -800001.3:  53%|█████▎    | 8/15 [07:23<05:43, 49.02s/it]ELBO: -800969.5:  53%|█████▎    | 8/15 [08:10<05:43, 49.02s/it]ELBO: -800969.5:  60%|██████    | 9/15 [08:10<04:50, 48.45s/it]ELBO: -800635.8:  60%|██████    | 9/15 [08:57<04:50, 48.45s/it]ELBO: -800635.8:  67%|██████▋   | 10/15 [08:57<04:00, 48.15s/it]ELBO: -800547.1:  67%|██████▋   | 10/15 [09:45<04:00, 48.15s/it]ELBO: -800547.1:  73%|███████▎  | 11/15 [09:45<03:11, 47.89s/it]ELBO: -801439.0:  73%|███████▎  | 11/15 [10:32<03:11, 47.89s/it]ELBO: -801439.0:  80%|████████  | 12/15 [10:32<02:22, 47.62s/it]ELBO: -801364.3:  80%|████████  | 12/15 [11:19<02:22, 47.62s/it]ELBO: -801364.3:  87%|████████▋ | 13/15 [11:19<01:34, 47.48s/it]ELBO: -800897.2:  87%|████████▋ | 13/15 [12:06<01:34, 47.48s/it]ELBO: -800897.2:  93%|█████████▎| 14/15 [12:06<00:47, 47.45s/it]ELBO: -800478.3:  93%|█████████▎| 14/15 [12:53<00:47, 47.45s/it]ELBO: -800478.3: 100%|██████████| 15/15 [12:53<00:00, 47.39s/it]ELBO: -800478.3: 100%|██████████| 15/15 [12:53<00:00, 51.59s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -20079622.0:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -814926.8:   0%|          | 0/15 [02:07<?, ?it/s]  ELBO: -814926.8:   7%|▋         | 1/15 [02:07<29:47, 127.64s/it]ELBO: -815144.3:   7%|▋         | 1/15 [02:54<29:47, 127.64s/it]ELBO: -815144.3:  13%|█▎        | 2/15 [02:54<17:19, 79.98s/it] ELBO: -815119.7:  13%|█▎        | 2/15 [03:41<17:19, 79.98s/it]ELBO: -815119.7:  20%|██        | 3/15 [03:41<12:59, 64.94s/it]ELBO: -815204.7:  20%|██        | 3/15 [04:29<12:59, 64.94s/it]ELBO: -815204.7:  27%|██▋       | 4/15 [04:29<10:40, 58.24s/it]ELBO: -814837.2:  27%|██▋       | 4/15 [05:15<10:40, 58.24s/it]ELBO: -814837.2:  33%|███▎      | 5/15 [05:15<09:00, 54.01s/it]ELBO: -814457.5:  33%|███▎      | 5/15 [06:02<09:00, 54.01s/it]ELBO: -814457.5:  40%|████      | 6/15 [06:02<07:45, 51.70s/it]ELBO: -815267.1:  40%|████      | 6/15 [06:50<07:45, 51.70s/it]ELBO: -815267.1:  47%|████▋     | 7/15 [06:50<06:42, 50.27s/it]ELBO: -814726.6:  47%|████▋     | 7/15 [07:37<06:42, 50.27s/it]ELBO: -814726.6:  53%|█████▎    | 8/15 [07:37<05:44, 49.22s/it]ELBO: -814333.0:  53%|█████▎    | 8/15 [08:24<05:44, 49.22s/it]ELBO: -814333.0:  60%|██████    | 9/15 [08:24<04:50, 48.50s/it]ELBO: -814979.9:  60%|██████    | 9/15 [09:11<04:50, 48.50s/it]ELBO: -814979.9:  67%|██████▋   | 10/15 [09:11<04:00, 48.07s/it]ELBO: -814743.8:  67%|██████▋   | 10/15 [09:58<04:00, 48.07s/it]ELBO: -814743.8:  73%|███████▎  | 11/15 [09:58<03:10, 47.73s/it]ELBO: -815491.0:  73%|███████▎  | 11/15 [10:45<03:10, 47.73s/it]ELBO: -815491.0:  80%|████████  | 12/15 [10:45<02:22, 47.49s/it]ELBO: -815080.3:  80%|████████  | 12/15 [11:32<02:22, 47.49s/it]ELBO: -815080.3:  87%|████████▋ | 13/15 [11:32<01:34, 47.36s/it]ELBO: -815247.6:  87%|████████▋ | 13/15 [12:19<01:34, 47.36s/it]ELBO: -815247.6:  93%|█████████▎| 14/15 [12:19<00:47, 47.26s/it]ELBO: -814697.5:  93%|█████████▎| 14/15 [13:06<00:47, 47.26s/it]ELBO: -814697.5: 100%|██████████| 15/15 [13:06<00:00, 47.20s/it]ELBO: -814697.5: 100%|██████████| 15/15 [13:06<00:00, 52.42s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -19987774.1:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -820124.2:   0%|          | 0/15 [02:02<?, ?it/s]  ELBO: -820124.2:   7%|▋         | 1/15 [02:02<28:40, 122.89s/it]ELBO: -821030.7:   7%|▋         | 1/15 [02:49<28:40, 122.89s/it]ELBO: -821030.7:  13%|█▎        | 2/15 [02:49<16:57, 78.25s/it] ELBO: -819806.8:  13%|█▎        | 2/15 [03:36<16:57, 78.25s/it]ELBO: -819806.8:  20%|██        | 3/15 [03:36<12:46, 63.90s/it]ELBO: -819609.7:  20%|██        | 3/15 [04:23<12:46, 63.90s/it]ELBO: -819609.7:  27%|██▋       | 4/15 [04:23<10:28, 57.12s/it]ELBO: -820739.9:  27%|██▋       | 4/15 [05:10<10:28, 57.12s/it]ELBO: -820739.9:  33%|███▎      | 5/15 [05:10<08:54, 53.47s/it]ELBO: -820422.6:  33%|███▎      | 5/15 [05:57<08:54, 53.47s/it]ELBO: -820422.6:  40%|████      | 6/15 [05:57<07:41, 51.26s/it]ELBO: -820033.6:  40%|████      | 6/15 [06:44<07:41, 51.26s/it]ELBO: -820033.6:  47%|████▋     | 7/15 [06:44<06:38, 49.87s/it]ELBO: -820394.7:  47%|████▋     | 7/15 [07:31<06:38, 49.87s/it]ELBO: -820394.7:  53%|█████▎    | 8/15 [07:31<05:42, 48.90s/it]ELBO: -820732.7:  53%|█████▎    | 8/15 [08:18<05:42, 48.90s/it]ELBO: -820732.7:  60%|██████    | 9/15 [08:18<04:49, 48.30s/it]ELBO: -819523.4:  60%|██████    | 9/15 [09:04<04:49, 48.30s/it]ELBO: -819523.4:  67%|██████▋   | 10/15 [09:04<03:59, 47.83s/it]ELBO: -821131.1:  67%|██████▋   | 10/15 [09:52<03:59, 47.83s/it]ELBO: -821131.1:  73%|███████▎  | 11/15 [09:52<03:10, 47.61s/it]ELBO: -820465.0:  73%|███████▎  | 11/15 [10:39<03:10, 47.61s/it]ELBO: -820465.0:  80%|████████  | 12/15 [10:39<02:22, 47.40s/it]ELBO: -819882.2:  80%|████████  | 12/15 [11:26<02:22, 47.40s/it]ELBO: -819882.2:  87%|████████▋ | 13/15 [11:26<01:34, 47.35s/it]ELBO: -820954.3:  87%|████████▋ | 13/15 [12:13<01:34, 47.35s/it]ELBO: -820954.3:  93%|█████████▎| 14/15 [12:13<00:47, 47.31s/it]ELBO: -819600.4:  93%|█████████▎| 14/15 [13:00<00:47, 47.31s/it]ELBO: -819600.4: 100%|██████████| 15/15 [13:00<00:00, 47.11s/it]ELBO: -819600.4: 100%|██████████| 15/15 [13:00<00:00, 52.01s/it]
