Processed spikes from trial 100.
Processed spikes from trial 200.
Processed spikes from trial 300.
  0%|          | 0/1 [00:00<?, ?it/s]ARHMM Initialization restarts:   0%|          | 0/1 [00:00<?, ?it/s]Initializing with an ARHMM using 25 steps of EM.

  0%|          | 0/25 [00:00<?, ?it/s][A
LP: -1303210.4:   0%|          | 0/25 [00:00<?, ?it/s][A
LP: -1303210.4:   0%|          | 0/25 [00:00<?, ?it/s][A
LP: -1303210.4:   4%|▍         | 1/25 [00:00<00:09,  2.42it/s][A
LP: -1303210.4:   4%|▍         | 1/25 [00:00<00:09,  2.42it/s][A
LP: -1303210.4:   8%|▊         | 2/25 [00:00<00:09,  2.42it/s][A
LP: -1303210.4:   8%|▊         | 2/25 [00:01<00:09,  2.42it/s][A
LP: -1303210.4:  12%|█▏        | 3/25 [00:01<00:09,  2.43it/s][A
LP: -1303210.4:  12%|█▏        | 3/25 [00:01<00:09,  2.43it/s][A
LP: -1303210.4:  16%|█▌        | 4/25 [00:01<00:08,  2.43it/s][A
LP: -1303210.4:  16%|█▌        | 4/25 [00:02<00:08,  2.43it/s][A
LP: -1303210.4:  20%|██        | 5/25 [00:02<00:08,  2.44it/s][A
LP: -1303210.4:  20%|██        | 5/25 [00:02<00:08,  2.44it/s][A
LP: -1303210.4:  24%|██▍       | 6/25 [00:02<00:07,  2.43it/s][A
LP: -1303210.4:  24%|██▍       | 6/25 [00:02<00:07,  2.43it/s][A
LP: -1303210.4:  28%|██▊       | 7/25 [00:02<00:07,  2.45it/s][A
LP: -1303210.4:  28%|██▊       | 7/25 [00:03<00:07,  2.45it/s][A
LP: -1303210.4:  32%|███▏      | 8/25 [00:03<00:06,  2.45it/s][A
LP: -1303210.4:  32%|███▏      | 8/25 [00:03<00:06,  2.45it/s][A
LP: -1303210.4:  36%|███▌      | 9/25 [00:03<00:06,  2.45it/s][A
LP: -1303210.4:  36%|███▌      | 9/25 [00:04<00:06,  2.45it/s][A
LP: -1303210.4:  40%|████      | 10/25 [00:04<00:06,  2.45it/s][A
LP: -1303210.4:  40%|████      | 10/25 [00:04<00:06,  2.45it/s][A
LP: -1303210.4:  44%|████▍     | 11/25 [00:04<00:05,  2.45it/s][A
LP: -1303210.4:  44%|████▍     | 11/25 [00:04<00:05,  2.45it/s][A
LP: -1303210.4:  48%|████▊     | 12/25 [00:04<00:05,  2.46it/s][A
LP: -1303210.4:  48%|████▊     | 12/25 [00:05<00:05,  2.46it/s][A
LP: -1303210.4:  52%|█████▏    | 13/25 [00:05<00:04,  2.45it/s][A
LP: -1303210.4:  52%|█████▏    | 13/25 [00:05<00:04,  2.45it/s][A
LP: -1303210.4:  56%|█████▌    | 14/25 [00:05<00:04,  2.44it/s][A
LP: -1303210.4:  56%|█████▌    | 14/25 [00:06<00:04,  2.44it/s][A
LP: -1303210.4:  60%|██████    | 15/25 [00:06<00:04,  2.44it/s][A
LP: -1303210.4:  60%|██████    | 15/25 [00:06<00:04,  2.44it/s][A
LP: -1303210.4:  64%|██████▍   | 16/25 [00:06<00:03,  2.43it/s][A
LP: -1303210.4:  64%|██████▍   | 16/25 [00:06<00:03,  2.43it/s][A
LP: -1303210.4:  68%|██████▊   | 17/25 [00:06<00:03,  2.43it/s][A
LP: -1303210.4:  68%|██████▊   | 17/25 [00:07<00:03,  2.43it/s][A
LP: -1303210.4:  72%|███████▏  | 18/25 [00:07<00:02,  2.43it/s][A
LP: -1303210.4:  72%|███████▏  | 18/25 [00:07<00:02,  2.43it/s][A
LP: -1303210.4:  76%|███████▌  | 19/25 [00:07<00:02,  2.43it/s][A
LP: -1303210.4:  76%|███████▌  | 19/25 [00:08<00:02,  2.43it/s][A
LP: -1303210.4:  80%|████████  | 20/25 [00:08<00:02,  2.43it/s][A
LP: -1303210.4:  80%|████████  | 20/25 [00:08<00:02,  2.43it/s][A
LP: -1303210.4:  84%|████████▍ | 21/25 [00:08<00:01,  2.43it/s][A
LP: -1303210.4:  84%|████████▍ | 21/25 [00:09<00:01,  2.43it/s][A
LP: -1303210.4:  88%|████████▊ | 22/25 [00:09<00:01,  2.43it/s][A
LP: -1303210.4:  88%|████████▊ | 22/25 [00:09<00:01,  2.43it/s][A
LP: -1303210.4:  92%|█████████▏| 23/25 [00:09<00:00,  2.43it/s][A
LP: -1303210.4:  92%|█████████▏| 23/25 [00:09<00:00,  2.43it/s][A
LP: -1303210.4:  96%|█████████▌| 24/25 [00:09<00:00,  2.43it/s][A
LP: -1303210.4:  96%|█████████▌| 24/25 [00:10<00:00,  2.43it/s][A
LP: -1303210.4: 100%|██████████| 25/25 [00:10<00:00,  2.44it/s][ALP: -1303210.4: 100%|██████████| 25/25 [00:10<00:00,  2.44it/s]
ARHMM Initialization restarts: 100%|██████████| 1/1 [00:10<00:00, 10.82s/it]ARHMM Initialization restarts: 100%|██████████| 1/1 [00:10<00:00, 10.82s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -2497888.9:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -833546.3:   0%|          | 0/15 [00:47<?, ?it/s] ELBO: -833546.3:   7%|▋         | 1/15 [00:47<11:03, 47.42s/it]ELBO: -814156.3:   7%|▋         | 1/15 [01:26<11:03, 47.42s/it]ELBO: -814156.3:  13%|█▎        | 2/15 [01:26<09:09, 42.25s/it]ELBO: -804875.8:  13%|█▎        | 2/15 [01:59<09:09, 42.25s/it]ELBO: -804875.8:  20%|██        | 3/15 [01:59<07:38, 38.18s/it]ELBO: -800900.3:  20%|██        | 3/15 [02:32<07:38, 38.18s/it]ELBO: -800900.3:  27%|██▋       | 4/15 [02:32<06:36, 36.02s/it]ELBO: -798042.9:  27%|██▋       | 4/15 [03:02<06:36, 36.02s/it]ELBO: -798042.9:  33%|███▎      | 5/15 [03:02<05:39, 33.92s/it]ELBO: -796198.0:  33%|███▎      | 5/15 [03:32<05:39, 33.92s/it]ELBO: -796198.0:  40%|████      | 6/15 [03:32<04:54, 32.70s/it]ELBO: -794288.5:  40%|████      | 6/15 [04:02<04:54, 32.70s/it]ELBO: -794288.5:  47%|████▋     | 7/15 [04:02<04:15, 31.93s/it]ELBO: -793160.4:  47%|████▋     | 7/15 [04:33<04:15, 31.93s/it]ELBO: -793160.4:  53%|█████▎    | 8/15 [04:33<03:40, 31.47s/it]ELBO: -793208.1:  53%|█████▎    | 8/15 [05:03<03:40, 31.47s/it]ELBO: -793208.1:  60%|██████    | 9/15 [05:03<03:06, 31.12s/it]ELBO: -792070.0:  60%|██████    | 9/15 [05:35<03:06, 31.12s/it]ELBO: -792070.0:  67%|██████▋   | 10/15 [05:35<02:35, 31.15s/it]ELBO: -790811.8:  67%|██████▋   | 10/15 [06:05<02:35, 31.15s/it]ELBO: -790811.8:  73%|███████▎  | 11/15 [06:05<02:03, 30.95s/it]ELBO: -791628.8:  73%|███████▎  | 11/15 [06:35<02:03, 30.95s/it]ELBO: -791628.8:  80%|████████  | 12/15 [06:35<01:32, 30.79s/it]ELBO: -791117.0:  80%|████████  | 12/15 [07:06<01:32, 30.79s/it]ELBO: -791117.0:  87%|████████▋ | 13/15 [07:06<01:01, 30.70s/it]ELBO: -790751.1:  87%|████████▋ | 13/15 [07:37<01:01, 30.70s/it]ELBO: -790751.1:  93%|█████████▎| 14/15 [07:37<00:30, 30.81s/it]ELBO: -789738.4:  93%|█████████▎| 14/15 [08:08<00:30, 30.81s/it]ELBO: -789738.4: 100%|██████████| 15/15 [08:08<00:00, 30.74s/it]ELBO: -789738.4: 100%|██████████| 15/15 [08:08<00:00, 32.54s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -22722327.4:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -153425.1:   0%|          | 0/15 [00:08<?, ?it/s]  ELBO: -153425.1:   7%|▋         | 1/15 [00:08<01:58,  8.46s/it]ELBO: -153925.2:   7%|▋         | 1/15 [00:12<01:58,  8.46s/it]ELBO: -153925.2:  13%|█▎        | 2/15 [00:12<01:16,  5.85s/it]ELBO: -153328.1:  13%|█▎        | 2/15 [00:16<01:16,  5.85s/it]ELBO: -153328.1:  20%|██        | 3/15 [00:16<01:00,  5.01s/it]ELBO: -152799.6:  20%|██        | 3/15 [00:20<01:00,  5.01s/it]ELBO: -152799.6:  27%|██▋       | 4/15 [00:20<00:50,  4.63s/it]ELBO: -152121.2:  27%|██▋       | 4/15 [00:24<00:50,  4.63s/it]ELBO: -152121.2:  33%|███▎      | 5/15 [00:24<00:44,  4.41s/it]ELBO: -153157.1:  33%|███▎      | 5/15 [00:28<00:44,  4.41s/it]ELBO: -153157.1:  40%|████      | 6/15 [00:28<00:38,  4.28s/it]ELBO: -153417.4:  40%|████      | 6/15 [00:32<00:38,  4.28s/it]ELBO: -153417.4:  47%|████▋     | 7/15 [00:32<00:33,  4.21s/it]ELBO: -153083.1:  47%|████▋     | 7/15 [00:36<00:33,  4.21s/it]ELBO: -153083.1:  53%|█████▎    | 8/15 [00:36<00:29,  4.15s/it]ELBO: -153245.1:  53%|█████▎    | 8/15 [00:40<00:29,  4.15s/it]ELBO: -153245.1:  60%|██████    | 9/15 [00:40<00:24,  4.12s/it]ELBO: -152780.7:  60%|██████    | 9/15 [00:44<00:24,  4.12s/it]ELBO: -152780.7:  67%|██████▋   | 10/15 [00:44<00:20,  4.09s/it]ELBO: -153094.4:  67%|██████▋   | 10/15 [00:48<00:20,  4.09s/it]ELBO: -153094.4:  73%|███████▎  | 11/15 [00:48<00:16,  4.07s/it]ELBO: -153190.0:  73%|███████▎  | 11/15 [00:52<00:16,  4.07s/it]ELBO: -153190.0:  80%|████████  | 12/15 [00:52<00:12,  4.06s/it]ELBO: -153531.0:  80%|████████  | 12/15 [00:56<00:12,  4.06s/it]ELBO: -153531.0:  87%|████████▋ | 13/15 [00:56<00:08,  4.05s/it]ELBO: -152853.6:  87%|████████▋ | 13/15 [01:00<00:08,  4.05s/it]ELBO: -152853.6:  93%|█████████▎| 14/15 [01:00<00:04,  4.04s/it]ELBO: -152941.9:  93%|█████████▎| 14/15 [01:04<00:04,  4.04s/it]ELBO: -152941.9: 100%|██████████| 15/15 [01:04<00:00,  4.04s/it]ELBO: -152941.9: 100%|██████████| 15/15 [01:04<00:00,  4.33s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -16530526.9:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -144326.8:   0%|          | 0/15 [00:10<?, ?it/s]  ELBO: -144326.8:   7%|▋         | 1/15 [00:10<02:23, 10.25s/it]ELBO: -144845.0:   7%|▋         | 1/15 [00:14<02:23, 10.25s/it]ELBO: -144845.0:  13%|█▎        | 2/15 [00:14<01:25,  6.57s/it]ELBO: -144480.2:  13%|█▎        | 2/15 [00:18<01:25,  6.57s/it]ELBO: -144480.2:  20%|██        | 3/15 [00:18<01:04,  5.40s/it]ELBO: -144674.4:  20%|██        | 3/15 [00:22<01:04,  5.40s/it]ELBO: -144674.4:  27%|██▋       | 4/15 [00:22<00:53,  4.84s/it]ELBO: -144698.0:  27%|██▋       | 4/15 [00:26<00:53,  4.84s/it]ELBO: -144698.0:  33%|███▎      | 5/15 [00:26<00:45,  4.55s/it]ELBO: -144349.0:  33%|███▎      | 5/15 [00:30<00:45,  4.55s/it]ELBO: -144349.0:  40%|████      | 6/15 [00:30<00:39,  4.37s/it]ELBO: -145370.9:  40%|████      | 6/15 [00:34<00:39,  4.37s/it]ELBO: -145370.9:  47%|████▋     | 7/15 [00:34<00:33,  4.25s/it]ELBO: -143736.3:  47%|████▋     | 7/15 [00:38<00:33,  4.25s/it]ELBO: -143736.3:  53%|█████▎    | 8/15 [00:38<00:29,  4.18s/it]ELBO: -144651.6:  53%|█████▎    | 8/15 [00:42<00:29,  4.18s/it]ELBO: -144651.6:  60%|██████    | 9/15 [00:42<00:24,  4.13s/it]ELBO: -144961.4:  60%|██████    | 9/15 [00:46<00:24,  4.13s/it]ELBO: -144961.4:  67%|██████▋   | 10/15 [00:46<00:20,  4.08s/it]ELBO: -144734.9:  67%|██████▋   | 10/15 [00:50<00:20,  4.08s/it]ELBO: -144734.9:  73%|███████▎  | 11/15 [00:50<00:16,  4.07s/it]ELBO: -144604.0:  73%|███████▎  | 11/15 [00:54<00:16,  4.07s/it]ELBO: -144604.0:  80%|████████  | 12/15 [00:54<00:12,  4.06s/it]ELBO: -144581.7:  80%|████████  | 12/15 [00:58<00:12,  4.06s/it]ELBO: -144581.7:  87%|████████▋ | 13/15 [00:58<00:08,  4.05s/it]ELBO: -144524.3:  87%|████████▋ | 13/15 [01:02<00:08,  4.05s/it]ELBO: -144524.3:  93%|█████████▎| 14/15 [01:02<00:04,  4.05s/it]ELBO: -144223.4:  93%|█████████▎| 14/15 [01:06<00:04,  4.05s/it]ELBO: -144223.4: 100%|██████████| 15/15 [01:06<00:00,  4.05s/it]ELBO: -144223.4: 100%|██████████| 15/15 [01:06<00:00,  4.43s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -18510008.9:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -134981.2:   0%|          | 0/15 [00:09<?, ?it/s]  ELBO: -134981.2:   7%|▋         | 1/15 [00:09<02:19,  9.99s/it]ELBO: -135627.7:   7%|▋         | 1/15 [00:14<02:19,  9.99s/it]ELBO: -135627.7:  13%|█▎        | 2/15 [00:14<01:24,  6.48s/it]ELBO: -135681.5:  13%|█▎        | 2/15 [00:18<01:24,  6.48s/it]ELBO: -135681.5:  20%|██        | 3/15 [00:18<01:04,  5.39s/it]ELBO: -135797.3:  20%|██        | 3/15 [00:22<01:04,  5.39s/it]ELBO: -135797.3:  27%|██▋       | 4/15 [00:22<00:53,  4.85s/it]ELBO: -135188.2:  27%|██▋       | 4/15 [00:26<00:53,  4.85s/it]ELBO: -135188.2:  33%|███▎      | 5/15 [00:26<00:45,  4.57s/it]ELBO: -135835.5:  33%|███▎      | 5/15 [00:30<00:45,  4.57s/it]ELBO: -135835.5:  40%|████      | 6/15 [00:30<00:39,  4.39s/it]ELBO: -135545.7:  40%|████      | 6/15 [00:34<00:39,  4.39s/it]ELBO: -135545.7:  47%|████▋     | 7/15 [00:34<00:34,  4.28s/it]ELBO: -135137.9:  47%|████▋     | 7/15 [00:38<00:34,  4.28s/it]ELBO: -135137.9:  53%|█████▎    | 8/15 [00:38<00:29,  4.20s/it]ELBO: -135570.3:  53%|█████▎    | 8/15 [00:42<00:29,  4.20s/it]ELBO: -135570.3:  60%|██████    | 9/15 [00:42<00:24,  4.16s/it]ELBO: -135532.7:  60%|██████    | 9/15 [00:46<00:24,  4.16s/it]ELBO: -135532.7:  67%|██████▋   | 10/15 [00:46<00:20,  4.13s/it]ELBO: -135130.1:  67%|██████▋   | 10/15 [00:50<00:20,  4.13s/it]ELBO: -135130.1:  73%|███████▎  | 11/15 [00:50<00:16,  4.09s/it]ELBO: -135679.1:  73%|███████▎  | 11/15 [00:54<00:16,  4.09s/it]ELBO: -135679.1:  80%|████████  | 12/15 [00:54<00:12,  4.07s/it]ELBO: -135287.1:  80%|████████  | 12/15 [00:58<00:12,  4.07s/it]ELBO: -135287.1:  87%|████████▋ | 13/15 [00:58<00:08,  4.07s/it]ELBO: -135164.8:  87%|████████▋ | 13/15 [01:02<00:08,  4.07s/it]ELBO: -135164.8:  93%|█████████▎| 14/15 [01:02<00:04,  4.06s/it]ELBO: -135304.3:  93%|█████████▎| 14/15 [01:06<00:04,  4.06s/it]ELBO: -135304.3: 100%|██████████| 15/15 [01:06<00:00,  4.08s/it]ELBO: -135304.3: 100%|██████████| 15/15 [01:06<00:00,  4.45s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -15775974.4:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -136888.1:   0%|          | 0/15 [00:08<?, ?it/s]  ELBO: -136888.1:   7%|▋         | 1/15 [00:08<01:58,  8.46s/it]ELBO: -137671.0:   7%|▋         | 1/15 [00:12<01:58,  8.46s/it]ELBO: -137671.0:  13%|█▎        | 2/15 [00:12<01:15,  5.84s/it]ELBO: -137310.5:  13%|█▎        | 2/15 [00:16<01:15,  5.84s/it]ELBO: -137310.5:  20%|██        | 3/15 [00:16<00:59,  5.00s/it]ELBO: -137867.5:  20%|██        | 3/15 [00:20<00:59,  5.00s/it]ELBO: -137867.5:  27%|██▋       | 4/15 [00:20<00:50,  4.60s/it]ELBO: -137978.4:  27%|██▋       | 4/15 [00:24<00:50,  4.60s/it]ELBO: -137978.4:  33%|███▎      | 5/15 [00:24<00:43,  4.39s/it]ELBO: -138216.1:  33%|███▎      | 5/15 [00:28<00:43,  4.39s/it]ELBO: -138216.1:  40%|████      | 6/15 [00:28<00:38,  4.25s/it]ELBO: -137789.2:  40%|████      | 6/15 [00:32<00:38,  4.25s/it]ELBO: -137789.2:  47%|████▋     | 7/15 [00:32<00:33,  4.17s/it]ELBO: -137574.5:  47%|████▋     | 7/15 [00:36<00:33,  4.17s/it]ELBO: -137574.5:  53%|█████▎    | 8/15 [00:36<00:28,  4.12s/it]ELBO: -138070.7:  53%|█████▎    | 8/15 [00:40<00:28,  4.12s/it]ELBO: -138070.7:  60%|██████    | 9/15 [00:40<00:24,  4.09s/it]ELBO: -137300.9:  60%|██████    | 9/15 [00:44<00:24,  4.09s/it]ELBO: -137300.9:  67%|██████▋   | 10/15 [00:44<00:20,  4.07s/it]ELBO: -137133.9:  67%|██████▋   | 10/15 [00:48<00:20,  4.07s/it]ELBO: -137133.9:  73%|███████▎  | 11/15 [00:48<00:16,  4.05s/it]ELBO: -137376.7:  73%|███████▎  | 11/15 [00:52<00:16,  4.05s/it]ELBO: -137376.7:  80%|████████  | 12/15 [00:52<00:12,  4.03s/it]ELBO: -137639.0:  80%|████████  | 12/15 [00:56<00:12,  4.03s/it]ELBO: -137639.0:  87%|████████▋ | 13/15 [00:56<00:08,  4.02s/it]ELBO: -137629.2:  87%|████████▋ | 13/15 [01:00<00:08,  4.02s/it]ELBO: -137629.2:  93%|█████████▎| 14/15 [01:00<00:04,  4.00s/it]ELBO: -137277.9:  93%|█████████▎| 14/15 [01:04<00:04,  4.00s/it]ELBO: -137277.9: 100%|██████████| 15/15 [01:04<00:00,  4.00s/it]ELBO: -137277.9: 100%|██████████| 15/15 [01:04<00:00,  4.30s/it]
