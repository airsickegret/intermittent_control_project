Processed spikes from trial 100.
Processed spikes from trial 200.
Processed spikes from trial 300.
  0%|          | 0/1 [00:00<?, ?it/s]ARHMM Initialization restarts:   0%|          | 0/1 [00:00<?, ?it/s]Initializing with an ARHMM using 25 steps of EM.

  0%|          | 0/25 [00:00<?, ?it/s][A
LP: -1375171.6:   0%|          | 0/25 [00:00<?, ?it/s][A
LP: -1375171.6:   0%|          | 0/25 [00:00<?, ?it/s][A
LP: -1375171.6:   4%|▍         | 1/25 [00:00<00:10,  2.27it/s][A
LP: -1375171.6:   4%|▍         | 1/25 [00:00<00:10,  2.27it/s][A
LP: -1375171.6:   8%|▊         | 2/25 [00:00<00:10,  2.26it/s][A
LP: -1375171.6:   8%|▊         | 2/25 [00:01<00:10,  2.26it/s][A
LP: -1375171.6:  12%|█▏        | 3/25 [00:01<00:09,  2.28it/s][A
LP: -1375171.6:  12%|█▏        | 3/25 [00:01<00:09,  2.28it/s][A
LP: -1375171.6:  16%|█▌        | 4/25 [00:01<00:09,  2.31it/s][A
LP: -1375171.6:  16%|█▌        | 4/25 [00:02<00:09,  2.31it/s][A
LP: -1375171.6:  20%|██        | 5/25 [00:02<00:08,  2.31it/s][A
LP: -1375171.6:  20%|██        | 5/25 [00:02<00:08,  2.31it/s][A
LP: -1375171.6:  24%|██▍       | 6/25 [00:02<00:08,  2.27it/s][A
LP: -1375171.6:  24%|██▍       | 6/25 [00:03<00:08,  2.27it/s][A
LP: -1375171.6:  28%|██▊       | 7/25 [00:03<00:07,  2.27it/s][A
LP: -1375171.6:  28%|██▊       | 7/25 [00:03<00:07,  2.27it/s][A
LP: -1375171.6:  32%|███▏      | 8/25 [00:03<00:07,  2.26it/s][A
LP: -1375171.6:  32%|███▏      | 8/25 [00:03<00:07,  2.26it/s][A
LP: -1375171.6:  36%|███▌      | 9/25 [00:03<00:07,  2.21it/s][A
LP: -1375171.6:  36%|███▌      | 9/25 [00:04<00:07,  2.21it/s][A
LP: -1375171.6:  40%|████      | 10/25 [00:04<00:06,  2.23it/s][A
LP: -1375171.6:  40%|████      | 10/25 [00:04<00:06,  2.23it/s][A
LP: -1375171.6:  44%|████▍     | 11/25 [00:04<00:06,  2.25it/s][A
LP: -1375171.6:  44%|████▍     | 11/25 [00:05<00:06,  2.25it/s][A
LP: -1375171.6:  48%|████▊     | 12/25 [00:05<00:05,  2.25it/s][A
LP: -1375171.6:  48%|████▊     | 12/25 [00:05<00:05,  2.25it/s][A
LP: -1375171.6:  52%|█████▏    | 13/25 [00:05<00:05,  2.25it/s][A
LP: -1375171.6:  52%|█████▏    | 13/25 [00:06<00:05,  2.25it/s][A
LP: -1375171.6:  56%|█████▌    | 14/25 [00:06<00:04,  2.26it/s][A
LP: -1375171.6:  56%|█████▌    | 14/25 [00:06<00:04,  2.26it/s][A
LP: -1375171.6:  60%|██████    | 15/25 [00:06<00:04,  2.27it/s][A
LP: -1375171.6:  60%|██████    | 15/25 [00:07<00:04,  2.27it/s][A
LP: -1375171.6:  64%|██████▍   | 16/25 [00:07<00:03,  2.26it/s][A
LP: -1375171.6:  64%|██████▍   | 16/25 [00:07<00:03,  2.26it/s][A
LP: -1375171.6:  68%|██████▊   | 17/25 [00:07<00:03,  2.26it/s][A
LP: -1375171.6:  68%|██████▊   | 17/25 [00:07<00:03,  2.26it/s][A
LP: -1375171.6:  72%|███████▏  | 18/25 [00:07<00:03,  2.27it/s][A
LP: -1375171.6:  72%|███████▏  | 18/25 [00:08<00:03,  2.27it/s][A
LP: -1375171.6:  76%|███████▌  | 19/25 [00:08<00:02,  2.26it/s][A
LP: -1375171.6:  76%|███████▌  | 19/25 [00:08<00:02,  2.26it/s][A
LP: -1375171.6:  80%|████████  | 20/25 [00:08<00:02,  2.28it/s][A
LP: -1375171.6:  80%|████████  | 20/25 [00:09<00:02,  2.28it/s][A
LP: -1375171.6:  84%|████████▍ | 21/25 [00:09<00:01,  2.27it/s][A
LP: -1375171.6:  84%|████████▍ | 21/25 [00:09<00:01,  2.27it/s][A
LP: -1375171.6:  88%|████████▊ | 22/25 [00:09<00:01,  2.26it/s][A
LP: -1375171.6:  88%|████████▊ | 22/25 [00:10<00:01,  2.26it/s][A
LP: -1375171.6:  92%|█████████▏| 23/25 [00:10<00:00,  2.25it/s][A
LP: -1375171.6:  92%|█████████▏| 23/25 [00:10<00:00,  2.25it/s][A
LP: -1375171.6:  96%|█████████▌| 24/25 [00:10<00:00,  2.26it/s][A
LP: -1375171.6:  96%|█████████▌| 24/25 [00:11<00:00,  2.26it/s][A
LP: -1375171.6: 100%|██████████| 25/25 [00:11<00:00,  2.26it/s][ALP: -1375171.6: 100%|██████████| 25/25 [00:11<00:00,  2.26it/s]
ARHMM Initialization restarts: 100%|██████████| 1/1 [00:11<00:00, 11.66s/it]ARHMM Initialization restarts: 100%|██████████| 1/1 [00:11<00:00, 11.66s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -2608274.9:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -839384.4:   0%|          | 0/15 [00:49<?, ?it/s] ELBO: -839384.4:   7%|▋         | 1/15 [00:49<11:36, 49.74s/it]ELBO: -820658.4:   7%|▋         | 1/15 [01:30<11:36, 49.74s/it]ELBO: -820658.4:  13%|█▎        | 2/15 [01:30<09:39, 44.60s/it]ELBO: -811232.2:  13%|█▎        | 2/15 [02:07<09:39, 44.60s/it]ELBO: -811232.2:  20%|██        | 3/15 [02:07<08:09, 40.79s/it]ELBO: -806753.2:  20%|██        | 3/15 [02:42<08:09, 40.79s/it]ELBO: -806753.2:  27%|██▋       | 4/15 [02:42<07:06, 38.81s/it]ELBO: -802281.8:  27%|██▋       | 4/15 [03:19<07:06, 38.81s/it]ELBO: -802281.8:  33%|███▎      | 5/15 [03:19<06:19, 37.95s/it]ELBO: -800725.4:  33%|███▎      | 5/15 [03:52<06:19, 37.95s/it]ELBO: -800725.4:  40%|████      | 6/15 [03:52<05:27, 36.37s/it]ELBO: -799843.6:  40%|████      | 6/15 [04:25<05:27, 36.37s/it]ELBO: -799843.6:  47%|████▋     | 7/15 [04:25<04:43, 35.41s/it]ELBO: -798865.8:  47%|████▋     | 7/15 [04:59<04:43, 35.41s/it]ELBO: -798865.8:  53%|█████▎    | 8/15 [04:59<04:03, 34.75s/it]ELBO: -798621.1:  53%|█████▎    | 8/15 [05:32<04:03, 34.75s/it]ELBO: -798621.1:  60%|██████    | 9/15 [05:32<03:26, 34.35s/it]ELBO: -798184.2:  60%|██████    | 9/15 [06:06<03:26, 34.35s/it]ELBO: -798184.2:  67%|██████▋   | 10/15 [06:06<02:50, 34.09s/it]ELBO: -797391.7:  67%|██████▋   | 10/15 [06:39<02:50, 34.09s/it]ELBO: -797391.7:  73%|███████▎  | 11/15 [06:39<02:15, 33.90s/it]ELBO: -796128.8:  73%|███████▎  | 11/15 [07:13<02:15, 33.90s/it]ELBO: -796128.8:  80%|████████  | 12/15 [07:13<01:41, 33.78s/it]ELBO: -796803.2:  80%|████████  | 12/15 [07:47<01:41, 33.78s/it]ELBO: -796803.2:  87%|████████▋ | 13/15 [07:47<01:07, 33.93s/it]ELBO: -795772.5:  87%|████████▋ | 13/15 [08:20<01:07, 33.93s/it]ELBO: -795772.5:  93%|█████████▎| 14/15 [08:20<00:33, 33.78s/it]ELBO: -794603.8:  93%|█████████▎| 14/15 [08:54<00:33, 33.78s/it]ELBO: -794603.8: 100%|██████████| 15/15 [08:54<00:00, 33.70s/it]ELBO: -794603.8: 100%|██████████| 15/15 [08:54<00:00, 35.63s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -25987702.6:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -144239.6:   0%|          | 0/15 [00:09<?, ?it/s]  ELBO: -144239.6:   7%|▋         | 1/15 [00:09<02:07,  9.09s/it]ELBO: -144705.9:   7%|▋         | 1/15 [00:13<02:07,  9.09s/it]ELBO: -144705.9:  13%|█▎        | 2/15 [00:13<01:21,  6.29s/it]ELBO: -144036.0:  13%|█▎        | 2/15 [00:17<01:21,  6.29s/it]ELBO: -144036.0:  20%|██        | 3/15 [00:17<01:04,  5.38s/it]ELBO: -144255.7:  20%|██        | 3/15 [00:22<01:04,  5.38s/it]ELBO: -144255.7:  27%|██▋       | 4/15 [00:22<00:54,  4.95s/it]ELBO: -144108.5:  27%|██▋       | 4/15 [00:26<00:54,  4.95s/it]ELBO: -144108.5:  33%|███▎      | 5/15 [00:26<00:47,  4.72s/it]ELBO: -143697.2:  33%|███▎      | 5/15 [00:30<00:47,  4.72s/it]ELBO: -143697.2:  40%|████      | 6/15 [00:30<00:41,  4.58s/it]ELBO: -143558.1:  40%|████      | 6/15 [00:34<00:41,  4.58s/it]ELBO: -143558.1:  47%|████▋     | 7/15 [00:34<00:36,  4.50s/it]ELBO: -143992.7:  47%|████▋     | 7/15 [00:39<00:36,  4.50s/it]ELBO: -143992.7:  53%|█████▎    | 8/15 [00:39<00:31,  4.44s/it]ELBO: -143949.4:  53%|█████▎    | 8/15 [00:43<00:31,  4.44s/it]ELBO: -143949.4:  60%|██████    | 9/15 [00:43<00:26,  4.40s/it]ELBO: -144214.2:  60%|██████    | 9/15 [00:47<00:26,  4.40s/it]ELBO: -144214.2:  67%|██████▋   | 10/15 [00:47<00:21,  4.38s/it]ELBO: -144221.9:  67%|██████▋   | 10/15 [00:52<00:21,  4.38s/it]ELBO: -144221.9:  73%|███████▎  | 11/15 [00:52<00:17,  4.35s/it]ELBO: -144606.1:  73%|███████▎  | 11/15 [00:56<00:17,  4.35s/it]ELBO: -144606.1:  80%|████████  | 12/15 [00:56<00:13,  4.34s/it]ELBO: -144102.6:  80%|████████  | 12/15 [01:00<00:13,  4.34s/it]ELBO: -144102.6:  87%|████████▋ | 13/15 [01:00<00:08,  4.33s/it]ELBO: -144309.6:  87%|████████▋ | 13/15 [01:05<00:08,  4.33s/it]ELBO: -144309.6:  93%|█████████▎| 14/15 [01:05<00:04,  4.32s/it]ELBO: -143879.8:  93%|█████████▎| 14/15 [01:09<00:04,  4.32s/it]ELBO: -143879.8: 100%|██████████| 15/15 [01:09<00:00,  4.32s/it]ELBO: -143879.8: 100%|██████████| 15/15 [01:09<00:00,  4.63s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -17036980.0:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -140373.9:   0%|          | 0/15 [00:10<?, ?it/s]  ELBO: -140373.9:   7%|▋         | 1/15 [00:10<02:29, 10.65s/it]ELBO: -140588.3:   7%|▋         | 1/15 [00:14<02:29, 10.65s/it]ELBO: -140588.3:  13%|█▎        | 2/15 [00:14<01:29,  6.89s/it]ELBO: -140843.8:  13%|█▎        | 2/15 [00:19<01:29,  6.89s/it]ELBO: -140843.8:  20%|██        | 3/15 [00:19<01:08,  5.70s/it]ELBO: -140498.4:  20%|██        | 3/15 [00:23<01:08,  5.70s/it]ELBO: -140498.4:  27%|██▋       | 4/15 [00:23<00:56,  5.14s/it]ELBO: -140432.8:  27%|██▋       | 4/15 [00:27<00:56,  5.14s/it]ELBO: -140432.8:  33%|███▎      | 5/15 [00:27<00:48,  4.83s/it]ELBO: -140381.5:  33%|███▎      | 5/15 [00:32<00:48,  4.83s/it]ELBO: -140381.5:  40%|████      | 6/15 [00:32<00:41,  4.65s/it]ELBO: -140393.5:  40%|████      | 6/15 [00:36<00:41,  4.65s/it]ELBO: -140393.5:  47%|████▋     | 7/15 [00:36<00:36,  4.55s/it]ELBO: -140346.4:  47%|████▋     | 7/15 [00:40<00:36,  4.55s/it]ELBO: -140346.4:  53%|█████▎    | 8/15 [00:40<00:31,  4.47s/it]ELBO: -140859.2:  53%|█████▎    | 8/15 [00:45<00:31,  4.47s/it]ELBO: -140859.2:  60%|██████    | 9/15 [00:45<00:26,  4.43s/it]ELBO: -140304.8:  60%|██████    | 9/15 [00:49<00:26,  4.43s/it]ELBO: -140304.8:  67%|██████▋   | 10/15 [00:49<00:21,  4.38s/it]ELBO: -140297.3:  67%|██████▋   | 10/15 [00:53<00:21,  4.38s/it]ELBO: -140297.3:  73%|███████▎  | 11/15 [00:53<00:17,  4.35s/it]ELBO: -140325.8:  73%|███████▎  | 11/15 [00:57<00:17,  4.35s/it]ELBO: -140325.8:  80%|████████  | 12/15 [00:57<00:12,  4.33s/it]ELBO: -140588.2:  80%|████████  | 12/15 [01:02<00:12,  4.33s/it]ELBO: -140588.2:  87%|████████▋ | 13/15 [01:02<00:08,  4.32s/it]ELBO: -140618.5:  87%|████████▋ | 13/15 [01:06<00:08,  4.32s/it]ELBO: -140618.5:  93%|█████████▎| 14/15 [01:06<00:04,  4.32s/it]ELBO: -140227.9:  93%|█████████▎| 14/15 [01:10<00:04,  4.32s/it]ELBO: -140227.9: 100%|██████████| 15/15 [01:10<00:00,  4.32s/it]ELBO: -140227.9: 100%|██████████| 15/15 [01:10<00:00,  4.72s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -21772142.7:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -127733.9:   0%|          | 0/15 [00:11<?, ?it/s]  ELBO: -127733.9:   7%|▋         | 1/15 [00:11<02:34, 11.01s/it]ELBO: -127885.5:   7%|▋         | 1/15 [00:15<02:34, 11.01s/it]ELBO: -127885.5:  13%|█▎        | 2/15 [00:15<01:32,  7.08s/it]ELBO: -127325.6:  13%|█▎        | 2/15 [00:19<01:32,  7.08s/it]ELBO: -127325.6:  20%|██        | 3/15 [00:19<01:09,  5.81s/it]ELBO: -128056.3:  20%|██        | 3/15 [00:23<01:09,  5.81s/it]ELBO: -128056.3:  27%|██▋       | 4/15 [00:23<00:57,  5.22s/it]ELBO: -128210.0:  27%|██▋       | 4/15 [00:28<00:57,  5.22s/it]ELBO: -128210.0:  33%|███▎      | 5/15 [00:28<00:48,  4.88s/it]ELBO: -127933.5:  33%|███▎      | 5/15 [00:32<00:48,  4.88s/it]ELBO: -127933.5:  40%|████      | 6/15 [00:32<00:42,  4.69s/it]ELBO: -127213.1:  40%|████      | 6/15 [00:36<00:42,  4.69s/it]ELBO: -127213.1:  47%|████▋     | 7/15 [00:36<00:36,  4.57s/it]ELBO: -127722.8:  47%|████▋     | 7/15 [00:41<00:36,  4.57s/it]ELBO: -127722.8:  53%|█████▎    | 8/15 [00:41<00:31,  4.49s/it]ELBO: -127334.2:  53%|█████▎    | 8/15 [00:45<00:31,  4.49s/it]ELBO: -127334.2:  60%|██████    | 9/15 [00:45<00:26,  4.44s/it]ELBO: -127765.5:  60%|██████    | 9/15 [00:49<00:26,  4.44s/it]ELBO: -127765.5:  67%|██████▋   | 10/15 [00:49<00:21,  4.38s/it]ELBO: -126994.5:  67%|██████▋   | 10/15 [00:54<00:21,  4.38s/it]ELBO: -126994.5:  73%|███████▎  | 11/15 [00:54<00:17,  4.37s/it]ELBO: -127502.7:  73%|███████▎  | 11/15 [00:58<00:17,  4.37s/it]ELBO: -127502.7:  80%|████████  | 12/15 [00:58<00:13,  4.36s/it]ELBO: -128049.5:  80%|████████  | 12/15 [01:02<00:13,  4.36s/it]ELBO: -128049.5:  87%|████████▋ | 13/15 [01:02<00:08,  4.35s/it]ELBO: -127201.4:  87%|████████▋ | 13/15 [01:07<00:08,  4.35s/it]ELBO: -127201.4:  93%|█████████▎| 14/15 [01:07<00:04,  4.33s/it]ELBO: -127588.4:  93%|█████████▎| 14/15 [01:11<00:04,  4.33s/it]ELBO: -127588.4: 100%|██████████| 15/15 [01:11<00:00,  4.32s/it]ELBO: -127588.4: 100%|██████████| 15/15 [01:11<00:00,  4.76s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -25348659.0:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -141276.0:   0%|          | 0/15 [00:10<?, ?it/s]  ELBO: -141276.0:   7%|▋         | 1/15 [00:10<02:23, 10.21s/it]ELBO: -141122.1:   7%|▋         | 1/15 [00:14<02:23, 10.21s/it]ELBO: -141122.1:  13%|█▎        | 2/15 [00:14<01:27,  6.73s/it]ELBO: -140573.9:  13%|█▎        | 2/15 [00:18<01:27,  6.73s/it]ELBO: -140573.9:  20%|██        | 3/15 [00:18<01:07,  5.61s/it]ELBO: -140752.0:  20%|██        | 3/15 [00:23<01:07,  5.61s/it]ELBO: -140752.0:  27%|██▋       | 4/15 [00:23<00:55,  5.09s/it]ELBO: -140512.1:  27%|██▋       | 4/15 [00:27<00:55,  5.09s/it]ELBO: -140512.1:  33%|███▎      | 5/15 [00:27<00:48,  4.81s/it]ELBO: -140488.7:  33%|███▎      | 5/15 [00:31<00:48,  4.81s/it]ELBO: -140488.7:  40%|████      | 6/15 [00:31<00:41,  4.63s/it]ELBO: -140899.3:  40%|████      | 6/15 [00:35<00:41,  4.63s/it]ELBO: -140899.3:  47%|████▋     | 7/15 [00:35<00:36,  4.52s/it]ELBO: -140621.2:  47%|████▋     | 7/15 [00:40<00:36,  4.52s/it]ELBO: -140621.2:  53%|█████▎    | 8/15 [00:40<00:31,  4.45s/it]ELBO: -141015.4:  53%|█████▎    | 8/15 [00:44<00:31,  4.45s/it]ELBO: -141015.4:  60%|██████    | 9/15 [00:44<00:26,  4.39s/it]ELBO: -140969.2:  60%|██████    | 9/15 [00:48<00:26,  4.39s/it]ELBO: -140969.2:  67%|██████▋   | 10/15 [00:48<00:21,  4.36s/it]ELBO: -141419.2:  67%|██████▋   | 10/15 [00:53<00:21,  4.36s/it]ELBO: -141419.2:  73%|███████▎  | 11/15 [00:53<00:17,  4.34s/it]ELBO: -140582.0:  73%|███████▎  | 11/15 [00:57<00:17,  4.34s/it]ELBO: -140582.0:  80%|████████  | 12/15 [00:57<00:12,  4.32s/it]ELBO: -140916.0:  80%|████████  | 12/15 [01:01<00:12,  4.32s/it]ELBO: -140916.0:  87%|████████▋ | 13/15 [01:01<00:08,  4.31s/it]ELBO: -140593.1:  87%|████████▋ | 13/15 [01:05<00:08,  4.31s/it]ELBO: -140593.1:  93%|█████████▎| 14/15 [01:05<00:04,  4.30s/it]ELBO: -140522.7:  93%|█████████▎| 14/15 [01:10<00:04,  4.30s/it]ELBO: -140522.7: 100%|██████████| 15/15 [01:10<00:00,  4.29s/it]ELBO: -140522.7: 100%|██████████| 15/15 [01:10<00:00,  4.68s/it]
