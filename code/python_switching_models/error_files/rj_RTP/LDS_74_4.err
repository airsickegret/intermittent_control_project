Processed spikes from trial 100.
  0%|          | 0/1 [00:00<?, ?it/s]ARHMM Initialization restarts:   0%|          | 0/1 [00:00<?, ?it/s]Initializing with an ARHMM using 25 steps of EM.

  0%|          | 0/25 [00:00<?, ?it/s][A
LP: -1072369.1:   0%|          | 0/25 [00:00<?, ?it/s][A
LP: -1072369.1:   0%|          | 0/25 [00:01<?, ?it/s][A
LP: -1072369.1:   4%|▍         | 1/25 [00:01<00:24,  1.02s/it][A
LP: -1072369.1:   4%|▍         | 1/25 [00:01<00:24,  1.02s/it][A
LP: -1072369.1:   8%|▊         | 2/25 [00:01<00:22,  1.01it/s][A
LP: -1072369.1:   8%|▊         | 2/25 [00:02<00:22,  1.01it/s][A
LP: -1072369.1:  12%|█▏        | 3/25 [00:02<00:21,  1.02it/s][A
LP: -1072369.1:  12%|█▏        | 3/25 [00:03<00:21,  1.02it/s][A
LP: -1072369.1:  16%|█▌        | 4/25 [00:03<00:20,  1.03it/s][A
LP: -1072369.1:  16%|█▌        | 4/25 [00:04<00:20,  1.03it/s][A
LP: -1072369.1:  20%|██        | 5/25 [00:04<00:19,  1.02it/s][A
LP: -1072369.1:  20%|██        | 5/25 [00:05<00:19,  1.02it/s][A
LP: -1072369.1:  24%|██▍       | 6/25 [00:05<00:18,  1.01it/s][A
LP: -1072369.1:  24%|██▍       | 6/25 [00:06<00:18,  1.01it/s][A
LP: -1072369.1:  28%|██▊       | 7/25 [00:06<00:18,  1.00s/it][A
LP: -1072369.1:  28%|██▊       | 7/25 [00:07<00:18,  1.00s/it][A
LP: -1072369.1:  32%|███▏      | 8/25 [00:07<00:17,  1.01s/it][A
LP: -1072369.1:  32%|███▏      | 8/25 [00:08<00:17,  1.01s/it][A
LP: -1072369.1:  36%|███▌      | 9/25 [00:08<00:15,  1.01it/s][A
LP: -1072369.1:  36%|███▌      | 9/25 [00:09<00:15,  1.01it/s][A
LP: -1072369.1:  40%|████      | 10/25 [00:09<00:14,  1.00it/s][A
LP: -1072369.1:  40%|████      | 10/25 [00:10<00:14,  1.00it/s][A
LP: -1072369.1:  44%|████▍     | 11/25 [00:10<00:13,  1.01it/s][A
LP: -1072369.1:  44%|████▍     | 11/25 [00:11<00:13,  1.01it/s][A
LP: -1072369.1:  48%|████▊     | 12/25 [00:11<00:12,  1.00it/s][A
LP: -1072369.1:  48%|████▊     | 12/25 [00:12<00:12,  1.00it/s][A
LP: -1072369.1:  52%|█████▏    | 13/25 [00:12<00:11,  1.01it/s][A
LP: -1072369.1:  52%|█████▏    | 13/25 [00:14<00:11,  1.01it/s][A
LP: -1072369.1:  56%|█████▌    | 14/25 [00:14<00:11,  1.04s/it][A
LP: -1072369.1:  56%|█████▌    | 14/25 [00:15<00:11,  1.04s/it][A
LP: -1072369.1:  60%|██████    | 15/25 [00:15<00:10,  1.03s/it][A
LP: -1072369.1:  60%|██████    | 15/25 [00:16<00:10,  1.03s/it][A
LP: -1072369.1:  64%|██████▍   | 16/25 [00:16<00:09,  1.07s/it][A
LP: -1072369.1:  64%|██████▍   | 16/25 [00:17<00:09,  1.07s/it][A
LP: -1072369.1:  68%|██████▊   | 17/25 [00:17<00:08,  1.04s/it][A
LP: -1072369.1:  68%|██████▊   | 17/25 [00:18<00:08,  1.04s/it][A
LP: -1072369.1:  72%|███████▏  | 18/25 [00:18<00:07,  1.03s/it][A
LP: -1072369.1:  72%|███████▏  | 18/25 [00:19<00:07,  1.03s/it][A
LP: -1072369.1:  76%|███████▌  | 19/25 [00:19<00:06,  1.06s/it][A
LP: -1072369.1:  76%|███████▌  | 19/25 [00:20<00:06,  1.06s/it][A
LP: -1072369.1:  80%|████████  | 20/25 [00:20<00:05,  1.04s/it][A
LP: -1072369.1:  80%|████████  | 20/25 [00:21<00:05,  1.04s/it][A
LP: -1072369.1:  84%|████████▍ | 21/25 [00:21<00:04,  1.02s/it][A
LP: -1072369.1:  84%|████████▍ | 21/25 [00:22<00:04,  1.02s/it][A
LP: -1072369.1:  88%|████████▊ | 22/25 [00:22<00:03,  1.01s/it][A
LP: -1072369.1:  88%|████████▊ | 22/25 [00:23<00:03,  1.01s/it][A
LP: -1072369.1:  92%|█████████▏| 23/25 [00:23<00:02,  1.05s/it][A
LP: -1072369.1:  92%|█████████▏| 23/25 [00:24<00:02,  1.05s/it][A
LP: -1072369.1:  96%|█████████▌| 24/25 [00:24<00:01,  1.03s/it][A
LP: -1072369.1:  96%|█████████▌| 24/25 [00:26<00:01,  1.03s/it][A
LP: -1072369.1: 100%|██████████| 25/25 [00:26<00:00,  1.23s/it][ALP: -1072369.1: 100%|██████████| 25/25 [00:26<00:00,  1.04s/it]
ARHMM Initialization restarts: 100%|██████████| 1/1 [00:27<00:00, 27.23s/it]ARHMM Initialization restarts: 100%|██████████| 1/1 [00:27<00:00, 27.23s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -23679830785.0:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -23679830785.0:   0%|          | 0/15 [02:08<?, ?it/s]
Traceback (most recent call last):
  File "/project/nicho/projects/caleb/git/intermittent_control_project/code/python_switching_models/LDS_param_search.py", line 183, in <module>
    q_elbos_lem_train, q_lem_train = model.fit(trainset, method="laplace_em",
  File "/project/nicho/projects/caleb/git/ssm/ssm/util.py", line 111, in wrapper
    return f(self, datas, inputs=inputs, masks=masks, tags=tags, **kwargs)
  File "/project/nicho/projects/caleb/git/ssm/ssm/lds.py", line 790, in fit
    elbos = _fitting_methods[method](
  File "/project/nicho/projects/caleb/git/ssm/ssm/lds.py", line 699, in _fit_laplace_em
    self._fit_laplace_em_params_update(
  File "/project/nicho/projects/caleb/git/ssm/ssm/lds.py", line 583, in _fit_laplace_em_params_update
    continuous_samples = variational_posterior.sample_continuous_states()
  File "/project/nicho/projects/caleb/git/ssm/ssm/variational.py", line 399, in sample_continuous_states
    return [kalman_info_sample(prms["J_ini"], prms["h_ini"], 0,
  File "/project/nicho/projects/caleb/git/ssm/ssm/variational.py", line 399, in <listcomp>
    return [kalman_info_sample(prms["J_ini"], prms["h_ini"], 0,
  File "/project/nicho/projects/caleb/git/ssm/ssm/messages.py", line 1217, in wrapper
    return f(J_ini, h_ini, log_Z_ini,
  File "/project/nicho/projects/caleb/git/ssm/ssm/messages.py", line 1255, in kalman_info_sample
    return _kalman_info_sample(
  File "/project/nicho/projects/caleb/git/ssm/ssm/messages.py", line 1062, in _kalman_info_sample
    samples[-1] = _sample_info_gaussian(filtered_Js[-1], filtered_hs[-1], noise[-1])
  File "/software/python-anaconda-2022.05-el8-x86_64/lib/python3.9/site-packages/numba/np/linalg.py", line 935, in cho_impl
    raise np.linalg.LinAlgError(
numpy.linalg.LinAlgError: Matrix is not positive definite.
