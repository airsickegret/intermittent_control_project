Processed spikes from trial 100.
Processed spikes from trial 200.
Processed spikes from trial 300.
  0%|          | 0/1 [00:00<?, ?it/s]ARHMM Initialization restarts:   0%|          | 0/1 [00:00<?, ?it/s]Initializing with an ARHMM using 25 steps of EM.

  0%|          | 0/25 [00:00<?, ?it/s][A
LP: -531516.6:   0%|          | 0/25 [00:00<?, ?it/s][A
LP: -531516.6:   0%|          | 0/25 [00:00<?, ?it/s][A
LP: -531516.6:   4%|▍         | 1/25 [00:00<00:05,  4.28it/s][A
LP: -531516.6:   4%|▍         | 1/25 [00:00<00:05,  4.28it/s][A
LP: -531516.6:   8%|▊         | 2/25 [00:00<00:05,  4.28it/s][A
LP: -531516.6:   8%|▊         | 2/25 [00:00<00:05,  4.28it/s][A
LP: -531516.6:  12%|█▏        | 3/25 [00:00<00:05,  4.32it/s][A
LP: -531516.6:  12%|█▏        | 3/25 [00:00<00:05,  4.32it/s][A
LP: -531516.6:  16%|█▌        | 4/25 [00:00<00:04,  4.35it/s][A
LP: -531516.6:  16%|█▌        | 4/25 [00:01<00:04,  4.35it/s][A
LP: -531516.6:  20%|██        | 5/25 [00:01<00:04,  4.36it/s][A
LP: -531516.6:  20%|██        | 5/25 [00:01<00:04,  4.36it/s][A
LP: -531516.6:  24%|██▍       | 6/25 [00:01<00:04,  4.36it/s][A
LP: -531516.6:  24%|██▍       | 6/25 [00:01<00:04,  4.36it/s][A
LP: -531516.6:  28%|██▊       | 7/25 [00:01<00:04,  4.34it/s][A
LP: -531516.6:  28%|██▊       | 7/25 [00:01<00:04,  4.34it/s][A
LP: -531516.6:  32%|███▏      | 8/25 [00:01<00:03,  4.35it/s][A
LP: -531516.6:  32%|███▏      | 8/25 [00:02<00:03,  4.35it/s][A
LP: -531516.6:  36%|███▌      | 9/25 [00:02<00:03,  4.37it/s][A
LP: -531516.6:  36%|███▌      | 9/25 [00:02<00:03,  4.37it/s][A
LP: -531516.6:  40%|████      | 10/25 [00:02<00:03,  4.37it/s][A
LP: -531516.6:  40%|████      | 10/25 [00:02<00:03,  4.37it/s][A
LP: -531516.6:  44%|████▍     | 11/25 [00:02<00:03,  4.35it/s][A
LP: -531516.6:  44%|████▍     | 11/25 [00:02<00:03,  4.35it/s][A
LP: -531516.6:  48%|████▊     | 12/25 [00:02<00:02,  4.35it/s][A
LP: -531516.6:  48%|████▊     | 12/25 [00:02<00:02,  4.35it/s][A
LP: -531516.6:  52%|█████▏    | 13/25 [00:02<00:02,  4.33it/s][A
LP: -531516.6:  52%|█████▏    | 13/25 [00:03<00:02,  4.33it/s][A
LP: -531516.6:  56%|█████▌    | 14/25 [00:03<00:02,  4.34it/s][A
LP: -531516.6:  56%|█████▌    | 14/25 [00:03<00:02,  4.34it/s][A
LP: -531516.6:  60%|██████    | 15/25 [00:03<00:02,  4.35it/s][A
LP: -531516.6:  60%|██████    | 15/25 [00:03<00:02,  4.35it/s][A
LP: -531516.6:  64%|██████▍   | 16/25 [00:03<00:02,  4.36it/s][A
LP: -531516.6:  64%|██████▍   | 16/25 [00:03<00:02,  4.36it/s][A
LP: -531516.6:  68%|██████▊   | 17/25 [00:03<00:01,  4.37it/s][A
LP: -531516.6:  68%|██████▊   | 17/25 [00:04<00:01,  4.37it/s][A
LP: -531516.6:  72%|███████▏  | 18/25 [00:04<00:01,  4.37it/s][A
LP: -531516.6:  72%|███████▏  | 18/25 [00:04<00:01,  4.37it/s][A
LP: -531516.6:  76%|███████▌  | 19/25 [00:04<00:01,  4.38it/s][A
LP: -531516.6:  76%|███████▌  | 19/25 [00:04<00:01,  4.38it/s][A
LP: -531516.6:  80%|████████  | 20/25 [00:04<00:01,  4.36it/s][A
LP: -531516.6:  80%|████████  | 20/25 [00:04<00:01,  4.36it/s][A
LP: -531516.6:  84%|████████▍ | 21/25 [00:04<00:00,  4.35it/s][A
LP: -531516.6:  84%|████████▍ | 21/25 [00:05<00:00,  4.35it/s][A
LP: -531516.6:  88%|████████▊ | 22/25 [00:05<00:00,  4.34it/s][A
LP: -531516.6:  88%|████████▊ | 22/25 [00:05<00:00,  4.34it/s][A
LP: -531516.6:  92%|█████████▏| 23/25 [00:05<00:00,  4.31it/s][A
LP: -531516.6:  92%|█████████▏| 23/25 [00:05<00:00,  4.31it/s][A
LP: -531516.6:  96%|█████████▌| 24/25 [00:05<00:00,  4.33it/s][A
LP: -531516.6:  96%|█████████▌| 24/25 [00:05<00:00,  4.33it/s][A
LP: -531516.6: 100%|██████████| 25/25 [00:05<00:00,  4.33it/s][ALP: -531516.6: 100%|██████████| 25/25 [00:05<00:00,  4.34it/s]
ARHMM Initialization restarts: 100%|██████████| 1/1 [00:06<00:00,  6.13s/it]ARHMM Initialization restarts: 100%|██████████| 1/1 [00:06<00:00,  6.13s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -1461552.0:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -807379.2:   0%|          | 0/15 [00:23<?, ?it/s] ELBO: -807379.2:   7%|▋         | 1/15 [00:23<05:24, 23.17s/it]ELBO: -795621.9:   7%|▋         | 1/15 [00:41<05:24, 23.17s/it]ELBO: -795621.9:  13%|█▎        | 2/15 [00:41<04:22, 20.15s/it]ELBO: -789674.2:  13%|█▎        | 2/15 [00:55<04:22, 20.15s/it]ELBO: -789674.2:  20%|██        | 3/15 [00:55<03:31, 17.66s/it]ELBO: -786289.8:  20%|██        | 3/15 [01:09<03:31, 17.66s/it]ELBO: -786289.8:  27%|██▋       | 4/15 [01:09<02:58, 16.24s/it]ELBO: -784122.2:  27%|██▋       | 4/15 [01:22<02:58, 16.24s/it]ELBO: -784122.2:  33%|███▎      | 5/15 [01:22<02:27, 14.74s/it]ELBO: -783263.4:  33%|███▎      | 5/15 [01:34<02:27, 14.74s/it]ELBO: -783263.4:  40%|████      | 6/15 [01:34<02:04, 13.82s/it]ELBO: -782578.7:  40%|████      | 6/15 [01:46<02:04, 13.82s/it]ELBO: -782578.7:  47%|████▋     | 7/15 [01:46<01:45, 13.23s/it]ELBO: -781980.6:  47%|████▋     | 7/15 [01:58<01:45, 13.23s/it]ELBO: -781980.6:  53%|█████▎    | 8/15 [01:58<01:30, 12.88s/it]ELBO: -781174.4:  53%|█████▎    | 8/15 [02:10<01:30, 12.88s/it]ELBO: -781174.4:  60%|██████    | 9/15 [02:10<01:15, 12.62s/it]ELBO: -780140.3:  60%|██████    | 9/15 [02:21<01:15, 12.62s/it]ELBO: -780140.3:  67%|██████▋   | 10/15 [02:21<01:01, 12.24s/it]ELBO: -779564.8:  67%|██████▋   | 10/15 [02:33<01:01, 12.24s/it]ELBO: -779564.8:  73%|███████▎  | 11/15 [02:33<00:48, 12.19s/it]ELBO: -780133.6:  73%|███████▎  | 11/15 [02:45<00:48, 12.19s/it]ELBO: -780133.6:  80%|████████  | 12/15 [02:45<00:35, 11.94s/it]ELBO: -778729.2:  80%|████████  | 12/15 [02:56<00:35, 11.94s/it]ELBO: -778729.2:  87%|████████▋ | 13/15 [02:56<00:23, 11.77s/it]ELBO: -778920.7:  87%|████████▋ | 13/15 [03:07<00:23, 11.77s/it]ELBO: -778920.7:  93%|█████████▎| 14/15 [03:07<00:11, 11.66s/it]ELBO: -778695.9:  93%|█████████▎| 14/15 [03:18<00:11, 11.66s/it]ELBO: -778695.9: 100%|██████████| 15/15 [03:18<00:00, 11.38s/it]ELBO: -778695.9: 100%|██████████| 15/15 [03:18<00:00, 13.24s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -1182215.4:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -165359.3:   0%|          | 0/15 [00:03<?, ?it/s] ELBO: -165359.3:   7%|▋         | 1/15 [00:03<00:43,  3.08s/it]ELBO: -165255.7:   7%|▋         | 1/15 [00:04<00:43,  3.08s/it]ELBO: -165255.7:  13%|█▎        | 2/15 [00:04<00:26,  2.01s/it]ELBO: -165365.4:  13%|█▎        | 2/15 [00:05<00:26,  2.01s/it]ELBO: -165365.4:  20%|██        | 3/15 [00:05<00:19,  1.66s/it]ELBO: -165452.7:  20%|██        | 3/15 [00:06<00:19,  1.66s/it]ELBO: -165452.7:  27%|██▋       | 4/15 [00:06<00:16,  1.50s/it]ELBO: -165325.8:  27%|██▋       | 4/15 [00:08<00:16,  1.50s/it]ELBO: -165325.8:  33%|███▎      | 5/15 [00:08<00:14,  1.42s/it]ELBO: -165484.0:  33%|███▎      | 5/15 [00:09<00:14,  1.42s/it]ELBO: -165484.0:  40%|████      | 6/15 [00:09<00:12,  1.37s/it]ELBO: -165619.4:  40%|████      | 6/15 [00:10<00:12,  1.37s/it]ELBO: -165619.4:  47%|████▋     | 7/15 [00:10<00:10,  1.33s/it]ELBO: -165640.8:  47%|████▋     | 7/15 [00:11<00:10,  1.33s/it]ELBO: -165640.8:  53%|█████▎    | 8/15 [00:11<00:09,  1.31s/it]ELBO: -165475.7:  53%|█████▎    | 8/15 [00:13<00:09,  1.31s/it]ELBO: -165475.7:  60%|██████    | 9/15 [00:13<00:07,  1.29s/it]ELBO: -165460.9:  60%|██████    | 9/15 [00:14<00:07,  1.29s/it]ELBO: -165460.9:  67%|██████▋   | 10/15 [00:14<00:06,  1.28s/it]ELBO: -165304.2:  67%|██████▋   | 10/15 [00:15<00:06,  1.28s/it]ELBO: -165304.2:  73%|███████▎  | 11/15 [00:15<00:05,  1.28s/it]ELBO: -165340.8:  73%|███████▎  | 11/15 [00:16<00:05,  1.28s/it]ELBO: -165340.8:  80%|████████  | 12/15 [00:16<00:03,  1.27s/it]ELBO: -165054.1:  80%|████████  | 12/15 [00:18<00:03,  1.27s/it]ELBO: -165054.1:  87%|████████▋ | 13/15 [00:18<00:02,  1.27s/it]ELBO: -165262.8:  87%|████████▋ | 13/15 [00:19<00:02,  1.27s/it]ELBO: -165262.8:  93%|█████████▎| 14/15 [00:19<00:01,  1.27s/it]ELBO: -165402.3:  93%|█████████▎| 14/15 [00:20<00:01,  1.27s/it]ELBO: -165402.3: 100%|██████████| 15/15 [00:20<00:00,  1.27s/it]ELBO: -165402.3: 100%|██████████| 15/15 [00:20<00:00,  1.38s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -1091709.0:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -148011.4:   0%|          | 0/15 [00:03<?, ?it/s] ELBO: -148011.4:   7%|▋         | 1/15 [00:03<00:43,  3.10s/it]ELBO: -148357.3:   7%|▋         | 1/15 [00:04<00:43,  3.10s/it]ELBO: -148357.3:  13%|█▎        | 2/15 [00:04<00:26,  2.02s/it]ELBO: -148439.8:  13%|█▎        | 2/15 [00:05<00:26,  2.02s/it]ELBO: -148439.8:  20%|██        | 3/15 [00:05<00:20,  1.67s/it]ELBO: -148357.2:  20%|██        | 3/15 [00:06<00:20,  1.67s/it]ELBO: -148357.2:  27%|██▋       | 4/15 [00:06<00:16,  1.51s/it]ELBO: -148168.0:  27%|██▋       | 4/15 [00:08<00:16,  1.51s/it]ELBO: -148168.0:  33%|███▎      | 5/15 [00:08<00:14,  1.42s/it]ELBO: -148108.0:  33%|███▎      | 5/15 [00:09<00:14,  1.42s/it]ELBO: -148108.0:  40%|████      | 6/15 [00:09<00:12,  1.37s/it]ELBO: -148411.9:  40%|████      | 6/15 [00:10<00:12,  1.37s/it]ELBO: -148411.9:  47%|████▋     | 7/15 [00:10<00:10,  1.33s/it]ELBO: -148395.5:  47%|████▋     | 7/15 [00:11<00:10,  1.33s/it]ELBO: -148395.5:  53%|█████▎    | 8/15 [00:11<00:09,  1.31s/it]ELBO: -148592.0:  53%|█████▎    | 8/15 [00:13<00:09,  1.31s/it]ELBO: -148592.0:  60%|██████    | 9/15 [00:13<00:07,  1.29s/it]ELBO: -148264.8:  60%|██████    | 9/15 [00:14<00:07,  1.29s/it]ELBO: -148264.8:  67%|██████▋   | 10/15 [00:14<00:06,  1.28s/it]ELBO: -148196.1:  67%|██████▋   | 10/15 [00:15<00:06,  1.28s/it]ELBO: -148196.1:  73%|███████▎  | 11/15 [00:15<00:05,  1.28s/it]ELBO: -148410.2:  73%|███████▎  | 11/15 [00:16<00:05,  1.28s/it]ELBO: -148410.2:  80%|████████  | 12/15 [00:16<00:03,  1.27s/it]ELBO: -148227.8:  80%|████████  | 12/15 [00:18<00:03,  1.27s/it]ELBO: -148227.8:  87%|████████▋ | 13/15 [00:18<00:02,  1.27s/it]ELBO: -148415.9:  87%|████████▋ | 13/15 [00:19<00:02,  1.27s/it]ELBO: -148415.9:  93%|█████████▎| 14/15 [00:19<00:01,  1.27s/it]ELBO: -148617.6:  93%|█████████▎| 14/15 [00:20<00:01,  1.27s/it]ELBO: -148617.6: 100%|██████████| 15/15 [00:20<00:00,  1.27s/it]ELBO: -148617.6: 100%|██████████| 15/15 [00:20<00:00,  1.38s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -999547.5:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -147965.4:   0%|          | 0/15 [00:03<?, ?it/s]ELBO: -147965.4:   7%|▋         | 1/15 [00:03<00:51,  3.70s/it]ELBO: -148451.7:   7%|▋         | 1/15 [00:04<00:51,  3.70s/it]ELBO: -148451.7:  13%|█▎        | 2/15 [00:04<00:29,  2.27s/it]ELBO: -148354.5:  13%|█▎        | 2/15 [00:06<00:29,  2.27s/it]ELBO: -148354.5:  20%|██        | 3/15 [00:06<00:21,  1.81s/it]ELBO: -148113.3:  20%|██        | 3/15 [00:07<00:21,  1.81s/it]ELBO: -148113.3:  27%|██▋       | 4/15 [00:07<00:17,  1.60s/it]ELBO: -147965.3:  27%|██▋       | 4/15 [00:08<00:17,  1.60s/it]ELBO: -147965.3:  33%|███▎      | 5/15 [00:08<00:14,  1.48s/it]ELBO: -148120.4:  33%|███▎      | 5/15 [00:10<00:14,  1.48s/it]ELBO: -148120.4:  40%|████      | 6/15 [00:10<00:12,  1.40s/it]ELBO: -148127.0:  40%|████      | 6/15 [00:11<00:12,  1.40s/it]ELBO: -148127.0:  47%|████▋     | 7/15 [00:11<00:10,  1.36s/it]ELBO: -147956.2:  47%|████▋     | 7/15 [00:12<00:10,  1.36s/it]ELBO: -147956.2:  53%|█████▎    | 8/15 [00:12<00:09,  1.33s/it]ELBO: -148388.6:  53%|█████▎    | 8/15 [00:13<00:09,  1.33s/it]ELBO: -148388.6:  60%|██████    | 9/15 [00:13<00:07,  1.31s/it]ELBO: -147879.6:  60%|██████    | 9/15 [00:15<00:07,  1.31s/it]ELBO: -147879.6:  67%|██████▋   | 10/15 [00:15<00:06,  1.29s/it]ELBO: -147691.5:  67%|██████▋   | 10/15 [00:16<00:06,  1.29s/it]ELBO: -147691.5:  73%|███████▎  | 11/15 [00:16<00:05,  1.28s/it]ELBO: -148052.0:  73%|███████▎  | 11/15 [00:17<00:05,  1.28s/it]ELBO: -148052.0:  80%|████████  | 12/15 [00:17<00:03,  1.28s/it]ELBO: -148472.9:  80%|████████  | 12/15 [00:18<00:03,  1.28s/it]ELBO: -148472.9:  87%|████████▋ | 13/15 [00:18<00:02,  1.27s/it]ELBO: -148008.5:  87%|████████▋ | 13/15 [00:20<00:02,  1.27s/it]ELBO: -148008.5:  93%|█████████▎| 14/15 [00:20<00:01,  1.27s/it]ELBO: -148056.2:  93%|█████████▎| 14/15 [00:21<00:01,  1.27s/it]ELBO: -148056.2: 100%|██████████| 15/15 [00:21<00:00,  1.27s/it]ELBO: -148056.2: 100%|██████████| 15/15 [00:21<00:00,  1.43s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -953857.8:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -147256.3:   0%|          | 0/15 [00:03<?, ?it/s]ELBO: -147256.3:   7%|▋         | 1/15 [00:03<00:52,  3.74s/it]ELBO: -147327.6:   7%|▋         | 1/15 [00:04<00:52,  3.74s/it]ELBO: -147327.6:  13%|█▎        | 2/15 [00:04<00:29,  2.28s/it]ELBO: -146844.5:  13%|█▎        | 2/15 [00:06<00:29,  2.28s/it]ELBO: -146844.5:  20%|██        | 3/15 [00:06<00:21,  1.82s/it]ELBO: -147219.8:  20%|██        | 3/15 [00:07<00:21,  1.82s/it]ELBO: -147219.8:  27%|██▋       | 4/15 [00:07<00:17,  1.60s/it]ELBO: -147487.0:  27%|██▋       | 4/15 [00:08<00:17,  1.60s/it]ELBO: -147487.0:  33%|███▎      | 5/15 [00:08<00:14,  1.48s/it]ELBO: -147250.1:  33%|███▎      | 5/15 [00:10<00:14,  1.48s/it]ELBO: -147250.1:  40%|████      | 6/15 [00:10<00:12,  1.40s/it]ELBO: -147261.8:  40%|████      | 6/15 [00:11<00:12,  1.40s/it]ELBO: -147261.8:  47%|████▋     | 7/15 [00:11<00:10,  1.36s/it]ELBO: -147119.8:  47%|████▋     | 7/15 [00:12<00:10,  1.36s/it]ELBO: -147119.8:  53%|█████▎    | 8/15 [00:12<00:09,  1.33s/it]ELBO: -147073.8:  53%|█████▎    | 8/15 [00:13<00:09,  1.33s/it]ELBO: -147073.8:  60%|██████    | 9/15 [00:13<00:07,  1.31s/it]ELBO: -147299.9:  60%|██████    | 9/15 [00:15<00:07,  1.31s/it]ELBO: -147299.9:  67%|██████▋   | 10/15 [00:15<00:06,  1.29s/it]ELBO: -147047.1:  67%|██████▋   | 10/15 [00:16<00:06,  1.29s/it]ELBO: -147047.1:  73%|███████▎  | 11/15 [00:16<00:05,  1.28s/it]ELBO: -147049.1:  73%|███████▎  | 11/15 [00:17<00:05,  1.28s/it]ELBO: -147049.1:  80%|████████  | 12/15 [00:17<00:03,  1.28s/it]ELBO: -146808.4:  80%|████████  | 12/15 [00:18<00:03,  1.28s/it]ELBO: -146808.4:  87%|████████▋ | 13/15 [00:18<00:02,  1.27s/it]ELBO: -147088.6:  87%|████████▋ | 13/15 [00:20<00:02,  1.27s/it]ELBO: -147088.6:  93%|█████████▎| 14/15 [00:20<00:01,  1.27s/it]ELBO: -147252.5:  93%|█████████▎| 14/15 [00:21<00:01,  1.27s/it]ELBO: -147252.5: 100%|██████████| 15/15 [00:21<00:00,  1.27s/it]ELBO: -147252.5: 100%|██████████| 15/15 [00:21<00:00,  1.43s/it]
