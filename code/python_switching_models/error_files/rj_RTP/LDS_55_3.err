Processed spikes from trial 100.
Processed spikes from trial 200.
Processed spikes from trial 300.
  0%|          | 0/1 [00:00<?, ?it/s]ARHMM Initialization restarts:   0%|          | 0/1 [00:00<?, ?it/s]Initializing with an ARHMM using 25 steps of EM.

  0%|          | 0/25 [00:00<?, ?it/s][A
LP: -1448288.4:   0%|          | 0/25 [00:00<?, ?it/s][A
LP: -1448288.4:   0%|          | 0/25 [00:00<?, ?it/s][A
LP: -1448288.4:   4%|▍         | 1/25 [00:00<00:17,  1.37it/s][A
LP: -1448288.4:   4%|▍         | 1/25 [00:01<00:17,  1.37it/s][A
LP: -1448288.4:   8%|▊         | 2/25 [00:01<00:17,  1.35it/s][A
LP: -1448288.4:   8%|▊         | 2/25 [00:02<00:17,  1.35it/s][A
LP: -1448288.4:  12%|█▏        | 3/25 [00:02<00:16,  1.35it/s][A
LP: -1448288.4:  12%|█▏        | 3/25 [00:02<00:16,  1.35it/s][A
LP: -1448288.4:  16%|█▌        | 4/25 [00:02<00:15,  1.35it/s][A
LP: -1448288.4:  16%|█▌        | 4/25 [00:03<00:15,  1.35it/s][A
LP: -1448288.4:  20%|██        | 5/25 [00:03<00:14,  1.36it/s][A
LP: -1448288.4:  20%|██        | 5/25 [00:04<00:14,  1.36it/s][A
LP: -1448288.4:  24%|██▍       | 6/25 [00:04<00:14,  1.29it/s][A
LP: -1448288.4:  24%|██▍       | 6/25 [00:05<00:14,  1.29it/s][A
LP: -1448288.4:  28%|██▊       | 7/25 [00:05<00:13,  1.31it/s][A
LP: -1448288.4:  28%|██▊       | 7/25 [00:06<00:13,  1.31it/s][A
LP: -1448288.4:  32%|███▏      | 8/25 [00:06<00:13,  1.27it/s][A
LP: -1448288.4:  32%|███▏      | 8/25 [00:06<00:13,  1.27it/s][A
LP: -1448288.4:  36%|███▌      | 9/25 [00:06<00:12,  1.30it/s][A
LP: -1448288.4:  36%|███▌      | 9/25 [00:07<00:12,  1.30it/s][A
LP: -1448288.4:  40%|████      | 10/25 [00:07<00:11,  1.31it/s][A
LP: -1448288.4:  40%|████      | 10/25 [00:08<00:11,  1.31it/s][A
LP: -1448288.4:  44%|████▍     | 11/25 [00:08<00:10,  1.32it/s][A
LP: -1448288.4:  44%|████▍     | 11/25 [00:09<00:10,  1.32it/s][A
LP: -1448288.4:  48%|████▊     | 12/25 [00:09<00:09,  1.34it/s][A
LP: -1448288.4:  48%|████▊     | 12/25 [00:09<00:09,  1.34it/s][A
LP: -1448288.4:  52%|█████▏    | 13/25 [00:09<00:08,  1.35it/s][A
LP: -1448288.4:  52%|█████▏    | 13/25 [00:10<00:08,  1.35it/s][A
LP: -1448288.4:  56%|█████▌    | 14/25 [00:10<00:08,  1.34it/s][A
LP: -1448288.4:  56%|█████▌    | 14/25 [00:11<00:08,  1.34it/s][A
LP: -1448288.4:  60%|██████    | 15/25 [00:11<00:07,  1.34it/s][A
LP: -1448288.4:  60%|██████    | 15/25 [00:12<00:07,  1.34it/s][A
LP: -1448288.4:  64%|██████▍   | 16/25 [00:12<00:06,  1.35it/s][A
LP: -1448288.4:  64%|██████▍   | 16/25 [00:12<00:06,  1.35it/s][A
LP: -1448288.4:  68%|██████▊   | 17/25 [00:12<00:05,  1.35it/s][A
LP: -1448288.4:  68%|██████▊   | 17/25 [00:13<00:05,  1.35it/s][A
LP: -1448288.4:  72%|███████▏  | 18/25 [00:13<00:05,  1.35it/s][A
LP: -1448288.4:  72%|███████▏  | 18/25 [00:14<00:05,  1.35it/s][A
LP: -1448288.4:  76%|███████▌  | 19/25 [00:14<00:04,  1.35it/s][A
LP: -1448288.4:  76%|███████▌  | 19/25 [00:14<00:04,  1.35it/s][A
LP: -1448288.4:  80%|████████  | 20/25 [00:14<00:03,  1.35it/s][A
LP: -1448288.4:  80%|████████  | 20/25 [00:15<00:03,  1.35it/s][A
LP: -1448288.4:  84%|████████▍ | 21/25 [00:15<00:02,  1.34it/s][A
LP: -1448288.4:  84%|████████▍ | 21/25 [00:16<00:02,  1.34it/s][A
LP: -1448288.4:  88%|████████▊ | 22/25 [00:16<00:02,  1.34it/s][A
LP: -1448288.4:  88%|████████▊ | 22/25 [00:17<00:02,  1.34it/s][A
LP: -1448288.4:  92%|█████████▏| 23/25 [00:17<00:01,  1.35it/s][A
LP: -1448288.4:  92%|█████████▏| 23/25 [00:17<00:01,  1.35it/s][A
LP: -1448288.4:  96%|█████████▌| 24/25 [00:17<00:00,  1.36it/s][A
LP: -1448288.4:  96%|█████████▌| 24/25 [00:18<00:00,  1.36it/s][A
LP: -1448288.4: 100%|██████████| 25/25 [00:18<00:00,  1.36it/s][ALP: -1448288.4: 100%|██████████| 25/25 [00:18<00:00,  1.34it/s]
ARHMM Initialization restarts: 100%|██████████| 1/1 [00:19<00:00, 19.61s/it]ARHMM Initialization restarts: 100%|██████████| 1/1 [00:19<00:00, 19.61s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -14237091547.8:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -827297.9:   0%|          | 0/15 [01:33<?, ?it/s]     ELBO: -827297.9:   7%|▋         | 1/15 [01:33<21:42, 93.05s/it]ELBO: -806044.1:   7%|▋         | 1/15 [02:44<21:42, 93.05s/it]ELBO: -806044.1:  13%|█▎        | 2/15 [02:44<17:22, 80.18s/it]ELBO: -797416.0:  13%|█▎        | 2/15 [03:55<17:22, 80.18s/it]ELBO: -797416.0:  20%|██        | 3/15 [03:55<15:13, 76.13s/it]ELBO: -792955.2:  20%|██        | 3/15 [05:05<15:13, 76.13s/it]ELBO: -792955.2:  27%|██▋       | 4/15 [05:05<13:30, 73.68s/it]ELBO: -791313.1:  27%|██▋       | 4/15 [06:15<13:30, 73.68s/it]ELBO: -791313.1:  33%|███▎      | 5/15 [06:15<12:02, 72.27s/it]ELBO: -787910.8:  33%|███▎      | 5/15 [07:25<12:02, 72.27s/it]ELBO: -787910.8:  40%|████      | 6/15 [07:25<10:45, 71.71s/it]ELBO: -786742.8:  40%|████      | 6/15 [08:35<10:45, 71.71s/it]ELBO: -786742.8:  47%|████▋     | 7/15 [08:35<09:28, 71.01s/it]ELBO: -786391.1:  47%|████▋     | 7/15 [09:46<09:28, 71.01s/it]ELBO: -786391.1:  53%|█████▎    | 8/15 [09:46<08:16, 70.90s/it]ELBO: -784023.3:  53%|█████▎    | 8/15 [10:56<08:16, 70.90s/it]ELBO: -784023.3:  60%|██████    | 9/15 [10:56<07:05, 70.87s/it]ELBO: -784643.2:  60%|██████    | 9/15 [12:05<07:05, 70.87s/it]ELBO: -784643.2:  67%|██████▋   | 10/15 [12:05<05:51, 70.27s/it]ELBO: -782973.3:  67%|██████▋   | 10/15 [13:14<05:51, 70.27s/it]ELBO: -782973.3:  73%|███████▎  | 11/15 [13:14<04:39, 69.81s/it]ELBO: -783939.4:  73%|███████▎  | 11/15 [14:23<04:39, 69.81s/it]ELBO: -783939.4:  80%|████████  | 12/15 [14:23<03:28, 69.61s/it]ELBO: -781723.7:  80%|████████  | 12/15 [15:32<03:28, 69.61s/it]ELBO: -781723.7:  87%|████████▋ | 13/15 [15:32<02:18, 69.39s/it]ELBO: -781408.2:  87%|████████▋ | 13/15 [16:41<02:18, 69.39s/it]ELBO: -781408.2:  93%|█████████▎| 14/15 [16:41<01:09, 69.27s/it]ELBO: -781751.8:  93%|█████████▎| 14/15 [17:50<01:09, 69.27s/it]ELBO: -781751.8: 100%|██████████| 15/15 [17:50<00:00, 69.14s/it]ELBO: -781751.8: 100%|██████████| 15/15 [17:50<00:00, 71.36s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -176494853406173.0:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -150601.5:   0%|          | 0/15 [00:25<?, ?it/s]         ELBO: -150601.5:   7%|▋         | 1/15 [00:25<05:53, 25.26s/it]ELBO: -150825.2:   7%|▋         | 1/15 [00:35<05:53, 25.26s/it]ELBO: -150825.2:  13%|█▎        | 2/15 [00:35<03:33, 16.41s/it]ELBO: -150745.1:  13%|█▎        | 2/15 [00:45<03:33, 16.41s/it]ELBO: -150745.1:  20%|██        | 3/15 [00:45<02:42, 13.55s/it]ELBO: -150584.2:  20%|██        | 3/15 [00:55<02:42, 13.55s/it]ELBO: -150584.2:  27%|██▋       | 4/15 [00:55<02:14, 12.24s/it]ELBO: -150156.3:  27%|██▋       | 4/15 [01:06<02:14, 12.24s/it]ELBO: -150156.3:  33%|███▎      | 5/15 [01:06<01:55, 11.52s/it]ELBO: -149993.5:  33%|███▎      | 5/15 [01:16<01:55, 11.52s/it]ELBO: -149993.5:  40%|████      | 6/15 [01:16<01:39, 11.07s/it]ELBO: -150433.9:  40%|████      | 6/15 [01:26<01:39, 11.07s/it]ELBO: -150433.9:  47%|████▋     | 7/15 [01:26<01:26, 10.79s/it]ELBO: -149424.3:  47%|████▋     | 7/15 [01:36<01:26, 10.79s/it]ELBO: -149424.3:  53%|█████▎    | 8/15 [01:36<01:14, 10.63s/it]ELBO: -150295.7:  53%|█████▎    | 8/15 [01:46<01:14, 10.63s/it]ELBO: -150295.7:  60%|██████    | 9/15 [01:46<01:02, 10.48s/it]ELBO: -150786.5:  60%|██████    | 9/15 [01:57<01:02, 10.48s/it]ELBO: -150786.5:  67%|██████▋   | 10/15 [01:57<00:51, 10.39s/it]ELBO: -150217.4:  67%|██████▋   | 10/15 [02:07<00:51, 10.39s/it]ELBO: -150217.4:  73%|███████▎  | 11/15 [02:07<00:41, 10.32s/it]ELBO: -150528.5:  73%|███████▎  | 11/15 [02:17<00:41, 10.32s/it]ELBO: -150528.5:  80%|████████  | 12/15 [02:17<00:30, 10.28s/it]ELBO: -150609.5:  80%|████████  | 12/15 [02:27<00:30, 10.28s/it]ELBO: -150609.5:  87%|████████▋ | 13/15 [02:27<00:20, 10.25s/it]ELBO: -150070.1:  87%|████████▋ | 13/15 [02:37<00:20, 10.25s/it]ELBO: -150070.1:  93%|█████████▎| 14/15 [02:37<00:10, 10.26s/it]ELBO: -150710.4:  93%|█████████▎| 14/15 [02:47<00:10, 10.26s/it]ELBO: -150710.4: 100%|██████████| 15/15 [02:47<00:00, 10.20s/it]ELBO: -150710.4: 100%|██████████| 15/15 [02:47<00:00, 11.20s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -221703863098238.9:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -145963.0:   0%|          | 0/15 [00:31<?, ?it/s]         ELBO: -145963.0:   7%|▋         | 1/15 [00:31<07:25, 31.79s/it]ELBO: -146472.8:   7%|▋         | 1/15 [00:41<07:25, 31.79s/it]ELBO: -146472.8:  13%|█▎        | 2/15 [00:41<04:07, 19.05s/it]ELBO: -146322.1:  13%|█▎        | 2/15 [00:52<04:07, 19.05s/it]ELBO: -146322.1:  20%|██        | 3/15 [00:52<03:00, 15.01s/it]ELBO: -146556.7:  20%|██        | 3/15 [01:02<03:00, 15.01s/it]ELBO: -146556.7:  27%|██▋       | 4/15 [01:02<02:24, 13.10s/it]ELBO: -145983.1:  27%|██▋       | 4/15 [01:12<02:24, 13.10s/it]ELBO: -145983.1:  33%|███▎      | 5/15 [01:12<02:00, 12.06s/it]ELBO: -146288.7:  33%|███▎      | 5/15 [01:22<02:00, 12.06s/it]ELBO: -146288.7:  40%|████      | 6/15 [01:22<01:43, 11.47s/it]ELBO: -146553.6:  40%|████      | 6/15 [01:32<01:43, 11.47s/it]ELBO: -146553.6:  47%|████▋     | 7/15 [01:32<01:28, 11.03s/it]ELBO: -145929.6:  47%|████▋     | 7/15 [01:43<01:28, 11.03s/it]ELBO: -145929.6:  53%|█████▎    | 8/15 [01:43<01:15, 10.73s/it]ELBO: -146085.5:  53%|█████▎    | 8/15 [01:53<01:15, 10.73s/it]ELBO: -146085.5:  60%|██████    | 9/15 [01:53<01:03, 10.55s/it]ELBO: -146202.6:  60%|██████    | 9/15 [02:03<01:03, 10.55s/it]ELBO: -146202.6:  67%|██████▋   | 10/15 [02:03<00:52, 10.45s/it]ELBO: -146685.8:  67%|██████▋   | 10/15 [02:13<00:52, 10.45s/it]ELBO: -146685.8:  73%|███████▎  | 11/15 [02:13<00:41, 10.36s/it]ELBO: -146810.7:  73%|███████▎  | 11/15 [02:23<00:41, 10.36s/it]ELBO: -146810.7:  80%|████████  | 12/15 [02:23<00:30, 10.30s/it]ELBO: -145922.5:  80%|████████  | 12/15 [02:33<00:30, 10.30s/it]ELBO: -145922.5:  87%|████████▋ | 13/15 [02:33<00:20, 10.24s/it]ELBO: -146154.7:  87%|████████▋ | 13/15 [02:44<00:20, 10.24s/it]ELBO: -146154.7:  93%|█████████▎| 14/15 [02:44<00:10, 10.23s/it]ELBO: -147165.4:  93%|█████████▎| 14/15 [02:54<00:10, 10.23s/it]ELBO: -147165.4: 100%|██████████| 15/15 [02:54<00:00, 10.20s/it]ELBO: -147165.4: 100%|██████████| 15/15 [02:54<00:00, 11.61s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -160076460113852.2:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -149309.0:   0%|          | 0/15 [00:28<?, ?it/s]         ELBO: -149309.0:   7%|▋         | 1/15 [00:28<06:33, 28.13s/it]ELBO: -149644.2:   7%|▋         | 1/15 [00:38<06:33, 28.13s/it]ELBO: -149644.2:  13%|█▎        | 2/15 [00:38<03:48, 17.55s/it]ELBO: -149812.2:  13%|█▎        | 2/15 [00:48<03:48, 17.55s/it]ELBO: -149812.2:  20%|██        | 3/15 [00:48<02:50, 14.20s/it]ELBO: -149305.9:  20%|██        | 3/15 [00:58<02:50, 14.20s/it]ELBO: -149305.9:  27%|██▋       | 4/15 [00:58<02:18, 12.60s/it]ELBO: -149496.1:  27%|██▋       | 4/15 [01:08<02:18, 12.60s/it]ELBO: -149496.1:  33%|███▎      | 5/15 [01:08<01:57, 11.73s/it]ELBO: -149509.7:  33%|███▎      | 5/15 [01:19<01:57, 11.73s/it]ELBO: -149509.7:  40%|████      | 6/15 [01:19<01:40, 11.22s/it]ELBO: -149886.6:  40%|████      | 6/15 [01:29<01:40, 11.22s/it]ELBO: -149886.6:  47%|████▋     | 7/15 [01:29<01:27, 10.88s/it]ELBO: -149753.7:  47%|████▋     | 7/15 [01:39<01:27, 10.88s/it]ELBO: -149753.7:  53%|█████▎    | 8/15 [01:39<01:14, 10.67s/it]ELBO: -149609.2:  53%|█████▎    | 8/15 [01:49<01:14, 10.67s/it]ELBO: -149609.2:  60%|██████    | 9/15 [01:49<01:03, 10.51s/it]ELBO: -149480.6:  60%|██████    | 9/15 [01:59<01:03, 10.51s/it]ELBO: -149480.6:  67%|██████▋   | 10/15 [01:59<00:52, 10.41s/it]ELBO: -149763.0:  67%|██████▋   | 10/15 [02:09<00:52, 10.41s/it]ELBO: -149763.0:  73%|███████▎  | 11/15 [02:09<00:41, 10.34s/it]ELBO: -150484.7:  73%|███████▎  | 11/15 [02:20<00:41, 10.34s/it]ELBO: -150484.7:  80%|████████  | 12/15 [02:20<00:30, 10.29s/it]ELBO: -149758.6:  80%|████████  | 12/15 [02:30<00:30, 10.29s/it]ELBO: -149758.6:  87%|████████▋ | 13/15 [02:30<00:20, 10.28s/it]ELBO: -149496.5:  87%|████████▋ | 13/15 [02:40<00:20, 10.28s/it]ELBO: -149496.5:  93%|█████████▎| 14/15 [02:40<00:10, 10.25s/it]ELBO: -149995.7:  93%|█████████▎| 14/15 [02:50<00:10, 10.25s/it]ELBO: -149995.7: 100%|██████████| 15/15 [02:50<00:00, 10.23s/it]ELBO: -149995.7: 100%|██████████| 15/15 [02:50<00:00, 11.38s/it]
  0%|          | 0/15 [00:00<?, ?it/s]ELBO: -141246541219663.1:   0%|          | 0/15 [00:00<?, ?it/s]ELBO: -148357.2:   0%|          | 0/15 [00:31<?, ?it/s]         ELBO: -148357.2:   7%|▋         | 1/15 [00:31<07:18, 31.30s/it]ELBO: -148364.6:   7%|▋         | 1/15 [00:41<07:18, 31.30s/it]ELBO: -148364.6:  13%|█▎        | 2/15 [00:41<04:05, 18.88s/it]ELBO: -148312.8:  13%|█▎        | 2/15 [00:51<04:05, 18.88s/it]ELBO: -148312.8:  20%|██        | 3/15 [00:51<02:58, 14.90s/it]ELBO: -148190.9:  20%|██        | 3/15 [01:01<02:58, 14.90s/it]ELBO: -148190.9:  27%|██▋       | 4/15 [01:01<02:23, 13.02s/it]ELBO: -148677.4:  27%|██▋       | 4/15 [01:11<02:23, 13.02s/it]ELBO: -148677.4:  33%|███▎      | 5/15 [01:11<01:59, 11.99s/it]ELBO: -148287.3:  33%|███▎      | 5/15 [01:22<01:59, 11.99s/it]ELBO: -148287.3:  40%|████      | 6/15 [01:22<01:42, 11.38s/it]ELBO: -148433.9:  40%|████      | 6/15 [01:32<01:42, 11.38s/it]ELBO: -148433.9:  47%|████▋     | 7/15 [01:32<01:27, 10.99s/it]ELBO: -148530.4:  47%|████▋     | 7/15 [01:42<01:27, 10.99s/it]ELBO: -148530.4:  53%|█████▎    | 8/15 [01:42<01:15, 10.73s/it]ELBO: -148869.2:  53%|█████▎    | 8/15 [01:52<01:15, 10.73s/it]ELBO: -148869.2:  60%|██████    | 9/15 [01:52<01:03, 10.56s/it]ELBO: -148546.1:  60%|██████    | 9/15 [02:02<01:03, 10.56s/it]ELBO: -148546.1:  67%|██████▋   | 10/15 [02:02<00:52, 10.41s/it]ELBO: -147896.9:  67%|██████▋   | 10/15 [02:13<00:52, 10.41s/it]ELBO: -147896.9:  73%|███████▎  | 11/15 [02:13<00:41, 10.36s/it]ELBO: -148059.9:  73%|███████▎  | 11/15 [02:23<00:41, 10.36s/it]ELBO: -148059.9:  80%|████████  | 12/15 [02:23<00:30, 10.31s/it]ELBO: -148695.1:  80%|████████  | 12/15 [02:33<00:30, 10.31s/it]ELBO: -148695.1:  87%|████████▋ | 13/15 [02:33<00:20, 10.28s/it]ELBO: -148629.9:  87%|████████▋ | 13/15 [02:43<00:20, 10.28s/it]ELBO: -148629.9:  93%|█████████▎| 14/15 [02:43<00:10, 10.26s/it]ELBO: -148553.0:  93%|█████████▎| 14/15 [02:53<00:10, 10.26s/it]ELBO: -148553.0: 100%|██████████| 15/15 [02:53<00:00, 10.23s/it]ELBO: -148553.0: 100%|██████████| 15/15 [02:53<00:00, 11.59s/it]
